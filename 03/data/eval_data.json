{
  "scores": [
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_01",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 449,
      "tokens_out": 8,
      "cost_usd": 0.007335,
      "latency_ms": 2383.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_01",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 449,
      "tokens_out": 8,
      "cost_usd": 0.007335,
      "latency_ms": 2209.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_01",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 449,
      "tokens_out": 8,
      "cost_usd": 0.007335,
      "latency_ms": 1981.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_02",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 449,
      "tokens_out": 23,
      "cost_usd": 0.00846,
      "latency_ms": 2209.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_02",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 449,
      "tokens_out": 23,
      "cost_usd": 0.00846,
      "latency_ms": 1342.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_02",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 449,
      "tokens_out": 23,
      "cost_usd": 0.00846,
      "latency_ms": 2139.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_03",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE toYYYYMM(timestamp) = 202403",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 450,
      "tokens_out": 28,
      "cost_usd": 0.00885,
      "latency_ms": 1754.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_03",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE toYYYYMM(timestamp) = 202403",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 450,
      "tokens_out": 28,
      "cost_usd": 0.00885,
      "latency_ms": 1802.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_03",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE toYYYYMM(timestamp) = 202403",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 450,
      "tokens_out": 28,
      "cost_usd": 0.00885,
      "latency_ms": 2316.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_04",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 446,
      "tokens_out": 11,
      "cost_usd": 0.007515,
      "latency_ms": 1552.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_04",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 446,
      "tokens_out": 16,
      "cost_usd": 0.00789,
      "latency_ms": 2100.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_04",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 446,
      "tokens_out": 11,
      "cost_usd": 0.007515,
      "latency_ms": 1859.7
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_05",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 447,
      "tokens_out": 20,
      "cost_usd": 0.008205,
      "latency_ms": 2313.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_05",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 447,
      "tokens_out": 20,
      "cost_usd": 0.008205,
      "latency_ms": 1524.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_05",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 447,
      "tokens_out": 20,
      "cost_usd": 0.008205,
      "latency_ms": 2551.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_06",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 457,
      "tokens_out": 34,
      "cost_usd": 0.009405,
      "latency_ms": 2274.6
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_06",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 457,
      "tokens_out": 32,
      "cost_usd": 0.009255,
      "latency_ms": 2295.7
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_06",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 457,
      "tokens_out": 34,
      "cost_usd": 0.009405,
      "latency_ms": 1489.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_07",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 452,
      "tokens_out": 20,
      "cost_usd": 0.00828,
      "latency_ms": 1663.6
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_07",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 452,
      "tokens_out": 20,
      "cost_usd": 0.00828,
      "latency_ms": 2213.2
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_07",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 452,
      "tokens_out": 20,
      "cost_usd": 0.00828,
      "latency_ms": 2248.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_08",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 449,
      "tokens_out": 24,
      "cost_usd": 0.008535,
      "latency_ms": 1647.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_08",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 449,
      "tokens_out": 24,
      "cost_usd": 0.008535,
      "latency_ms": 2210.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_08",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 449,
      "tokens_out": 24,
      "cost_usd": 0.008535,
      "latency_ms": 1776.2
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_09",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01'\n  AND timestamp < '2025-01-01'\nORDER BY timestamp",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 455,
      "tokens_out": 51,
      "cost_usd": 0.01065,
      "latency_ms": 2576.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_09",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01'\n  AND timestamp < '2025-01-01'\nORDER BY timestamp",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 455,
      "tokens_out": 51,
      "cost_usd": 0.01065,
      "latency_ms": 2298.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_09",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01'\n  AND timestamp < '2025-01-01'\nORDER BY timestamp",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 455,
      "tokens_out": 51,
      "cost_usd": 0.01065,
      "latency_ms": 1620.2
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_10",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 452,
      "tokens_out": 20,
      "cost_usd": 0.00828,
      "latency_ms": 2477.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_10",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 452,
      "tokens_out": 20,
      "cost_usd": 0.00828,
      "latency_ms": 1392.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t1_10",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 452,
      "tokens_out": 20,
      "cost_usd": 0.00828,
      "latency_ms": 2068.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_01",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 453,
      "tokens_out": 28,
      "cost_usd": 0.008895,
      "latency_ms": 2049.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_01",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 453,
      "tokens_out": 28,
      "cost_usd": 0.008895,
      "latency_ms": 2499.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_01",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 453,
      "tokens_out": 28,
      "cost_usd": 0.008895,
      "latency_ms": 2261.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_02",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT device, avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY avg_duration_ms DESC",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 451,
      "tokens_out": 47,
      "cost_usd": 0.01029,
      "latency_ms": 2824.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_02",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT device, avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY avg_duration_ms DESC",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 451,
      "tokens_out": 47,
      "cost_usd": 0.01029,
      "latency_ms": 2761.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_02",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT device, avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY avg_duration_ms DESC",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 451,
      "tokens_out": 47,
      "cost_usd": 0.01029,
      "latency_ms": 2631.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_03",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 453,
      "tokens_out": 61,
      "cost_usd": 0.01137,
      "latency_ms": 2908.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_03",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 453,
      "tokens_out": 61,
      "cost_usd": 0.01137,
      "latency_ms": 2665.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_03",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 453,
      "tokens_out": 61,
      "cost_usd": 0.01137,
      "latency_ms": 2784.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_04",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS event_count\nFROM events\nGROUP BY country\nHAVING event_count > 10000\nORDER BY event_count DESC",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 451,
      "tokens_out": 41,
      "cost_usd": 0.00984,
      "latency_ms": 2661.6
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_04",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS event_count\nFROM events\nGROUP BY country\nHAVING event_count > 10000\nORDER BY event_count DESC",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 451,
      "tokens_out": 41,
      "cost_usd": 0.00984,
      "latency_ms": 1419.7
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_04",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS event_count\nFROM events\nGROUP BY country\nHAVING event_count > 10000\nORDER BY event_count DESC",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 451,
      "tokens_out": 41,
      "cost_usd": 0.00984,
      "latency_ms": 2805.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_05",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toHour(timestamp) AS hour_of_day,\n    count() AS event_count\nFROM events\nGROUP BY hour_of_day\nORDER BY hour_of_day",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 451,
      "tokens_out": 51,
      "cost_usd": 0.01059,
      "latency_ms": 2627.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_05",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toHour(timestamp) AS hour, count() AS event_count\nFROM events\nGROUP BY hour\nORDER BY hour",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 451,
      "tokens_out": 35,
      "cost_usd": 0.00939,
      "latency_ms": 1585.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_05",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toHour(timestamp) AS hour, count() AS event_count\nFROM events\nGROUP BY hour\nORDER BY hour",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 451,
      "tokens_out": 35,
      "cost_usd": 0.00939,
      "latency_ms": 1632.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_06",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) FROM events WHERE event_type = 'pageview'",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 456,
      "tokens_out": 27,
      "cost_usd": 0.008865,
      "latency_ms": 2183.6
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_06",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) FROM events WHERE event_type = 'pageview'",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 456,
      "tokens_out": 27,
      "cost_usd": 0.008865,
      "latency_ms": 1625.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_06",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) FROM events WHERE event_type = 'pageview'",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 456,
      "tokens_out": 27,
      "cost_usd": 0.008865,
      "latency_ms": 1625.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_07",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY month\nORDER BY month",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 450,
      "tokens_out": 59,
      "cost_usd": 0.011175,
      "latency_ms": 2616.2
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_07",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY month\nORDER BY month",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 450,
      "tokens_out": 59,
      "cost_usd": 0.011175,
      "latency_ms": 2204.7
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_07",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY month\nORDER BY month",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 450,
      "tokens_out": 59,
      "cost_usd": 0.011175,
      "latency_ms": 1861.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_08",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count(DISTINCT country) AS distinct_countries\nFROM events\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 452,
      "tokens_out": 32,
      "cost_usd": 0.00918,
      "latency_ms": 1700.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_08",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count(DISTINCT country) AS distinct_countries\nFROM events\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 452,
      "tokens_out": 32,
      "cost_usd": 0.00918,
      "latency_ms": 1495.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_08",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count(DISTINCT country) AS distinct_countries\nFROM events\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 452,
      "tokens_out": 32,
      "cost_usd": 0.00918,
      "latency_ms": 1710.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_09",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 454,
      "tokens_out": 47,
      "cost_usd": 0.010335,
      "latency_ms": 2648.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_09",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 454,
      "tokens_out": 47,
      "cost_usd": 0.010335,
      "latency_ms": 2895.6
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_09",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 454,
      "tokens_out": 47,
      "cost_usd": 0.010335,
      "latency_ms": 2885.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_10",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    countIf(event_type = 'purchase') AS purchase_count,\n    countIf(event_type = 'pageview') AS pageview_count\nFROM events\nWHERE event_type IN ('purchase', 'pageview')",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 454,
      "tokens_out": 65,
      "cost_usd": 0.011685,
      "latency_ms": 1888.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_10",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    countIf(event_type = 'purchase') AS purchase_count,\n    countIf(event_type = 'pageview') AS pageview_count\nFROM events\nWHERE event_type IN ('purchase', 'pageview')",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 454,
      "tokens_out": 65,
      "cost_usd": 0.011685,
      "latency_ms": 2328.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t2_10",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    countIf(event_type = 'purchase') AS purchase_count,\n    countIf(event_type = 'pageview') AS pageview_count\nFROM events\nWHERE event_type IN ('purchase', 'pageview')",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 454,
      "tokens_out": 65,
      "cost_usd": 0.011685,
      "latency_ms": 3264.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_01",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration_ms FROM events",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 451,
      "tokens_out": 23,
      "cost_usd": 0.00849,
      "latency_ms": 2604.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_01",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration_ms FROM events",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 451,
      "tokens_out": 23,
      "cost_usd": 0.00849,
      "latency_ms": 1581.6
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_01",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration_ms FROM events",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 451,
      "tokens_out": 23,
      "cost_usd": 0.00849,
      "latency_ms": 1624.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_02",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT uniqExact(user_id) FROM events",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 452,
      "tokens_out": 15,
      "cost_usd": 0.007905,
      "latency_ms": 1382.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_02",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT uniqExact(user_id) FROM events",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 452,
      "tokens_out": 15,
      "cost_usd": 0.007905,
      "latency_ms": 1283.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_02",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT uniqExact(user_id) FROM events",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 452,
      "tokens_out": 15,
      "cost_usd": 0.007905,
      "latency_ms": 2603.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_03",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 879939\t2024-12-01 00:06:12.000\t3613\tpageview\t/settings\t5267\t{'campaign':'summer_sale','source':'twit",
      "llm_sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 454,
      "tokens_out": 25,
      "cost_usd": 0.008685,
      "latency_ms": 3331.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_03",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 984733\t2024-08-01 00:00:55.000\t7041\tlogout\t/about\t5140\t{'campaign':'black_friday','source':'facebook",
      "llm_sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 454,
      "tokens_out": 25,
      "cost_usd": 0.008685,
      "latency_ms": 1515.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_03",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 710692\t2024-11-01 00:03:27.000\t2732\tpurchase\t/home\t\\N\t{'campaign':'spring_promo','source':'google'}\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 454,
      "tokens_out": 25,
      "cost_usd": 0.008685,
      "latency_ms": 1471.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_04",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 463,
      "tokens_out": 37,
      "cost_usd": 0.00972,
      "latency_ms": 2603.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_04",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 463,
      "tokens_out": 37,
      "cost_usd": 0.00972,
      "latency_ms": 2502.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_04",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 463,
      "tokens_out": 37,
      "cost_usd": 0.00972,
      "latency_ms": 1587.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_05",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT tag, count() AS occurrences\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY occurrences DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 463,
      "tokens_out": 38,
      "cost_usd": 0.009795,
      "latency_ms": 3218.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_05",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT tag, count() AS occurrences\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY occurrences DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 463,
      "tokens_out": 38,
      "cost_usd": 0.009795,
      "latency_ms": 1843.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_05",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT tag, count() AS occurrences\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY occurrences DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 463,
      "tokens_out": 38,
      "cost_usd": 0.009795,
      "latency_ms": 2257.2
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_06",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 877989\t2024-12-01 00:09:55.000\t6543\tpageview\t/home\t9658\t{'source':'direct'}\t['promo']\tFR\tdesktop\t\\N\n",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 456,
      "tokens_out": 24,
      "cost_usd": 0.00864,
      "latency_ms": 1372.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_06",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 514447\t2024-07-01 00:01:18.000\t7003\tpurchase\t/dashboard\t4455\t{'source':'twitter'}\t['promo','mobile']",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 456,
      "tokens_out": 24,
      "cost_usd": 0.00864,
      "latency_ms": 1972.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_06",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 644674\t2024-11-01 00:08:01.000\t6051\tclick\t/docs\t\\N\t{'source':'email'}\t['promo','vip_member','premium",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 456,
      "tokens_out": 24,
      "cost_usd": 0.00864,
      "latency_ms": 2650.2
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_07",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    quantile(0.90)(duration_ms) AS p90_duration_ms,\n    quantile(0.99)(duration_ms) AS p99_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 459,
      "tokens_out": 79,
      "cost_usd": 0.01281,
      "latency_ms": 2702.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_07",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    quantile(0.90)(duration_ms) AS p90_duration_ms,\n    quantile(0.99)(duration_ms) AS p99_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 459,
      "tokens_out": 79,
      "cost_usd": 0.01281,
      "latency_ms": 2637.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_07",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    quantile(0.90)(duration_ms) AS p90_duration_ms,\n    quantile(0.99)(duration_ms) AS p99_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 459,
      "tokens_out": 79,
      "cost_usd": 0.01281,
      "latency_ms": 2858.6
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_08",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue_cents\nFROM events",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 458,
      "tokens_out": 32,
      "cost_usd": 0.00927,
      "latency_ms": 2459.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_08",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue_cents\nFROM events",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 458,
      "tokens_out": 32,
      "cost_usd": 0.00927,
      "latency_ms": 2271.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_08",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue_cents\nFROM events",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 458,
      "tokens_out": 32,
      "cost_usd": 0.00927,
      "latency_ms": 2285.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_09",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 454,
      "tokens_out": 24,
      "cost_usd": 0.00861,
      "latency_ms": 1268.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_09",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 454,
      "tokens_out": 24,
      "cost_usd": 0.00861,
      "latency_ms": 2192.6
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_09",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 454,
      "tokens_out": 24,
      "cost_usd": 0.00861,
      "latency_ms": 5073.7
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_10",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 349664\t2024-12-01 00:01:56.000\t1508\tpageview\t/home\t\\N\t{'source':'google'}\t['vip_member']\tGB\ttablet\t\\",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(tag -> tag LIKE 'vip%', tags)",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 460,
      "tokens_out": 31,
      "cost_usd": 0.009225,
      "latency_ms": 3094.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_10",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 251611\t2024-10-01 00:27:46.000\t1254\tlogout\t/dashboard\t5614\t{'campaign':'launch','source':'twitter'}\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(tag -> tag LIKE 'vip%', tags)",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 460,
      "tokens_out": 31,
      "cost_usd": 0.009225,
      "latency_ms": 2316.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t3_10",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 934864\t2024-09-01 00:03:37.000\t8365\tpurchase\t/about\t4405\t{'campaign':'black_friday','source':'twitte",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(tag -> tag LIKE 'vip%', tags)",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 460,
      "tokens_out": 31,
      "cost_usd": 0.009225,
      "latency_ms": 1485.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_01",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 387880\t2024-11-01 00:00:19.000\t6365\tclick\t/docs\t\\N\t{'source':'google'}\t[]\tIN\tdesktop\t9843\tfree\n62563",
      "llm_sql": "SELECT\n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events AS e\nJOIN users AS u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 459,
      "tokens_out": 112,
      "cost_usd": 0.015285,
      "latency_ms": 2238.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_01",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 46158\t2024-07-01 00:00:39.000\t5188\tpageview\t/checkout\t998\t{'source':'google'}\t['mobile']\tFR\tmobile\t\\",
      "llm_sql": "SELECT\n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events AS e\nJOIN users AS u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 459,
      "tokens_out": 112,
      "cost_usd": 0.015285,
      "latency_ms": 3501.6
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_01",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t/blog\t\\N\t{'source':'facebook'}\t[]\tBR\ttablet\t\\N\tpro\n774716",
      "llm_sql": "SELECT\n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events AS e\nJOIN users AS u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 459,
      "tokens_out": 112,
      "cost_usd": 0.015285,
      "latency_ms": 3080.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_02",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.plan, count() AS event_count\nFROM events e\nJOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 447,
      "tokens_out": 52,
      "cost_usd": 0.010605,
      "latency_ms": 2635.2
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_02",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.plan, count() AS event_count\nFROM events e\nJOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 447,
      "tokens_out": 52,
      "cost_usd": 0.010605,
      "latency_ms": 1813.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_02",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.plan, count() AS event_count\nFROM events e\nJOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 447,
      "tokens_out": 52,
      "cost_usd": 0.010605,
      "latency_ms": 2492.2
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_03",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id\nFROM users u\nLEFT JOIN events e ON u.user_id = e.user_id\nWHERE e.user_id IS NULL",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 449,
      "tokens_out": 44,
      "cost_usd": 0.010035,
      "latency_ms": 2875.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_03",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id\nFROM users u\nLEFT JOIN events e ON u.user_id = e.user_id\nWHERE e.user_id IS NULL",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 449,
      "tokens_out": 44,
      "cost_usd": 0.010035,
      "latency_ms": 2202.2
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_03",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id\nFROM users u\nLEFT JOIN events e ON u.user_id = e.user_id\nWHERE e.user_id IS NULL",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 449,
      "tokens_out": 44,
      "cost_usd": 0.010035,
      "latency_ms": 2916.7
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_04",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS (\n    SELECT user_id, count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT t.user_id, t.event_count, u.plan\nFROM top_users t\nLEFT JOIN users u ON t.user_id = u.user_id\nORDER BY t.event_count DESC",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 461,
      "tokens_out": 103,
      "cost_usd": 0.01464,
      "latency_ms": 2969.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_04",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS (\n    SELECT user_id, count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT t.user_id, t.event_count, u.plan\nFROM top_users t\nLEFT JOIN users u ON t.user_id = u.user_id\nORDER BY t.event_count DESC",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 461,
      "tokens_out": 103,
      "cost_usd": 0.01464,
      "latency_ms": 2787.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_04",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS (\n    SELECT user_id, count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT t.user_id, t.event_count, u.plan\nFROM top_users t\nLEFT JOIN users u ON t.user_id = u.user_id\nORDER BY t.event_count DESC",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 461,
      "tokens_out": 103,
      "cost_usd": 0.01464,
      "latency_ms": 1953.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_05",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT user_id, count() AS event_count\nFROM events\nGROUP BY user_id\nHAVING event_count > (SELECT avg(cnt) FROM (SELECT count() AS cnt FROM events GROUP BY user_id))\nORDER BY event_count DESC",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 455,
      "tokens_out": 63,
      "cost_usd": 0.01155,
      "latency_ms": 2947.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_05",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT user_id, count() AS event_count\nFROM events\nGROUP BY user_id\nHAVING event_count > (SELECT avg(cnt) FROM (SELECT count() AS cnt FROM events GROUP BY user_id))\nORDER BY event_count DESC",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 455,
      "tokens_out": 63,
      "cost_usd": 0.01155,
      "latency_ms": 1798.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_05",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT user_id, count() AS event_count\nFROM events\nGROUP BY user_id\nHAVING event_count > (SELECT avg(cnt) FROM (SELECT count() AS cnt FROM events GROUP BY user_id))\nORDER BY event_count DESC",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 455,
      "tokens_out": 63,
      "cost_usd": 0.01155,
      "latency_ms": 1653.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_06",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 850863\t2024-08-01 00:00:37.000\t149\tpageview\t/docs\t9698\t{'source':'facebook'}\t[]\tGB\ttablet\t3393\n98473",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 459,
      "tokens_out": 41,
      "cost_usd": 0.00996,
      "latency_ms": 2337.2
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_06",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 81015\t2024-11-01 00:04:33.000\t8349\tsignup\t/settings\t4631\t{'campaign':'launch','source':'google'}\t[]\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 459,
      "tokens_out": 41,
      "cost_usd": 0.00996,
      "latency_ms": 2515.2
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_06",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 270475\t2024-09-01 00:00:19.000\t1544\tpurchase\t/pricing\t7171\t{'source':'twitter'}\t[]\tDE\ttablet\t\\N\n8631",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 459,
      "tokens_out": 41,
      "cost_usd": 0.00996,
      "latency_ms": 1523.2
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_07",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count(e.event_id) / countDistinct(e.user_id) AS avg_events_per_user\nFROM events e\nINNER JOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 454,
      "tokens_out": 72,
      "cost_usd": 0.01221,
      "latency_ms": 2995.6
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_07",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count(e.event_id) / countDistinct(e.user_id) AS avg_events_per_user\nFROM events e\nINNER JOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 454,
      "tokens_out": 72,
      "cost_usd": 0.01221,
      "latency_ms": 2274.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_07",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count(e.event_id) / countDistinct(e.user_id) AS avg_events_per_user\nFROM events e\nINNER JOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 454,
      "tokens_out": 72,
      "cost_usd": 0.01221,
      "latency_ms": 1972.2
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_08",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id, u.email, u.created_at, u.plan, u.country\nFROM users u\nWHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01'\n  AND u.user_id IN (\n    SELECT DISTINCT user_id\n    FROM events\n    WHERE event_type = 'purchase'\n  )",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 458,
      "tokens_out": 103,
      "cost_usd": 0.014595,
      "latency_ms": 2886.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_08",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id, u.email, u.created_at, u.plan, u.country\nFROM users u\nWHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01'\n  AND u.user_id IN (\n    SELECT DISTINCT user_id\n    FROM events\n    WHERE event_type = 'purchase'\n  )",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 458,
      "tokens_out": 103,
      "cost_usd": 0.014595,
      "latency_ms": 2344.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_08",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id, u.email, u.created_at, u.plan, u.country\nFROM users u\nWHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01'\n  AND u.user_id IN (\n    SELECT DISTINCT user_id\n    FROM events\n    WHERE event_type = 'purchase'\n  )",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 458,
      "tokens_out": 103,
      "cost_usd": 0.014595,
      "latency_ms": 3026.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_09",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS user_count\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY user_count DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 455,
      "tokens_out": 44,
      "cost_usd": 0.010125,
      "latency_ms": 2438.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_09",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS user_count\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY user_count DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 455,
      "tokens_out": 44,
      "cost_usd": 0.010125,
      "latency_ms": 2769.6
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_09",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS user_count\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY user_count DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 455,
      "tokens_out": 44,
      "cost_usd": 0.010125,
      "latency_ms": 2467.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_10",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t5365\t56",
      "llm_sql": "SELECT\n    device,\n    user_id,\n    event_count\nFROM\n(\n    SELECT\n        device,\n        user_id,\n        count() AS event_count,\n        row_number() OVER (PARTITION BY device ORDER BY event_count DESC) AS rn\n    FROM events\n    GROUP BY device, user_id\n)\nWHERE rn = 1\nORDER BY device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 453,
      "tokens_out": 99,
      "cost_usd": 0.01422,
      "latency_ms": 2430.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_10",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t5365\t56",
      "llm_sql": "SELECT\n    device,\n    user_id,\n    event_count\nFROM\n(\n    SELECT\n        device,\n        user_id,\n        count() AS event_count,\n        row_number() OVER (PARTITION BY device ORDER BY event_count DESC) AS rn\n    FROM events\n    GROUP BY device, user_id\n)\nWHERE rn = 1\nORDER BY device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 453,
      "tokens_out": 99,
      "cost_usd": 0.01422,
      "latency_ms": 2164.6
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t4_10",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t5365\t56",
      "llm_sql": "SELECT\n    device,\n    user_id,\n    event_count\nFROM\n(\n    SELECT\n        device,\n        user_id,\n        count() AS event_count,\n        row_number() OVER (PARTITION BY device ORDER BY event_count DESC) AS rn\n    FROM events\n    GROUP BY device, user_id\n)\nWHERE rn = 1\nORDER BY device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 453,
      "tokens_out": 99,
      "cost_usd": 0.01422,
      "latency_ms": 2398.6
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_01",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 39540\t2024-01-01 13:38:42.000\t1\tlogout\t/docs\t7001\t{'campaign':'spring_promo','source':'email'}\t[]\tDE",
      "llm_sql": "SELECT\n    *,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_number\nFROM events\nORDER BY user_id, timestamp",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 456,
      "tokens_out": 47,
      "cost_usd": 0.010365,
      "latency_ms": 1532.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_01",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 39540\t2024-01-01 13:38:42.000\t1\tlogout\t/docs\t7001\t{'campaign':'spring_promo','source':'email'}\t[]\tDE",
      "llm_sql": "SELECT\n    *,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_number\nFROM events\nORDER BY user_id, timestamp",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 456,
      "tokens_out": 47,
      "cost_usd": 0.010365,
      "latency_ms": 2667.1
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_01",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 322782\t2024-09-19 04:19:42.000\t8067\tpurchase\t/checkout\t9693\t{'source':'direct'}\t['vip_member','premi",
      "llm_sql": "SELECT\n    *,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_number\nFROM events",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 456,
      "tokens_out": 39,
      "cost_usd": 0.009765,
      "latency_ms": 2275.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_02",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    day,\n    daily_count,\n    sum(daily_count) OVER (ORDER BY day) AS running_total\nFROM\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS daily_count\n    FROM events\n    WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\n    GROUP BY day\n)\nORDER BY day",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 453,
      "tokens_out": 102,
      "cost_usd": 0.014445,
      "latency_ms": 3461.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_02",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    day,\n    daily_count,\n    sum(daily_count) OVER (ORDER BY day) AS running_total\nFROM\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS daily_count\n    FROM events\n    WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\n    GROUP BY day\n)\nORDER BY day",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 453,
      "tokens_out": 102,
      "cost_usd": 0.014445,
      "latency_ms": 2941.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_02",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    day,\n    daily_count,\n    sum(daily_count) OVER (ORDER BY day) AS running_total\nFROM\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS daily_count\n    FROM events\n    WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\n    GROUP BY day\n)\nORDER BY day",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 453,
      "tokens_out": 102,
      "cost_usd": 0.014445,
      "latency_ms": 4841.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_03",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    day,\n    event_count,\n    lagInFrame(event_count, 1) OVER (ORDER BY day ASC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS prev_day_event_count\nFROM\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS event_count\n    FROM events\n    GROUP BY day\n)\nORDER BY day ASC",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 458,
      "tokens_out": 105,
      "cost_usd": 0.014745,
      "latency_ms": 2638.7
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_03",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    day,\n    event_count,\n    lagInFrame(event_count, 1) OVER (ORDER BY day ASC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS prev_day_event_count\nFROM\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS event_count\n    FROM events\n    GROUP BY day\n)\nORDER BY day ASC",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 458,
      "tokens_out": 105,
      "cost_usd": 0.014745,
      "latency_ms": 3577.7
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_03",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    day,\n    event_count,\n    lagInFrame(event_count, 1) OVER (ORDER BY day ASC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS prev_day_event_count\nFROM\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS event_count\n    FROM events\n    GROUP BY day\n)\nORDER BY day ASC",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 458,
      "tokens_out": 105,
      "cost_usd": 0.014745,
      "latency_ms": 3954.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_04",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t[]\n774716\t2024-12-01 00:01:20.000\t1952\tpurchase\t[]\n531475",
      "llm_sql": "SELECT event_id, timestamp, user_id, event_type, arrayMap(x -> upper(x), tags) AS tags_uppercase FROM events",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 453,
      "tokens_out": 40,
      "cost_usd": 0.009795,
      "latency_ms": 1521.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_04",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t[]\t[]\n774716\t2024-12-01 00:01:20.000\t1952\tpurchase\t[]\t[]\n",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    tags,\n    arrayMap(x -> upper(x), tags) AS tags_uppercase\nFROM events",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 453,
      "tokens_out": 55,
      "cost_usd": 0.01092,
      "latency_ms": 2529.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_04",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 823694\t2024-06-01 00:00:48.000\t3869\tclick\t[]\t[]\n682733\t2024-06-01 00:00:58.000\t9276\tlogout\t[]\t[]\n483",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    tags,\n    arrayMap(x -> upper(x), tags) AS tags_uppercase\nFROM events",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 453,
      "tokens_out": 55,
      "cost_usd": 0.01092,
      "latency_ms": 2662.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_05",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration) AS user_id_with_longest_duration,\n    max(total_duration) AS max_total_duration\nFROM\n(\n    SELECT\n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 459,
      "tokens_out": 122,
      "cost_usd": 0.016035,
      "latency_ms": 3509.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_05",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration) AS user_id_with_longest_duration,\n    max(total_duration) AS max_total_duration\nFROM\n(\n    SELECT\n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 459,
      "tokens_out": 122,
      "cost_usd": 0.016035,
      "latency_ms": 3832.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_05",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration) AS user_id_with_longest_duration,\n    max(total_duration) AS max_total_duration\nFROM\n(\n    SELECT\n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 459,
      "tokens_out": 122,
      "cost_usd": 0.016035,
      "latency_ms": 4023.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_06",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day ASC WITH FILL FROM toDate('2024-01-01') TO toDate('2024-02-01')",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 460,
      "tokens_out": 88,
      "cost_usd": 0.0135,
      "latency_ms": 2370.3
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_06",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day ASC WITH FILL FROM toDate('2024-01-01') TO toDate('2024-02-01') STEP 1",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 460,
      "tokens_out": 92,
      "cost_usd": 0.0138,
      "latency_ms": 4163.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_06",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day ASC WITH FILL FROM toDate('2024-01-01') TO toDate('2024-02-01') STEP 1",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 460,
      "tokens_out": 92,
      "cost_usd": 0.0138,
      "latency_ms": 3197.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_07",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t['click','logout','pageview','purchase','signup']\n2\t['click','logout','pageview','purchase','signu",
      "llm_sql": "SELECT\n    user_id,\n    arraySort(groupUniqArray(event_type)) AS event_types\nFROM events\nGROUP BY user_id\nORDER BY user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 454,
      "tokens_out": 48,
      "cost_usd": 0.01041,
      "latency_ms": 2492.9
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_07",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t['click','logout','pageview','purchase','signup']\n2\t['click','logout','pageview','purchase','signu",
      "llm_sql": "SELECT\n    user_id,\n    arraySort(groupUniqArray(event_type)) AS event_types\nFROM events\nGROUP BY user_id\nORDER BY user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 454,
      "tokens_out": 48,
      "cost_usd": 0.01041,
      "latency_ms": 2606.2
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_07",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t['click','logout','pageview','purchase','signup']\n2\t['click','logout','pageview','purchase','signu",
      "llm_sql": "SELECT\n    user_id,\n    arraySort(groupUniqArray(event_type)) AS event_types\nFROM events\nGROUP BY user_id\nORDER BY user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 454,
      "tokens_out": 48,
      "cost_usd": 0.01041,
      "latency_ms": 1561.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_08",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t901732\t2024-12-29 23:26:55.000\tpurchase\t/dashboard\t7642\tCA\tmobile\t9194\n9529\t728022\t2024-12-26 0",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS last_event_id,\n    max(timestamp) AS last_event_timestamp,\n    argMax(event_type, timestamp) AS last_event_type,\n    argMax(page, timestamp) AS last_page,\n    argMax(duration_ms, timestamp) AS last_duration_ms,\n    argMax(country, timestamp) AS last_country,\n    argMax(device, timestamp) AS last_device,\n    argMax(revenue_cents, timestamp) AS last_revenue_cents\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 451,
      "tokens_out": 150,
      "cost_usd": 0.018015,
      "latency_ms": 3852.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_08",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3699\t188795\t2024-12-17 19:20:00.000\tpageview\t/about\t5018\tGB\tdesktop\t2915\n8130\t512257\t2024-12-24 22:5",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS last_event_id,\n    max(timestamp) AS last_event_timestamp,\n    argMax(event_type, timestamp) AS last_event_type,\n    argMax(page, timestamp) AS last_page,\n    argMax(duration_ms, timestamp) AS last_duration_ms,\n    argMax(country, timestamp) AS last_country,\n    argMax(device, timestamp) AS last_device,\n    argMax(revenue_cents, timestamp) AS last_revenue_cents\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 451,
      "tokens_out": 150,
      "cost_usd": 0.018015,
      "latency_ms": 3349.0
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_08",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t901732\t2024-12-29 23:26:55.000\tpurchase\t/dashboard\t7642\tCA\tmobile\t9194\n9529\t728022\t2024-12-26 0",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS last_event_id,\n    max(timestamp) AS last_event_timestamp,\n    argMax(event_type, timestamp) AS last_event_type,\n    argMax(page, timestamp) AS last_page,\n    argMax(duration_ms, timestamp) AS last_duration_ms,\n    argMax(country, timestamp) AS last_country,\n    argMax(device, timestamp) AS last_device,\n    argMax(revenue_cents, timestamp) AS last_revenue_cents\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 451,
      "tokens_out": 150,
      "cost_usd": 0.018015,
      "latency_ms": 3061.7
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_09",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH hours AS (\n    SELECT toDateTime('2024-06-15 00:00:00', 'UTC') + INTERVAL number HOUR AS hour\n    FROM numbers(24)\n)\nSELECT\n    h.hour,\n    count(e.event_id) AS event_count\nFROM hours h\nLEFT JOIN events e\n    ON toStartOfHour(e.timestamp) = h.hour\n    AND toDate(e.timestamp, 'UTC') = '2024-06-15'\nGROUP BY h.hour\nORDER BY h.hour",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 467,
      "tokens_out": 135,
      "cost_usd": 0.01713,
      "latency_ms": 3709.4
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_09",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH hours AS (\n    SELECT toDateTime('2024-06-15 00:00:00', 'UTC') + INTERVAL number HOUR AS hour\n    FROM numbers(24)\n)\nSELECT\n    h.hour,\n    count(e.event_id) AS event_count\nFROM hours h\nLEFT JOIN events e\n    ON toStartOfHour(e.timestamp) = h.hour\n    AND toDate(e.timestamp, 'UTC') = '2024-06-15'\nGROUP BY h.hour\nORDER BY h.hour",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 467,
      "tokens_out": 135,
      "cost_usd": 0.01713,
      "latency_ms": 3750.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_09",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH hours AS (\n    SELECT toDateTime('2024-06-15 00:00:00', 'UTC') + INTERVAL number HOUR AS hour\n    FROM numbers(24)\n)\nSELECT\n    h.hour,\n    count(e.event_id) AS event_count\nFROM hours h\nLEFT JOIN events e\n    ON toStartOfHour(e.timestamp) = h.hour\n    AND toDate(e.timestamp, 'UTC') = '2024-06-15'\nGROUP BY h.hour\nORDER BY h.hour",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 467,
      "tokens_out": 135,
      "cost_usd": 0.01713,
      "latency_ms": 3538.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_10",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: ",
      "llm_sql": "SELECT\n    user_id,\n    arrayDistinct(arrayFilter(t -> t = 'premium', groupArrayArray(tags))) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING length(premium_tags) > 0",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 470,
      "tokens_out": 63,
      "cost_usd": 0.011775,
      "latency_ms": 3037.8
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_10",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: ",
      "llm_sql": "SELECT\n    user_id,\n    arrayDistinct(arrayFilter(t -> t = 'premium', groupArrayArray(tags))) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING length(premium_tags) > 0",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 470,
      "tokens_out": 63,
      "cost_usd": 0.011775,
      "latency_ms": 2980.5
    },
    {
      "model": "claude-opus-4.6",
      "question_id": "t5_10",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: ",
      "llm_sql": "SELECT\n    user_id,\n    arrayDistinct(arrayFilter(t -> t = 'premium', groupArrayArray(tags))) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING length(premium_tags) > 0",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 470,
      "tokens_out": 63,
      "cost_usd": 0.011775,
      "latency_ms": 3176.7
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_01",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 453,
      "tokens_out": 8,
      "cost_usd": 0.007395,
      "latency_ms": 1807
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_01",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 453,
      "tokens_out": 8,
      "cost_usd": 0.007395,
      "latency_ms": 1335
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_01",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 453,
      "tokens_out": 8,
      "cost_usd": 0.007395,
      "latency_ms": 1682
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_02",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 453,
      "tokens_out": 23,
      "cost_usd": 0.00852,
      "latency_ms": 1591
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_02",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 453,
      "tokens_out": 23,
      "cost_usd": 0.00852,
      "latency_ms": 1005
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_02",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 453,
      "tokens_out": 23,
      "cost_usd": 0.00852,
      "latency_ms": 1883
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_03",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE toYYYYMM(timestamp) = 202403",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 454,
      "tokens_out": 28,
      "cost_usd": 0.00891,
      "latency_ms": 1211
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_03",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE toYYYYMM(timestamp) = 202403",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 454,
      "tokens_out": 28,
      "cost_usd": 0.00891,
      "latency_ms": 1766
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_03",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE toYYYYMM(timestamp) = 202403",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 454,
      "tokens_out": 28,
      "cost_usd": 0.00891,
      "latency_ms": 2349
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_04",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 450,
      "tokens_out": 11,
      "cost_usd": 0.007575,
      "latency_ms": 1790
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_04",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 450,
      "tokens_out": 11,
      "cost_usd": 0.007575,
      "latency_ms": 2312
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_04",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 450,
      "tokens_out": 11,
      "cost_usd": 0.007575,
      "latency_ms": 1950
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_05",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count(*) FROM events WHERE country = 'DE'",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 451,
      "tokens_out": 16,
      "cost_usd": 0.007965,
      "latency_ms": 1292
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_05",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count(*) FROM events WHERE country = 'DE'",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 451,
      "tokens_out": 16,
      "cost_usd": 0.007965,
      "latency_ms": 836
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_05",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 451,
      "tokens_out": 20,
      "cost_usd": 0.008265,
      "latency_ms": 1960
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_06",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 461,
      "tokens_out": 32,
      "cost_usd": 0.009315,
      "latency_ms": 1952
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_06",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 461,
      "tokens_out": 32,
      "cost_usd": 0.009315,
      "latency_ms": 2186
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_06",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 461,
      "tokens_out": 32,
      "cost_usd": 0.009315,
      "latency_ms": 2733
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_07",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 456,
      "tokens_out": 20,
      "cost_usd": 0.00834,
      "latency_ms": 1049
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_07",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 456,
      "tokens_out": 20,
      "cost_usd": 0.00834,
      "latency_ms": 1883
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_07",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 456,
      "tokens_out": 20,
      "cost_usd": 0.00834,
      "latency_ms": 2035
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_08",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 453,
      "tokens_out": 24,
      "cost_usd": 0.008595,
      "latency_ms": 1976
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_08",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 453,
      "tokens_out": 24,
      "cost_usd": 0.008595,
      "latency_ms": 2191
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_08",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 453,
      "tokens_out": 24,
      "cost_usd": 0.008595,
      "latency_ms": 1737
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_09",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01'\n  AND timestamp < '2025-01-01'\nORDER BY timestamp",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 459,
      "tokens_out": 51,
      "cost_usd": 0.01071,
      "latency_ms": 2345
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_09",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01'\n  AND timestamp < '2025-01-01'\nORDER BY timestamp",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 459,
      "tokens_out": 51,
      "cost_usd": 0.01071,
      "latency_ms": 1901
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_09",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01'\n  AND timestamp < '2025-01-01'\nORDER BY timestamp",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 459,
      "tokens_out": 51,
      "cost_usd": 0.01071,
      "latency_ms": 983
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_10",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 456,
      "tokens_out": 20,
      "cost_usd": 0.00834,
      "latency_ms": 1905
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_10",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 456,
      "tokens_out": 20,
      "cost_usd": 0.00834,
      "latency_ms": 1630
    },
    {
      "model": "claude-opus-4",
      "question_id": "t1_10",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 456,
      "tokens_out": 20,
      "cost_usd": 0.00834,
      "latency_ms": 1147
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_01",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 457,
      "tokens_out": 28,
      "cost_usd": 0.008955,
      "latency_ms": 2194
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_01",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 457,
      "tokens_out": 28,
      "cost_usd": 0.008955,
      "latency_ms": 1130
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_01",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 457,
      "tokens_out": 28,
      "cost_usd": 0.008955,
      "latency_ms": 1879
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_02",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT device, avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY avg_duration_ms DESC",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 455,
      "tokens_out": 47,
      "cost_usd": 0.01035,
      "latency_ms": 2497
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_02",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT device, avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY avg_duration_ms DESC",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 455,
      "tokens_out": 47,
      "cost_usd": 0.01035,
      "latency_ms": 2429
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_02",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT device, avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY avg_duration_ms DESC",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 455,
      "tokens_out": 47,
      "cost_usd": 0.01035,
      "latency_ms": 1414
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_03",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 457,
      "tokens_out": 61,
      "cost_usd": 0.01143,
      "latency_ms": 1167
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_03",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 457,
      "tokens_out": 61,
      "cost_usd": 0.01143,
      "latency_ms": 1939
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_03",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 457,
      "tokens_out": 61,
      "cost_usd": 0.01143,
      "latency_ms": 1782
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_04",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS event_count\nFROM events\nGROUP BY country\nHAVING event_count > 10000\nORDER BY event_count DESC",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 455,
      "tokens_out": 41,
      "cost_usd": 0.0099,
      "latency_ms": 2670
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_04",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS event_count\nFROM events\nGROUP BY country\nHAVING event_count > 10000\nORDER BY event_count DESC",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 455,
      "tokens_out": 41,
      "cost_usd": 0.0099,
      "latency_ms": 1719
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_04",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS event_count\nFROM events\nGROUP BY country\nHAVING event_count > 10000\nORDER BY event_count DESC",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 455,
      "tokens_out": 41,
      "cost_usd": 0.0099,
      "latency_ms": 1056
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_05",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toHour(timestamp) AS hour, count() AS event_count\nFROM events\nGROUP BY hour\nORDER BY hour",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 455,
      "tokens_out": 35,
      "cost_usd": 0.00945,
      "latency_ms": 1841
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_05",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toHour(timestamp) AS hour, count() AS event_count\nFROM events\nGROUP BY hour\nORDER BY hour",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 455,
      "tokens_out": 35,
      "cost_usd": 0.00945,
      "latency_ms": 781
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_05",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toHour(timestamp) AS hour, count() AS event_count\nFROM events\nGROUP BY hour\nORDER BY hour",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 455,
      "tokens_out": 35,
      "cost_usd": 0.00945,
      "latency_ms": 1854
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_06",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) FROM events WHERE event_type = 'pageview'",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 460,
      "tokens_out": 27,
      "cost_usd": 0.008925,
      "latency_ms": 1114
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_06",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) FROM events WHERE event_type = 'pageview'",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 460,
      "tokens_out": 27,
      "cost_usd": 0.008925,
      "latency_ms": 2370
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_06",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) FROM events WHERE event_type = 'pageview'",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 460,
      "tokens_out": 27,
      "cost_usd": 0.008925,
      "latency_ms": 808
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_07",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY month\nORDER BY month",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 454,
      "tokens_out": 59,
      "cost_usd": 0.011235,
      "latency_ms": 1129
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_07",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY month\nORDER BY month",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 454,
      "tokens_out": 59,
      "cost_usd": 0.011235,
      "latency_ms": 880
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_07",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY month\nORDER BY month",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 454,
      "tokens_out": 59,
      "cost_usd": 0.011235,
      "latency_ms": 2470
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_08",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count(DISTINCT country) AS distinct_countries\nFROM events\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 456,
      "tokens_out": 32,
      "cost_usd": 0.00924,
      "latency_ms": 2003
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_08",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count(DISTINCT country) AS distinct_countries\nFROM events\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 456,
      "tokens_out": 32,
      "cost_usd": 0.00924,
      "latency_ms": 1848
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_08",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count(DISTINCT country) AS distinct_countries\nFROM events\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 456,
      "tokens_out": 32,
      "cost_usd": 0.00924,
      "latency_ms": 2274
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_09",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 458,
      "tokens_out": 47,
      "cost_usd": 0.010395,
      "latency_ms": 2027
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_09",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 458,
      "tokens_out": 47,
      "cost_usd": 0.010395,
      "latency_ms": 1704
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_09",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 458,
      "tokens_out": 47,
      "cost_usd": 0.010395,
      "latency_ms": 2106
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_10",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    countIf(event_type = 'purchase') AS purchase_count,\n    countIf(event_type = 'pageview') AS pageview_count\nFROM events\nWHERE event_type IN ('purchase', 'pageview')",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 458,
      "tokens_out": 65,
      "cost_usd": 0.011745,
      "latency_ms": 1146
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_10",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    countIf(event_type = 'purchase') AS purchase_count,\n    countIf(event_type = 'pageview') AS pageview_count\nFROM events\nWHERE event_type IN ('purchase', 'pageview')",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 458,
      "tokens_out": 65,
      "cost_usd": 0.011745,
      "latency_ms": 1022
    },
    {
      "model": "claude-opus-4",
      "question_id": "t2_10",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    countIf(event_type = 'purchase') AS purchase_count,\n    countIf(event_type = 'pageview') AS pageview_count\nFROM events\nWHERE event_type IN ('purchase', 'pageview')",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 458,
      "tokens_out": 65,
      "cost_usd": 0.011745,
      "latency_ms": 2181
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_01",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration_ms FROM events",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 455,
      "tokens_out": 23,
      "cost_usd": 0.00855,
      "latency_ms": 2491
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_01",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration_ms FROM events",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 455,
      "tokens_out": 23,
      "cost_usd": 0.00855,
      "latency_ms": 1293
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_01",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration_ms FROM events",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 455,
      "tokens_out": 23,
      "cost_usd": 0.00855,
      "latency_ms": 1737
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_02",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT uniqExact(user_id) FROM events",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 456,
      "tokens_out": 15,
      "cost_usd": 0.007965,
      "latency_ms": 2276
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_02",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT uniqExact(user_id) FROM events",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 456,
      "tokens_out": 15,
      "cost_usd": 0.007965,
      "latency_ms": 1938
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_02",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT uniqExact(user_id) FROM events",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 456,
      "tokens_out": 15,
      "cost_usd": 0.007965,
      "latency_ms": 2058
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_03",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 521466\t2024-10-01 00:01:11.000\t1302\tlogout\t/docs\t9913\t{'campaign':'black_friday','source':'direct'}\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 458,
      "tokens_out": 25,
      "cost_usd": 0.008745,
      "latency_ms": 2126
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_03",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 566193\t2024-05-01 00:01:55.000\t2505\tsignup\t/dashboard\t9494\t{'campaign':'black_friday','source':'twit",
      "llm_sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 458,
      "tokens_out": 25,
      "cost_usd": 0.008745,
      "latency_ms": 956
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_03",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 553579\t2024-03-01 00:00:32.000\t1637\tsignup\t/dashboard\t\\N\t{'campaign':'launch','source':'google'}\t[]\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 458,
      "tokens_out": 25,
      "cost_usd": 0.008745,
      "latency_ms": 854
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_04",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 467,
      "tokens_out": 37,
      "cost_usd": 0.00978,
      "latency_ms": 1709
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_04",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 467,
      "tokens_out": 37,
      "cost_usd": 0.00978,
      "latency_ms": 1134
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_04",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 467,
      "tokens_out": 37,
      "cost_usd": 0.00978,
      "latency_ms": 2088
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_05",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT tag, count() AS occurrences\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY occurrences DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 467,
      "tokens_out": 38,
      "cost_usd": 0.009855,
      "latency_ms": 997
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_05",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT tag, count() AS occurrences\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY occurrences DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 467,
      "tokens_out": 38,
      "cost_usd": 0.009855,
      "latency_ms": 1435
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_05",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT tag, count() AS occurrences\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY occurrences DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 467,
      "tokens_out": 38,
      "cost_usd": 0.009855,
      "latency_ms": 2236
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_06",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 877989\t2024-12-01 00:09:55.000\t6543\tpageview\t/home\t9658\t{'source':'direct'}\t['promo']\tFR\tdesktop\t\\N\n",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 460,
      "tokens_out": 24,
      "cost_usd": 0.0087,
      "latency_ms": 2265
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_06",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 337459\t2024-08-01 00:05:33.000\t7274\tclick\t/docs\t8433\t{'source':'direct'}\t['promo','vip_member','mobi",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 460,
      "tokens_out": 24,
      "cost_usd": 0.0087,
      "latency_ms": 952
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_06",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 644674\t2024-11-01 00:08:01.000\t6051\tclick\t/docs\t\\N\t{'source':'email'}\t['promo','vip_member','premium",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 460,
      "tokens_out": 24,
      "cost_usd": 0.0087,
      "latency_ms": 1716
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_07",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    quantile(0.90)(duration_ms) AS p90_duration_ms,\n    quantile(0.99)(duration_ms) AS p99_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 463,
      "tokens_out": 79,
      "cost_usd": 0.01287,
      "latency_ms": 1837
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_07",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    quantile(0.90)(duration_ms) AS p90_duration_ms,\n    quantile(0.99)(duration_ms) AS p99_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 463,
      "tokens_out": 79,
      "cost_usd": 0.01287,
      "latency_ms": 2981
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_07",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    quantile(0.90)(duration_ms) AS p90_duration_ms,\n    quantile(0.99)(duration_ms) AS p99_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 463,
      "tokens_out": 79,
      "cost_usd": 0.01287,
      "latency_ms": 1181
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_08",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue_cents\nFROM events",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 462,
      "tokens_out": 32,
      "cost_usd": 0.00933,
      "latency_ms": 2153
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_08",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue_cents\nFROM events",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 462,
      "tokens_out": 32,
      "cost_usd": 0.00933,
      "latency_ms": 1892
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_08",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue_cents\nFROM events",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 462,
      "tokens_out": 32,
      "cost_usd": 0.00933,
      "latency_ms": 1978
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_09",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 458,
      "tokens_out": 24,
      "cost_usd": 0.00867,
      "latency_ms": 1037
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_09",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 458,
      "tokens_out": 24,
      "cost_usd": 0.00867,
      "latency_ms": 1794
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_09",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 458,
      "tokens_out": 24,
      "cost_usd": 0.00867,
      "latency_ms": 1947
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_10",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 227800\t2024-06-01 00:02:52.000\t5652\tclick\t/checkout\t\\N\t{'campaign':'launch','source':'email'}\t['vip_",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(tag -> tag LIKE 'vip%', tags)",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 464,
      "tokens_out": 31,
      "cost_usd": 0.009285,
      "latency_ms": 1096
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_10",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 349664\t2024-12-01 00:01:56.000\t1508\tpageview\t/home\t\\N\t{'source':'google'}\t['vip_member']\tGB\ttablet\t\\",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(tag -> tag LIKE 'vip%', tags)",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 464,
      "tokens_out": 31,
      "cost_usd": 0.009285,
      "latency_ms": 1799
    },
    {
      "model": "claude-opus-4",
      "question_id": "t3_10",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 78581\t2024-11-01 00:07:22.000\t7126\tpageview\t/dashboard\t\\N\t{'source':'email'}\t['vip_member','new']\tJP",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(tag -> tag LIKE 'vip%', tags)",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 464,
      "tokens_out": 31,
      "cost_usd": 0.009285,
      "latency_ms": 847
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_01",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 669632\t2024-09-01 00:00:08.000\t3308\tpurchase\t/about\t7933\t{'source':'twitter'}\t['mobile']\tGB\tmobile\t3",
      "llm_sql": "SELECT\n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events AS e\nJOIN users AS u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 463,
      "tokens_out": 112,
      "cost_usd": 0.015345,
      "latency_ms": 1952
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_01",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 387880\t2024-11-01 00:00:19.000\t6365\tclick\t/docs\t\\N\t{'source':'google'}\t[]\tIN\tdesktop\t9843\tfree\n62563",
      "llm_sql": "SELECT\n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events AS e\nJOIN users AS u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 463,
      "tokens_out": 112,
      "cost_usd": 0.015345,
      "latency_ms": 1024
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_01",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t/blog\t\\N\t{'source':'facebook'}\t[]\tBR\ttablet\t\\N\tpro\n774716",
      "llm_sql": "SELECT\n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events AS e\nJOIN users AS u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 463,
      "tokens_out": 112,
      "cost_usd": 0.015345,
      "latency_ms": 1742
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_02",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.plan, count() AS event_count\nFROM events e\nJOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 451,
      "tokens_out": 52,
      "cost_usd": 0.010665,
      "latency_ms": 1737
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_02",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.plan, count() AS event_count\nFROM events e\nJOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 451,
      "tokens_out": 52,
      "cost_usd": 0.010665,
      "latency_ms": 2055
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_02",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.plan, count() AS event_count\nFROM events e\nJOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 451,
      "tokens_out": 52,
      "cost_usd": 0.010665,
      "latency_ms": 1072
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_03",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id\nFROM users u\nLEFT ANTI JOIN events e ON u.user_id = e.user_id",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 453,
      "tokens_out": 37,
      "cost_usd": 0.00957,
      "latency_ms": 1122
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_03",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id\nFROM users u\nLEFT JOIN events e ON u.user_id = e.user_id\nWHERE e.user_id IS NULL",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 453,
      "tokens_out": 44,
      "cost_usd": 0.010095,
      "latency_ms": 1182
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_03",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id\nFROM users u\nLEFT ANTI JOIN events e ON u.user_id = e.user_id",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 453,
      "tokens_out": 37,
      "cost_usd": 0.00957,
      "latency_ms": 1129
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_04",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS (\n    SELECT user_id, count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT t.user_id, t.event_count, u.plan\nFROM top_users t\nLEFT JOIN users u ON t.user_id = u.user_id\nORDER BY t.event_count DESC",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 465,
      "tokens_out": 103,
      "cost_usd": 0.0147,
      "latency_ms": 1834
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_04",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS (\n    SELECT user_id, count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT t.user_id, t.event_count, u.plan\nFROM top_users t\nLEFT JOIN users u ON t.user_id = u.user_id\nORDER BY t.event_count DESC",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 465,
      "tokens_out": 103,
      "cost_usd": 0.0147,
      "latency_ms": 881
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_04",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS (\n    SELECT user_id, count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT t.user_id, t.event_count, u.plan\nFROM top_users t\nLEFT JOIN users u ON t.user_id = u.user_id\nORDER BY t.event_count DESC",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 465,
      "tokens_out": 103,
      "cost_usd": 0.0147,
      "latency_ms": 2062
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_05",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT user_id, count() AS event_count\nFROM events\nGROUP BY user_id\nHAVING event_count > (SELECT avg(cnt) FROM (SELECT count() AS cnt FROM events GROUP BY user_id))\nORDER BY event_count DESC",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 459,
      "tokens_out": 63,
      "cost_usd": 0.01161,
      "latency_ms": 1886
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_05",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT user_id, count() AS event_count\nFROM events\nGROUP BY user_id\nHAVING event_count > (SELECT avg(cnt) FROM (SELECT count() AS cnt FROM events GROUP BY user_id))\nORDER BY event_count DESC",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 459,
      "tokens_out": 63,
      "cost_usd": 0.01161,
      "latency_ms": 1131
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_05",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT user_id, count() AS event_count\nFROM events\nGROUP BY user_id\nHAVING event_count > (SELECT avg(cnt) FROM (SELECT count() AS cnt FROM events GROUP BY user_id))\nORDER BY event_count DESC",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 459,
      "tokens_out": 63,
      "cost_usd": 0.01161,
      "latency_ms": 1752
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_06",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 81015\t2024-11-01 00:04:33.000\t8349\tsignup\t/settings\t4631\t{'campaign':'launch','source':'google'}\t[]\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 463,
      "tokens_out": 41,
      "cost_usd": 0.01002,
      "latency_ms": 2114
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_06",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 623619\t2024-06-01 00:03:08.000\t8946\tpurchase\t/docs\t4754\t{'source':'twitter'}\t[]\tCA\tmobile\t\\N\n878476\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 463,
      "tokens_out": 41,
      "cost_usd": 0.01002,
      "latency_ms": 1950
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_06",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 850863\t2024-08-01 00:00:37.000\t149\tpageview\t/docs\t9698\t{'source':'facebook'}\t[]\tGB\ttablet\t3393\n98473",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 463,
      "tokens_out": 41,
      "cost_usd": 0.01002,
      "latency_ms": 2027
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_07",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count(e.event_id) / count(DISTINCT e.user_id) AS avg_events_per_user\nFROM events e\nINNER JOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 458,
      "tokens_out": 72,
      "cost_usd": 0.01227,
      "latency_ms": 1875
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_07",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count(e.event_id) / countDistinct(e.user_id) AS avg_events_per_user\nFROM events e\nINNER JOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 458,
      "tokens_out": 72,
      "cost_usd": 0.01227,
      "latency_ms": 1715
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_07",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count(e.event_id) / countDistinct(e.user_id) AS avg_events_per_user\nFROM events e\nINNER JOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 458,
      "tokens_out": 72,
      "cost_usd": 0.01227,
      "latency_ms": 1900
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_08",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id, u.email, u.created_at, u.plan, u.country\nFROM users u\nWHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01'\n  AND u.user_id IN (\n    SELECT DISTINCT user_id\n    FROM events\n    WHERE event_type = 'purchase'\n  )",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 462,
      "tokens_out": 103,
      "cost_usd": 0.014655,
      "latency_ms": 2451
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_08",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id, u.email, u.created_at, u.plan\nFROM users u\nWHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01'\n  AND u.user_id IN (\n    SELECT DISTINCT user_id\n    FROM events\n    WHERE event_type = 'purchase'\n  )",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 462,
      "tokens_out": 99,
      "cost_usd": 0.014355,
      "latency_ms": 953
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_08",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at, u.plan\nFROM users u\nINNER JOIN events e ON u.user_id = e.user_id AND e.event_type = 'purchase'\nWHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01'",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 462,
      "tokens_out": 94,
      "cost_usd": 0.01398,
      "latency_ms": 1694
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_09",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS user_count\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY user_count DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 459,
      "tokens_out": 44,
      "cost_usd": 0.010185,
      "latency_ms": 1841
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_09",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS user_count\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY user_count DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 459,
      "tokens_out": 44,
      "cost_usd": 0.010185,
      "latency_ms": 855
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_09",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS user_count\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY user_count DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 459,
      "tokens_out": 44,
      "cost_usd": 0.010185,
      "latency_ms": 1725
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_10",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t5365\t56",
      "llm_sql": "SELECT\n    device,\n    user_id,\n    event_count\nFROM\n(\n    SELECT\n        device,\n        user_id,\n        count() AS event_count,\n        row_number() OVER (PARTITION BY device ORDER BY count() DESC) AS rn\n    FROM events\n    GROUP BY device, user_id\n)\nWHERE rn = 1\nORDER BY device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 457,
      "tokens_out": 98,
      "cost_usd": 0.014205,
      "latency_ms": 1730
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_10",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t5365\t56",
      "llm_sql": "SELECT\n    device,\n    user_id,\n    event_count\nFROM\n(\n    SELECT\n        device,\n        user_id,\n        count() AS event_count,\n        row_number() OVER (PARTITION BY device ORDER BY count() DESC) AS rn\n    FROM events\n    GROUP BY device, user_id\n)\nWHERE rn = 1\nORDER BY device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 457,
      "tokens_out": 98,
      "cost_usd": 0.014205,
      "latency_ms": 1342
    },
    {
      "model": "claude-opus-4",
      "question_id": "t4_10",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t5365\t56",
      "llm_sql": "SELECT\n    device,\n    user_id,\n    event_count\nFROM\n(\n    SELECT\n        device,\n        user_id,\n        count() AS event_count,\n        row_number() OVER (PARTITION BY device ORDER BY count() DESC) AS rn\n    FROM events\n    GROUP BY device, user_id\n)\nWHERE rn = 1\nORDER BY device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 457,
      "tokens_out": 98,
      "cost_usd": 0.014205,
      "latency_ms": 1774
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_01",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 276842\t2024-02-24 21:54:05.000\t8169\tpageview\t/pricing\t\\N\t{'source':'direct'}\t[]\tFR\tdesktop\t\\N\t12\n891",
      "llm_sql": "SELECT\n    *,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_number\nFROM events",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 460,
      "tokens_out": 39,
      "cost_usd": 0.009825,
      "latency_ms": 1707
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_01",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 922606\t2024-05-15 00:21:18.000\t8039\tpurchase\t/blog\t9993\t{'campaign':'black_friday','source':'faceboo",
      "llm_sql": "SELECT\n    *,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_number\nFROM events",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 460,
      "tokens_out": 39,
      "cost_usd": 0.009825,
      "latency_ms": 2026
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_01",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 373907\t2024-01-02 08:06:44.000\t4\tclick\t/dashboard\t\\N\t{'source':'email'}\t[]\tBR\tmobile\t\\N\t1\n44952\t2024",
      "llm_sql": "SELECT\n    *,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_number\nFROM events",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 460,
      "tokens_out": 39,
      "cost_usd": 0.009825,
      "latency_ms": 1848
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_02",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    day,\n    daily_count,\n    sum(daily_count) OVER (ORDER BY day) AS running_total\nFROM\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS daily_count\n    FROM events\n    WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\n    GROUP BY day\n)\nORDER BY day",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 457,
      "tokens_out": 102,
      "cost_usd": 0.014505,
      "latency_ms": 2417
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_02",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    date,\n    daily_count,\n    sum(daily_count) OVER (ORDER BY date) AS running_total\nFROM\n(\n    SELECT\n        toDate(timestamp) AS date,\n        count() AS daily_count\n    FROM events\n    WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\n    GROUP BY date\n)\nORDER BY date",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 457,
      "tokens_out": 102,
      "cost_usd": 0.014505,
      "latency_ms": 1095
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_02",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    date,\n    daily_count,\n    sum(daily_count) OVER (ORDER BY date) AS running_total\nFROM\n(\n    SELECT\n        toDate(timestamp) AS date,\n        count() AS daily_count\n    FROM events\n    WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\n    GROUP BY date\n)\nORDER BY date",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 457,
      "tokens_out": 102,
      "cost_usd": 0.014505,
      "latency_ms": 1028
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_03",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    day,\n    event_count,\n    lagInFrame(event_count, 1) OVER (ORDER BY day ASC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS prev_day_event_count\nFROM\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS event_count\n    FROM events\n    GROUP BY day\n)\nORDER BY day ASC",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 462,
      "tokens_out": 105,
      "cost_usd": 0.014805,
      "latency_ms": 1924
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_03",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    day,\n    event_count,\n    lagInFrame(event_count, 1) OVER (ORDER BY day ASC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS prev_day_event_count\nFROM\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS event_count\n    FROM events\n    GROUP BY day\n)\nORDER BY day",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 462,
      "tokens_out": 103,
      "cost_usd": 0.014655,
      "latency_ms": 2473
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_03",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    day,\n    event_count,\n    lagInFrame(event_count, 1) OVER (ORDER BY day ASC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS prev_day_event_count\nFROM\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS event_count\n    FROM events\n    GROUP BY day\n)\nORDER BY day ASC",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 462,
      "tokens_out": 105,
      "cost_usd": 0.014805,
      "latency_ms": 1642
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_04",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 139299\t2024-10-01 00:00:42.000\t7817\tclick\t['mobile']\t['MOBILE']\n509773\t2024-10-01 00:01:05.000\t8335\t",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    tags,\n    arrayMap(x -> upper(x), tags) AS tags_uppercase\nFROM events",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 457,
      "tokens_out": 55,
      "cost_usd": 0.01098,
      "latency_ms": 3850
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_04",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 469406\t2024-08-01 00:00:27.000\t2518\tsignup\t[]\t[]\n850863\t2024-08-01 00:00:37.000\t149\tpageview\t[]\t[]\n9",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    tags,\n    arrayMap(x -> upper(x), tags) AS tags_uppercase\nFROM events",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 457,
      "tokens_out": 55,
      "cost_usd": 0.01098,
      "latency_ms": 1927
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_04",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 276933\t2024-04-01 00:00:42.000\t5857\tlogout\t['vip_member','mobile']\t['VIP_MEMBER','MOBILE']\n734343\t20",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    tags,\n    arrayMap(x -> upper(x), tags) AS tags_uppercase\nFROM events",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 457,
      "tokens_out": 55,
      "cost_usd": 0.01098,
      "latency_ms": 1993
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_05",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration) AS user_with_longest_duration,\n    max(total_duration) AS longest_total_duration\nFROM\n(\n    SELECT\n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 463,
      "tokens_out": 120,
      "cost_usd": 0.015945,
      "latency_ms": 1792
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_05",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration) AS user_with_longest_duration,\n    max(total_duration) AS longest_total_duration\nFROM\n(\n    SELECT\n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 463,
      "tokens_out": 120,
      "cost_usd": 0.015945,
      "latency_ms": 1819
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_05",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration) AS user_with_longest_duration,\n    max(total_duration) AS longest_total_duration\nFROM\n(\n    SELECT\n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 463,
      "tokens_out": 120,
      "cost_usd": 0.015945,
      "latency_ms": 1836
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_06",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day ASC WITH FILL FROM toDate('2024-01-01') TO toDate('2024-02-01') STEP 1",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 464,
      "tokens_out": 92,
      "cost_usd": 0.01386,
      "latency_ms": 1834
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_06",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day ASC WITH FILL FROM toDate('2024-01-01') TO toDate('2024-02-01') STEP 1",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 464,
      "tokens_out": 92,
      "cost_usd": 0.01386,
      "latency_ms": 1881
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_06",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day ASC WITH FILL FROM toDate('2024-01-01') TO toDate('2024-02-01') STEP 1",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 464,
      "tokens_out": 92,
      "cost_usd": 0.01386,
      "latency_ms": 1844
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_07",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t['click','logout','pageview','purchase','signup']\n2\t['click','logout','pageview','purchase','signu",
      "llm_sql": "SELECT\n    user_id,\n    arraySort(groupUniqArray(event_type)) AS event_types\nFROM events\nGROUP BY user_id\nORDER BY user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 458,
      "tokens_out": 48,
      "cost_usd": 0.01047,
      "latency_ms": 911
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_07",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t['click','logout','pageview','purchase','signup']\n9529\t['click','logout','pageview','purchase',",
      "llm_sql": "SELECT\n    user_id,\n    arraySort(groupUniqArray(event_type)) AS event_types\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 458,
      "tokens_out": 42,
      "cost_usd": 0.01002,
      "latency_ms": 2042
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_07",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t['click','logout','pageview','purchase','signup']\n9529\t['click','logout','pageview','purchase',",
      "llm_sql": "SELECT\n    user_id,\n    arraySort(groupUniqArray(event_type)) AS event_types\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 458,
      "tokens_out": 42,
      "cost_usd": 0.01002,
      "latency_ms": 1707
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_08",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t901732\t2024-12-29 23:26:55.000\tpurchase\t/dashboard\tCA\tmobile\n9529\t728022\t2024-12-26 00:08:06.00",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS last_event_id,\n    max(timestamp) AS last_event_timestamp,\n    argMax(event_type, timestamp) AS last_event_type,\n    argMax(page, timestamp) AS last_page,\n    argMax(country, timestamp) AS last_country,\n    argMax(device, timestamp) AS last_device\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 455,
      "tokens_out": 114,
      "cost_usd": 0.015375,
      "latency_ms": 1438
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_08",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t901732\t2024-12-29 23:26:55.000\tpurchase\t/dashboard\n9529\t728022\t2024-12-26 00:08:06.000\tpurchase",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS last_event_id,\n    max(timestamp) AS last_event_timestamp,\n    argMax(event_type, timestamp) AS last_event_type,\n    argMax(page, timestamp) AS last_page\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 455,
      "tokens_out": 86,
      "cost_usd": 0.013275,
      "latency_ms": 1160
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_08",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t901732\t2024-12-29 23:26:55.000\tpurchase\t/dashboard\tCA\tmobile\n9529\t728022\t2024-12-26 00:08:06.00",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS last_event_id,\n    max(timestamp) AS last_event_timestamp,\n    argMax(event_type, timestamp) AS last_event_type,\n    argMax(page, timestamp) AS last_page,\n    argMax(country, timestamp) AS last_country,\n    argMax(device, timestamp) AS last_device\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 455,
      "tokens_out": 114,
      "cost_usd": 0.015375,
      "latency_ms": 2234
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_09",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH hours AS (\n    SELECT toDateTime('2024-06-15 00:00:00', 'UTC') + INTERVAL number HOUR AS hour\n    FROM numbers(24)\n)\nSELECT\n    h.hour,\n    count(e.event_id) AS event_count\nFROM hours h\nLEFT JOIN events e\n    ON toStartOfHour(e.timestamp) = h.hour\n    AND toDate(e.timestamp, 'UTC') = '2024-06-15'\nGROUP BY h.hour\nORDER BY h.hour",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 471,
      "tokens_out": 135,
      "cost_usd": 0.01719,
      "latency_ms": 1896
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_09",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH hours AS (\n    SELECT toDateTime('2024-06-15 00:00:00', 'UTC') + INTERVAL number HOUR AS hour\n    FROM numbers(24)\n)\nSELECT\n    h.hour,\n    count(e.event_id) AS event_count\nFROM hours h\nLEFT JOIN events e\n    ON toStartOfHour(e.timestamp) = h.hour\n    AND toDate(e.timestamp, 'UTC') = '2024-06-15'\nGROUP BY h.hour\nORDER BY h.hour",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 471,
      "tokens_out": 135,
      "cost_usd": 0.01719,
      "latency_ms": 1844
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_09",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH hours AS (\n    SELECT toDateTime('2024-06-15 00:00:00', 'UTC') + INTERVAL number HOUR AS hour\n    FROM numbers(24)\n)\nSELECT\n    h.hour,\n    count(e.event_id) AS event_count\nFROM hours h\nLEFT JOIN events e\n    ON toStartOfHour(e.timestamp) = h.hour\n    AND toDate(e.timestamp, 'UTC') = '2024-06-15'\nGROUP BY h.hour\nORDER BY h.hour",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 471,
      "tokens_out": 135,
      "cost_usd": 0.01719,
      "latency_ms": 929
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_10",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: ",
      "llm_sql": "SELECT\n    user_id,\n    arrayDistinct(arrayFilter(t -> t = 'premium', groupArrayArray(tags))) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING length(premium_tags) > 0",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 474,
      "tokens_out": 63,
      "cost_usd": 0.011835,
      "latency_ms": 1843
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_10",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: ",
      "llm_sql": "SELECT\n    user_id,\n    arrayDistinct(arrayFilter(t -> t = 'premium', groupArrayArray(tags))) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING length(premium_tags) > 0",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 474,
      "tokens_out": 63,
      "cost_usd": 0.011835,
      "latency_ms": 2478
    },
    {
      "model": "claude-opus-4",
      "question_id": "t5_10",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: ",
      "llm_sql": "SELECT\n    user_id,\n    arrayDistinct(arrayFilter(t -> t = 'premium', groupArrayArray(tags))) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING length(premium_tags) > 0",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 474,
      "tokens_out": 63,
      "cost_usd": 0.011835,
      "latency_ms": 2152
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_01",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 452,
      "tokens_out": 8,
      "cost_usd": 0.001476,
      "latency_ms": 1524
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_01",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 452,
      "tokens_out": 8,
      "cost_usd": 0.001476,
      "latency_ms": 1445
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_01",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 452,
      "tokens_out": 8,
      "cost_usd": 0.001476,
      "latency_ms": 873
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_02",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 452,
      "tokens_out": 23,
      "cost_usd": 0.001701,
      "latency_ms": 1388
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_02",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 452,
      "tokens_out": 23,
      "cost_usd": 0.001701,
      "latency_ms": 1318
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_02",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 452,
      "tokens_out": 23,
      "cost_usd": 0.001701,
      "latency_ms": 1428
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_03",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() \nFROM events \nWHERE toYYYYMM(timestamp) = 202403",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 453,
      "tokens_out": 32,
      "cost_usd": 0.001839,
      "latency_ms": 1390
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_03",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() \nFROM events \nWHERE toYYYYMM(timestamp) = 202403",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 453,
      "tokens_out": 32,
      "cost_usd": 0.001839,
      "latency_ms": 1108
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_03",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() \nFROM events \nWHERE toYYYYMM(timestamp) = 202403",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 453,
      "tokens_out": 32,
      "cost_usd": 0.001839,
      "latency_ms": 1517
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_04",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 449,
      "tokens_out": 16,
      "cost_usd": 0.001587,
      "latency_ms": 1362
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_04",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 449,
      "tokens_out": 16,
      "cost_usd": 0.001587,
      "latency_ms": 1386
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_04",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 449,
      "tokens_out": 16,
      "cost_usd": 0.001587,
      "latency_ms": 846
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_05",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() \nFROM events \nWHERE country = 'DE'",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 450,
      "tokens_out": 24,
      "cost_usd": 0.00171,
      "latency_ms": 885
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_05",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() \nFROM events \nWHERE country = 'DE'",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 450,
      "tokens_out": 24,
      "cost_usd": 0.00171,
      "latency_ms": 1638
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_05",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() \nFROM events \nWHERE country = 'DE'",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 450,
      "tokens_out": 24,
      "cost_usd": 0.00171,
      "latency_ms": 1651
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_06",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 460,
      "tokens_out": 32,
      "cost_usd": 0.00186,
      "latency_ms": 1168
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_06",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 460,
      "tokens_out": 32,
      "cost_usd": 0.00186,
      "latency_ms": 1379
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_06",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 460,
      "tokens_out": 32,
      "cost_usd": 0.00186,
      "latency_ms": 1534
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_07",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 455,
      "tokens_out": 20,
      "cost_usd": 0.001665,
      "latency_ms": 1345
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_07",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 455,
      "tokens_out": 20,
      "cost_usd": 0.001665,
      "latency_ms": 920
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_07",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 455,
      "tokens_out": 20,
      "cost_usd": 0.001665,
      "latency_ms": 1435
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_08",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    min(timestamp) AS earliest_event,\n    max(timestamp) AS latest_event\nFROM events",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 452,
      "tokens_out": 34,
      "cost_usd": 0.001866,
      "latency_ms": 1424
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_08",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    min(timestamp) AS earliest_event,\n    max(timestamp) AS latest_event\nFROM events",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 452,
      "tokens_out": 34,
      "cost_usd": 0.001866,
      "latency_ms": 1390
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_08",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    min(timestamp) AS earliest_event,\n    max(timestamp) AS latest_event\nFROM events",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 452,
      "tokens_out": 34,
      "cost_usd": 0.001866,
      "latency_ms": 1442
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_09",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01 00:00:00'\n  AND timestamp < '2025-01-01 00:00:00'\nORDER BY timestamp",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 458,
      "tokens_out": 63,
      "cost_usd": 0.002319,
      "latency_ms": 1350
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_09",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01 00:00:00'\n  AND timestamp < '2025-01-01 00:00:00'\nORDER BY timestamp",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 458,
      "tokens_out": 63,
      "cost_usd": 0.002319,
      "latency_ms": 1682
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_09",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01 00:00:00'\n  AND timestamp < '2025-01-01 00:00:00'\nORDER BY timestamp",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 458,
      "tokens_out": 63,
      "cost_usd": 0.002319,
      "latency_ms": 1133
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_10",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE duration_ms IS NOT NULL",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 455,
      "tokens_out": 22,
      "cost_usd": 0.001695,
      "latency_ms": 2029
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_10",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE duration_ms IS NOT NULL",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 455,
      "tokens_out": 22,
      "cost_usd": 0.001695,
      "latency_ms": 1560
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t1_10",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE duration_ms IS NOT NULL",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 455,
      "tokens_out": 22,
      "cost_usd": 0.001695,
      "latency_ms": 1843
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_01",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    count() AS event_count\nFROM events\nGROUP BY event_type\nORDER BY event_count DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 456,
      "tokens_out": 40,
      "cost_usd": 0.001968,
      "latency_ms": 1482
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_01",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    count() AS event_count\nFROM events\nGROUP BY event_type\nORDER BY event_count DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 456,
      "tokens_out": 40,
      "cost_usd": 0.001968,
      "latency_ms": 1491
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_01",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    COUNT(*) as event_count\nFROM events\nGROUP BY event_type\nORDER BY event_count DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 456,
      "tokens_out": 41,
      "cost_usd": 0.001983,
      "latency_ms": 1849
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_02",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    device,\n    avg(duration_ms) as avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY avg_duration_ms DESC",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 454,
      "tokens_out": 52,
      "cost_usd": 0.002142,
      "latency_ms": 1720
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_02",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    device,\n    avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY avg_duration_ms DESC",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 454,
      "tokens_out": 52,
      "cost_usd": 0.002142,
      "latency_ms": 1613
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_02",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    device,\n    avg(duration_ms) as avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY avg_duration_ms DESC",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 454,
      "tokens_out": 52,
      "cost_usd": 0.002142,
      "latency_ms": 1806
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_03",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE toYYYYMM(timestamp) = 202401\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 456,
      "tokens_out": 55,
      "cost_usd": 0.002193,
      "latency_ms": 941
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_03",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE toYYYYMM(timestamp) = 202401\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 456,
      "tokens_out": 55,
      "cost_usd": 0.002193,
      "latency_ms": 1684
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_03",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE toYYYYMM(timestamp) = 202401\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 456,
      "tokens_out": 55,
      "cost_usd": 0.002193,
      "latency_ms": 1402
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_04",
      "tier": 2,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: IN\nGB\nNL\nCA\nAU\nBR\nUS\nDE\nJP\nFR",
      "llm_sql": "SELECT country\nFROM events\nGROUP BY country\nHAVING count() > 10000",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 454,
      "tokens_out": 26,
      "cost_usd": 0.001752,
      "latency_ms": 1608
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_04",
      "tier": 2,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: IN\nGB\nNL\nCA\nAU\nBR\nUS\nDE\nJP\nFR",
      "llm_sql": "SELECT country\nFROM events\nGROUP BY country\nHAVING count() > 10000",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 454,
      "tokens_out": 26,
      "cost_usd": 0.001752,
      "latency_ms": 1060
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_04",
      "tier": 2,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: IN\nGB\nNL\nCA\nAU\nBR\nUS\nDE\nJP\nFR",
      "llm_sql": "SELECT country\nFROM events\nGROUP BY country\nHAVING count() > 10000",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 454,
      "tokens_out": 26,
      "cost_usd": 0.001752,
      "latency_ms": 949
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_05",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toHour(timestamp) AS hour,\n    count() AS event_count\nFROM events\nGROUP BY hour\nORDER BY hour",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 454,
      "tokens_out": 40,
      "cost_usd": 0.001962,
      "latency_ms": 872
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_05",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toHour(timestamp) AS hour,\n    count() AS event_count\nFROM events\nGROUP BY hour\nORDER BY hour",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 454,
      "tokens_out": 40,
      "cost_usd": 0.001962,
      "latency_ms": 1363
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_05",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toHour(timestamp) AS hour,\n    count() AS event_count\nFROM events\nGROUP BY hour\nORDER BY hour",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 454,
      "tokens_out": 40,
      "cost_usd": 0.001962,
      "latency_ms": 1431
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_06",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms)\nFROM events\nWHERE event_type = 'pageview'",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 459,
      "tokens_out": 29,
      "cost_usd": 0.001812,
      "latency_ms": 1388
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_06",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms)\nFROM events\nWHERE event_type = 'pageview' AND duration_ms IS NOT NULL",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 459,
      "tokens_out": 36,
      "cost_usd": 0.001917,
      "latency_ms": 1644
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_06",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms)\nFROM events\nWHERE event_type = 'pageview' AND duration_ms IS NOT NULL",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 459,
      "tokens_out": 36,
      "cost_usd": 0.001917,
      "latency_ms": 1697
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_07",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toStartOfMonth(timestamp) AS month,\n    count() AS event_count\nFROM events\nWHERE toYear(timestamp) = 2024\nGROUP BY month\nORDER BY month",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 453,
      "tokens_out": 52,
      "cost_usd": 0.002139,
      "latency_ms": 1133
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_07",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toStartOfMonth(timestamp) AS month,\n    count() AS event_count\nFROM events\nWHERE toYear(timestamp) = 2024\nGROUP BY month\nORDER BY month",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 453,
      "tokens_out": 52,
      "cost_usd": 0.002139,
      "latency_ms": 1365
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_07",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toStartOfMonth(timestamp) AS month,\n    count() AS event_count\nFROM events\nWHERE toYear(timestamp) = 2024\nGROUP BY month\nORDER BY month",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 453,
      "tokens_out": 52,
      "cost_usd": 0.002139,
      "latency_ms": 999
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_08",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    uniqExact(country) AS distinct_countries\nFROM events\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 455,
      "tokens_out": 44,
      "cost_usd": 0.002025,
      "latency_ms": 1401
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_08",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    uniqExact(country) AS distinct_countries\nFROM events\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 455,
      "tokens_out": 44,
      "cost_usd": 0.002025,
      "latency_ms": 1502
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_08",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    uniqExact(country) AS distinct_countries\nFROM events\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 455,
      "tokens_out": 44,
      "cost_usd": 0.002025,
      "latency_ms": 1332
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_09",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    country,\n    sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 457,
      "tokens_out": 52,
      "cost_usd": 0.002151,
      "latency_ms": 1365
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_09",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    country,\n    sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 457,
      "tokens_out": 52,
      "cost_usd": 0.002151,
      "latency_ms": 1392
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_09",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    country,\n    sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 457,
      "tokens_out": 52,
      "cost_usd": 0.002151,
      "latency_ms": 921
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_10",
      "tier": 2,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: purchase\t200181\npageview\t200001",
      "llm_sql": "SELECT \n    event_type,\n    count() AS event_count\nFROM events\nWHERE event_type IN ('purchase', 'pageview')\nGROUP BY event_type",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 457,
      "tokens_out": 47,
      "cost_usd": 0.002076,
      "latency_ms": 1471
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_10",
      "tier": 2,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: purchase\t200181\npageview\t200001",
      "llm_sql": "SELECT \n    event_type,\n    count() as event_count\nFROM events\nWHERE event_type IN ('purchase', 'pageview')\nGROUP BY event_type",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 457,
      "tokens_out": 47,
      "cost_usd": 0.002076,
      "latency_ms": 2017
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t2_10",
      "tier": 2,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: purchase\t200181\npageview\t200001",
      "llm_sql": "SELECT \n    event_type,\n    count() AS event_count\nFROM events\nWHERE event_type IN ('purchase', 'pageview')\nGROUP BY event_type",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 457,
      "tokens_out": 47,
      "cost_usd": 0.002076,
      "latency_ms": 955
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_01",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 454,
      "tokens_out": 37,
      "cost_usd": 0.001917,
      "latency_ms": 1345
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_01",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 454,
      "tokens_out": 37,
      "cost_usd": 0.001917,
      "latency_ms": 1539
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_01",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 454,
      "tokens_out": 37,
      "cost_usd": 0.001917,
      "latency_ms": 964
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_02",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT uniq(user_id) FROM events",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 455,
      "tokens_out": 18,
      "cost_usd": 0.001635,
      "latency_ms": 1454
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_02",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT uniq(user_id) FROM events",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 455,
      "tokens_out": 18,
      "cost_usd": 0.001635,
      "latency_ms": 1347
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_02",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT uniq(user_id) FROM events",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 455,
      "tokens_out": 18,
      "cost_usd": 0.001635,
      "latency_ms": 1386
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_03",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 879939\t2024-12-01 00:06:12.000\t3613\tpageview\t/settings\t5267\t{'campaign':'summer_sale','source':'twit",
      "llm_sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 457,
      "tokens_out": 25,
      "cost_usd": 0.001746,
      "latency_ms": 1599
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_03",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 39071\t2024-07-01 00:04:45.000\t8058\tpurchase\t/pricing\t1864\t{'campaign':'spring_promo','source':'faceb",
      "llm_sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 457,
      "tokens_out": 25,
      "cost_usd": 0.001746,
      "latency_ms": 1414
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_03",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 322580\t2024-09-01 00:01:24.000\t2253\tsignup\t/blog\t2583\t{'campaign':'black_friday','source':'twitter'}",
      "llm_sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 457,
      "tokens_out": 25,
      "cost_usd": 0.001746,
      "latency_ms": 1479
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_04",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source']\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 466,
      "tokens_out": 35,
      "cost_usd": 0.001923,
      "latency_ms": 1408
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_04",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source']\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 466,
      "tokens_out": 35,
      "cost_usd": 0.001923,
      "latency_ms": 1503
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_04",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source']\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 466,
      "tokens_out": 35,
      "cost_usd": 0.001923,
      "latency_ms": 1604
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_05",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT tag, count() AS occurrences\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY occurrences DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 466,
      "tokens_out": 38,
      "cost_usd": 0.001968,
      "latency_ms": 858
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_05",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT tag, count() AS occurrences\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY occurrences DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 466,
      "tokens_out": 38,
      "cost_usd": 0.001968,
      "latency_ms": 1404
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_05",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT tag, count() AS occurrences\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY occurrences DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 466,
      "tokens_out": 38,
      "cost_usd": 0.001968,
      "latency_ms": 1387
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_06",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 644674\t2024-11-01 00:08:01.000\t6051\tclick\t/docs\t\\N\t{'source':'email'}\t['promo','vip_member','premium",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 459,
      "tokens_out": 24,
      "cost_usd": 0.001737,
      "latency_ms": 1333
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_06",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 490461\t2024-04-01 00:07:06.000\t302\tlogout\t/dashboard\t\\N\t{'source':'facebook'}\t['promo','mobile']\tJP\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 459,
      "tokens_out": 24,
      "cost_usd": 0.001737,
      "latency_ms": 1373
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_06",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 368743\t2024-09-01 00:00:25.000\t3202\tsignup\t/blog\t8419\t{'source':'direct'}\t['promo']\tUS\tdesktop\t\\N\n88",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 459,
      "tokens_out": 24,
      "cost_usd": 0.001737,
      "latency_ms": 1344
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_07",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    quantile(0.90)(duration_ms) AS p90_duration_ms,\n    quantile(0.99)(duration_ms) AS p99_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 462,
      "tokens_out": 80,
      "cost_usd": 0.002586,
      "latency_ms": 870
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_07",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    quantile(0.90)(duration_ms) AS p90_duration_ms,\n    quantile(0.99)(duration_ms) AS p99_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 462,
      "tokens_out": 80,
      "cost_usd": 0.002586,
      "latency_ms": 880
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_07",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    quantile(0.90)(duration_ms) AS p90_duration_ms,\n    quantile(0.99)(duration_ms) AS p99_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 462,
      "tokens_out": 80,
      "cost_usd": 0.002586,
      "latency_ms": 2062
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_08",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS total_revenue\nFROM events",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 461,
      "tokens_out": 30,
      "cost_usd": 0.001833,
      "latency_ms": 1342
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_08",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS total_revenue\nFROM events",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 461,
      "tokens_out": 30,
      "cost_usd": 0.001833,
      "latency_ms": 1311
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_08",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS total_revenue\nFROM events",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 461,
      "tokens_out": 30,
      "cost_usd": 0.001833,
      "latency_ms": 1399
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_09",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS property_key\nFROM events\nWHERE properties IS NOT NULL AND length(properties) > 0\nORDER BY property_key",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 457,
      "tokens_out": 47,
      "cost_usd": 0.002076,
      "latency_ms": 1729
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_09",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS property_key\nFROM events\nWHERE properties IS NOT NULL AND length(properties) > 0\nORDER BY property_key",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 457,
      "tokens_out": 47,
      "cost_usd": 0.002076,
      "latency_ms": 1242
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_09",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS property_key\nFROM events\nWHERE properties IS NOT NULL AND length(properties) > 0\nORDER BY property_key",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 457,
      "tokens_out": 47,
      "cost_usd": 0.002076,
      "latency_ms": 1863
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_10",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 78581\t2024-11-01 00:07:22.000\t7126\tpageview\t/dashboard\t\\N\t{'source':'email'}\t['vip_member','new']\tJP",
      "llm_sql": "SELECT *\nFROM events\nWHERE hasAny(tags, arrayFilter(x -> startsWith(x, 'vip'), tags))",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 463,
      "tokens_out": 38,
      "cost_usd": 0.001959,
      "latency_ms": 1556
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_10",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 227800\t2024-06-01 00:02:52.000\t5652\tclick\t/checkout\t\\N\t{'campaign':'launch','source':'email'}\t['vip_",
      "llm_sql": "SELECT *\nFROM events\nWHERE hasAny(arrayMap(x -> startsWith(x, 'vip'), tags), [1])",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 463,
      "tokens_out": 39,
      "cost_usd": 0.001974,
      "latency_ms": 1781
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t3_10",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 349664\t2024-12-01 00:01:56.000\t1508\tpageview\t/home\t\\N\t{'source':'google'}\t['vip_member']\tGB\ttablet\t\\",
      "llm_sql": "SELECT *\nFROM events\nWHERE hasAny(tags, arrayFilter(x -> startsWith(x, 'vip'), tags))",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 463,
      "tokens_out": 38,
      "cost_usd": 0.001959,
      "latency_ms": 847
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_01",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 566193\t2024-05-01 00:01:55.000\t2505\tsignup\t/dashboard\t9494\t{'campaign':'black_friday','source':'twit",
      "llm_sql": "SELECT \n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events e\nLEFT JOIN users u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 462,
      "tokens_out": 112,
      "cost_usd": 0.003066,
      "latency_ms": 878
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_01",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t/blog\t\\N\t{'source':'facebook'}\t[]\tBR\ttablet\t\\N\tpro\n774716",
      "llm_sql": "SELECT \n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events e\nLEFT JOIN users u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 462,
      "tokens_out": 112,
      "cost_usd": 0.003066,
      "latency_ms": 929
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_01",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t/blog\t\\N\t{'source':'facebook'}\t[]\tBR\ttablet\t\\N\tpro\n774716",
      "llm_sql": "SELECT \n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events e\nJOIN users u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 462,
      "tokens_out": 111,
      "cost_usd": 0.003051,
      "latency_ms": 1327
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_02",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    COUNT(*) as event_count\nFROM events e\nINNER JOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 450,
      "tokens_out": 60,
      "cost_usd": 0.00225,
      "latency_ms": 1389
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_02",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    COUNT(*) as event_count\nFROM events e\nINNER JOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 450,
      "tokens_out": 60,
      "cost_usd": 0.00225,
      "latency_ms": 904
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_02",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    COUNT(*) as event_count\nFROM events e\nINNER JOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 450,
      "tokens_out": 60,
      "cost_usd": 0.00225,
      "latency_ms": 1366
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_03",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT user_id, created_at, plan, email, age, country\nFROM users\nWHERE user_id NOT IN (SELECT DISTINCT user_id FROM events)",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 452,
      "tokens_out": 44,
      "cost_usd": 0.002016,
      "latency_ms": 1351
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_03",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT user_id, created_at, plan, email, age, country\nFROM users\nWHERE user_id NOT IN (SELECT DISTINCT user_id FROM events)",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 452,
      "tokens_out": 44,
      "cost_usd": 0.002016,
      "latency_ms": 1365
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_03",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT user_id, created_at, plan, email, age, country\nFROM users\nWHERE user_id NOT IN (SELECT DISTINCT user_id FROM events)",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 452,
      "tokens_out": 44,
      "cost_usd": 0.002016,
      "latency_ms": 1841
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_04",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS (\n    SELECT user_id, COUNT() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT \n    t.user_id,\n    t.event_count,\n    u.plan\nFROM top_users t\nLEFT JOIN users u ON t.user_id = u.user_id\nORDER BY t.event_count DESC",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 464,
      "tokens_out": 110,
      "cost_usd": 0.003042,
      "latency_ms": 1410
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_04",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS (\n    SELECT user_id, COUNT() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT \n    t.user_id,\n    t.event_count,\n    u.plan\nFROM top_users t\nLEFT JOIN users u ON t.user_id = u.user_id\nORDER BY t.event_count DESC",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 464,
      "tokens_out": 110,
      "cost_usd": 0.003042,
      "latency_ms": 1429
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_04",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS (\n    SELECT user_id, COUNT() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT \n    t.user_id,\n    t.event_count,\n    u.plan\nFROM top_users t\nLEFT JOIN users u ON t.user_id = u.user_id\nORDER BY t.event_count DESC",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 464,
      "tokens_out": 110,
      "cost_usd": 0.003042,
      "latency_ms": 1376
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_05",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\tuser6396@example.com\tenterprise\t143\n1040\tuser1040@example.com\tpro\t138\n7449\tuser7449@example.com",
      "llm_sql": "WITH user_event_counts AS (\n    SELECT \n        user_id,\n        count() AS event_count\n    FROM events\n    GROUP BY user_id\n),\navg_event_count AS (\n    SELECT avg(event_count) AS avg_count\n    FROM user_event_counts\n)\nSELECT \n    u.user_id,\n    u.email,\n    u.plan,\n    uec.event_count\nFROM user_event_counts uec\nJOIN users u ON uec.user_id = u.user_id\nCROSS JOIN avg_event_count aec\nWHERE uec.event_count > aec.avg_count\nORDER BY uec.event_count DESC",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 458,
      "tokens_out": 171,
      "cost_usd": 0.003939,
      "latency_ms": 1409
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_05",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\tuser6396@example.com\tenterprise\t143\n1040\tuser1040@example.com\tpro\t138\n6726\tuser6726@example.com",
      "llm_sql": "WITH user_event_counts AS (\n    SELECT \n        user_id,\n        count() AS event_count\n    FROM events\n    GROUP BY user_id\n),\navg_event_count AS (\n    SELECT avg(event_count) AS avg_count\n    FROM user_event_counts\n)\nSELECT \n    u.user_id,\n    u.email,\n    u.plan,\n    uec.event_count\nFROM user_event_counts uec\nJOIN users u ON uec.user_id = u.user_id\nCROSS JOIN avg_event_count aec\nWHERE uec.event_count > aec.avg_count\nORDER BY uec.event_count DESC",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 458,
      "tokens_out": 171,
      "cost_usd": 0.003939,
      "latency_ms": 1053
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_05",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\tuser6396@example.com\tenterprise\t143\n1040\tuser1040@example.com\tpro\t138\n7449\tuser7449@example.com",
      "llm_sql": "WITH user_event_counts AS (\n    SELECT \n        user_id,\n        COUNT(*) AS event_count\n    FROM events\n    GROUP BY user_id\n),\navg_event_count AS (\n    SELECT AVG(event_count) AS avg_count\n    FROM user_event_counts\n)\nSELECT \n    u.user_id,\n    u.email,\n    u.plan,\n    uec.event_count\nFROM user_event_counts uec\nJOIN users u ON uec.user_id = u.user_id\nCROSS JOIN avg_event_count aec\nWHERE uec.event_count > aec.avg_count\nORDER BY uec.event_count DESC",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 458,
      "tokens_out": 173,
      "cost_usd": 0.003969,
      "latency_ms": 1345
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_06",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 623619\t2024-06-01 00:03:08.000\t8946\tpurchase\t/docs\t4754\t{'source':'twitter'}\t[]\tCA\tmobile\t\\N\n878476\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 462,
      "tokens_out": 41,
      "cost_usd": 0.002001,
      "latency_ms": 1493
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_06",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 81015\t2024-11-01 00:04:33.000\t8349\tsignup\t/settings\t4631\t{'campaign':'launch','source':'google'}\t[]\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 462,
      "tokens_out": 41,
      "cost_usd": 0.002001,
      "latency_ms": 1389
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_06",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 270475\t2024-09-01 00:00:19.000\t1544\tpurchase\t/pricing\t7171\t{'source':'twitter'}\t[]\tDE\ttablet\t\\N\n8631",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 462,
      "tokens_out": 41,
      "cost_usd": 0.002001,
      "latency_ms": 929
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_07",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    AVG(event_count) as avg_events_per_user\nFROM users u\nLEFT JOIN (\n    SELECT \n        user_id,\n        COUNT(*) as event_count\n    FROM events\n    GROUP BY user_id\n) e ON u.user_id = e.user_id\nGROUP BY u.plan\nORDER BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 457,
      "tokens_out": 98,
      "cost_usd": 0.002841,
      "latency_ms": 1362
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_07",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    AVG(event_count) as avg_events_per_user\nFROM users u\nLEFT JOIN (\n    SELECT \n        user_id,\n        COUNT(*) as event_count\n    FROM events\n    GROUP BY user_id\n) e ON u.user_id = e.user_id\nGROUP BY u.plan\nORDER BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 457,
      "tokens_out": 98,
      "cost_usd": 0.002841,
      "latency_ms": 1426
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_07",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    AVG(event_count) as avg_events_per_user\nFROM users u\nLEFT JOIN (\n    SELECT \n        user_id,\n        COUNT(*) as event_count\n    FROM events\n    GROUP BY user_id\n) e ON u.user_id = e.user_id\nGROUP BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 457,
      "tokens_out": 92,
      "cost_usd": 0.002751,
      "latency_ms": 1378
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_08",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at, u.plan, u.country\nFROM users u\nINNER JOIN events e ON u.user_id = e.user_id\nWHERE toYear(u.created_at) = 2024\n  AND e.event_type = 'purchase'",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 461,
      "tokens_out": 84,
      "cost_usd": 0.002643,
      "latency_ms": 1506
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_08",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at, u.plan\nFROM users u\nINNER JOIN events e ON u.user_id = e.user_id\nWHERE toYear(u.created_at) = 2024\n  AND e.event_type = 'purchase'",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 461,
      "tokens_out": 80,
      "cost_usd": 0.002583,
      "latency_ms": 861
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_08",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at, u.plan\nFROM users u\nINNER JOIN events e ON u.user_id = e.user_id\nWHERE toYear(u.created_at) = 2024\n  AND e.event_type = 'purchase'",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 461,
      "tokens_out": 80,
      "cost_usd": 0.002583,
      "latency_ms": 1379
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_09",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: JP",
      "llm_sql": "SELECT country\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY count() DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 458,
      "tokens_out": 36,
      "cost_usd": 0.001914,
      "latency_ms": 1436
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_09",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: JP",
      "llm_sql": "SELECT country\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY count() DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 458,
      "tokens_out": 36,
      "cost_usd": 0.001914,
      "latency_ms": 1349
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_09",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: JP",
      "llm_sql": "SELECT country\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY count() DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 458,
      "tokens_out": 36,
      "cost_usd": 0.001914,
      "latency_ms": 854
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_10",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t3118\t56",
      "llm_sql": "SELECT \n    device,\n    user_id,\n    event_count\nFROM (\n    SELECT \n        device,\n        user_id,\n        COUNT(*) as event_count,\n        ROW_NUMBER() OVER (PARTITION BY device ORDER BY COUNT(*) DESC, user_id) as rn\n    FROM events\n    GROUP BY device, user_id\n)\nWHERE rn = 1\nORDER BY device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 456,
      "tokens_out": 106,
      "cost_usd": 0.002958,
      "latency_ms": 1420
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_10",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t3118\t56",
      "llm_sql": "SELECT \n    device,\n    user_id,\n    event_count\nFROM (\n    SELECT \n        device,\n        user_id,\n        COUNT(*) as event_count,\n        ROW_NUMBER() OVER (PARTITION BY device ORDER BY COUNT(*) DESC, user_id) as rn\n    FROM events\n    GROUP BY device, user_id\n)\nWHERE rn = 1\nORDER BY device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 456,
      "tokens_out": 106,
      "cost_usd": 0.002958,
      "latency_ms": 1002
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t4_10",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t3118\t56",
      "llm_sql": "SELECT \n    device,\n    user_id,\n    event_count\nFROM (\n    SELECT \n        device,\n        user_id,\n        COUNT(*) as event_count,\n        ROW_NUMBER() OVER (PARTITION BY device ORDER BY COUNT(*) DESC, user_id) as rn\n    FROM events\n    GROUP BY device, user_id\n)\nWHERE rn = 1\nORDER BY device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 456,
      "tokens_out": 106,
      "cost_usd": 0.002958,
      "latency_ms": 1486
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_01",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t39540\t2024-01-01 13:38:42.000\t1\n1\t723127\t2024-01-08 14:54:29.000\t2\n1\t203391\t2024-01-09 15:11:25.00",
      "llm_sql": "SELECT \n    user_id,\n    event_id,\n    timestamp,\n    ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_sequence\nFROM events\nORDER BY user_id, timestamp",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 459,
      "tokens_out": 61,
      "cost_usd": 0.002292,
      "latency_ms": 1351
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_01",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t39540\t2024-01-01 13:38:42.000\t1\n1\t723127\t2024-01-08 14:54:29.000\t2\n1\t203391\t2024-01-09 15:11:25.00",
      "llm_sql": "SELECT \n    user_id,\n    event_id,\n    timestamp,\n    ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_sequence\nFROM events\nORDER BY user_id, timestamp",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 459,
      "tokens_out": 61,
      "cost_usd": 0.002292,
      "latency_ms": 1523
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_01",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t39540\t2024-01-01 13:38:42.000\t1\n1\t723127\t2024-01-08 14:54:29.000\t2\n1\t203391\t2024-01-09 15:11:25.00",
      "llm_sql": "SELECT \n    user_id,\n    event_id,\n    timestamp,\n    ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_sequence\nFROM events\nORDER BY user_id, timestamp",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 459,
      "tokens_out": 61,
      "cost_usd": 0.002292,
      "latency_ms": 1432
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_02",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    COUNT(*) AS daily_events,\n    SUM(COUNT(*)) OVER (ORDER BY toDate(timestamp)) AS running_total\nFROM events\nWHERE toYear(timestamp) = 2024\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 456,
      "tokens_out": 74,
      "cost_usd": 0.002478,
      "latency_ms": 1108
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_02",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    COUNT(*) AS daily_events,\n    SUM(COUNT(*)) OVER (ORDER BY toDate(timestamp)) AS running_total\nFROM events\nWHERE toYear(timestamp) = 2024\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 456,
      "tokens_out": 74,
      "cost_usd": 0.002478,
      "latency_ms": 1408
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_02",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    COUNT(*) AS daily_events,\n    SUM(COUNT(*)) OVER (ORDER BY toDate(timestamp)) AS running_total\nFROM events\nWHERE toYear(timestamp) = 2024\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 456,
      "tokens_out": 74,
      "cost_usd": 0.002478,
      "latency_ms": 868
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_03",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count,\n    lagInFrame(count()) OVER (ORDER BY toDate(timestamp)) AS previous_day_event_count\nFROM events\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 461,
      "tokens_out": 66,
      "cost_usd": 0.002373,
      "latency_ms": 1428
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_03",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    COUNT(*) AS event_count,\n    lagInFrame(COUNT(*), 1) OVER (ORDER BY toDate(timestamp)) AS previous_day_event_count\nFROM events\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 461,
      "tokens_out": 71,
      "cost_usd": 0.002448,
      "latency_ms": 1285
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_03",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    COUNT(*) AS event_count,\n    lagInFrame(COUNT(*), 1) OVER (ORDER BY toDate(timestamp)) AS previous_day_event_count\nFROM events\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 461,
      "tokens_out": 71,
      "cost_usd": 0.002448,
      "latency_ms": 1805
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_04",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 276933\t2024-04-01 00:00:42.000\t5857\tlogout\t['VIP_MEMBER','MOBILE']\n734343\t2024-04-01 00:00:53.000\t41",
      "llm_sql": "SELECT \n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    arrayMap(x -> upper(x), tags) AS tags_uppercase\nFROM events",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 456,
      "tokens_out": 52,
      "cost_usd": 0.002148,
      "latency_ms": 1174
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_04",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t[]\n774716\t2024-12-01 00:01:20.000\t1952\tpurchase\t[]\n531475",
      "llm_sql": "SELECT \n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    arrayMap(x -> upper(x), tags) AS tags_uppercase\nFROM events",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 456,
      "tokens_out": 52,
      "cost_usd": 0.002148,
      "latency_ms": 1559
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_04",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 669632\t2024-09-01 00:00:08.000\t3308\tpurchase\t['MOBILE']\n270475\t2024-09-01 00:00:19.000\t1544\tpurchase",
      "llm_sql": "SELECT \n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    arrayMap(x -> upper(x), tags) AS tags_uppercase\nFROM events",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 456,
      "tokens_out": 52,
      "cost_usd": 0.002148,
      "latency_ms": 1012
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_05",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: logout\t3812\nsignup\t8908\npurchase\t7125\nclick\t1371\npageview\t2833",
      "llm_sql": "SELECT \n    event_type,\n    argMax(user_id, total_duration) AS user_id_with_longest_duration\nFROM (\n    SELECT \n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 462,
      "tokens_out": 102,
      "cost_usd": 0.002916,
      "latency_ms": 1379
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_05",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: logout\t3812\npurchase\t7125\nsignup\t8908\npageview\t2833\nclick\t1371",
      "llm_sql": "SELECT \n    event_type,\n    argMax(user_id, total_duration) AS user_id_with_longest_duration\nFROM (\n    SELECT \n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 462,
      "tokens_out": 102,
      "cost_usd": 0.002916,
      "latency_ms": 1434
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_05",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: logout\t3812\nsignup\t8908\npurchase\t7125\nclick\t1371\npageview\t2833",
      "llm_sql": "SELECT \n    event_type,\n    argMax(user_id, total_duration) AS user_id_with_longest_duration\nFROM (\n    SELECT \n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 462,
      "tokens_out": 102,
      "cost_usd": 0.002916,
      "latency_ms": 1550
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_06",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day ASC WITH FILL \n    FROM toDate('2024-01-01') \n    TO toDate('2024-02-01') \n    STEP INTERVAL 1 DAY",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 463,
      "tokens_out": 107,
      "cost_usd": 0.002994,
      "latency_ms": 1361
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_06",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day ASC WITH FILL \n    FROM toDate('2024-01-01') \n    TO toDate('2024-02-01') \n    STEP INTERVAL 1 DAY",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 463,
      "tokens_out": 107,
      "cost_usd": 0.002994,
      "latency_ms": 1499
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_06",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day ASC WITH FILL \n    FROM toDate('2024-01-01') \n    TO toDate('2024-02-01') \n    STEP INTERVAL 1 DAY",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 463,
      "tokens_out": 107,
      "cost_usd": 0.002994,
      "latency_ms": 1396
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_07",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3699\t['pageview','signup','logout','purchase','pageview','purchase','purchase','signup','signup','si",
      "llm_sql": "SELECT \n    user_id,\n    groupArray(event_type) AS event_types_array,\n    arraySort(arrayDistinct(event_types_array)) AS sorted_unique_event_types\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 457,
      "tokens_out": 64,
      "cost_usd": 0.002331,
      "latency_ms": 1372
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_07",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3699\t['pageview','signup','logout','purchase','pageview','purchase','purchase','signup','signup','si",
      "llm_sql": "SELECT \n    user_id,\n    groupArray(event_type) AS event_types_array,\n    arraySort(arrayDistinct(event_types_array)) AS sorted_unique_event_types\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 457,
      "tokens_out": 64,
      "cost_usd": 0.002331,
      "latency_ms": 1398
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_07",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t['purchase','signup','pageview','purchase','logout','click','purchase','logout','pageview','sig",
      "llm_sql": "SELECT \n    user_id,\n    groupArray(event_type) AS event_types_array,\n    arraySort(arrayDistinct(event_types_array)) AS sorted_unique_event_types\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 457,
      "tokens_out": 64,
      "cost_usd": 0.002331,
      "latency_ms": 1419
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_08",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 4450\t304419\tsignup\t/blog\t2024-12-30 12:56:42.000\n3986\t195430\tlogout\t/about\t2024-12-26 06:16:20.000\n7",
      "llm_sql": "SELECT \n    user_id,\n    argMax(event_id, timestamp) AS latest_event_id,\n    argMax(event_type, timestamp) AS latest_event_type,\n    argMax(page, timestamp) AS latest_page,\n    argMax(timestamp, timestamp) AS latest_timestamp\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 454,
      "tokens_out": 88,
      "cost_usd": 0.002682,
      "latency_ms": 1022
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_08",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t901732\tpurchase\t/dashboard\t2024-12-29 23:26:55.000\n9529\t728022\tpurchase\t/checkout\t2024-12-26 00",
      "llm_sql": "SELECT \n    user_id,\n    argMax(event_id, timestamp) AS latest_event_id,\n    argMax(event_type, timestamp) AS latest_event_type,\n    argMax(page, timestamp) AS latest_page,\n    argMax(timestamp, timestamp) AS latest_timestamp\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 454,
      "tokens_out": 88,
      "cost_usd": 0.002682,
      "latency_ms": 1008
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_08",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t901732\tpurchase\t/dashboard\t2024-12-29 23:26:55.000\n9529\t728022\tpurchase\t/checkout\t2024-12-26 00",
      "llm_sql": "SELECT \n    user_id,\n    argMax(event_id, timestamp) AS latest_event_id,\n    argMax(event_type, timestamp) AS latest_event_type,\n    argMax(page, timestamp) AS latest_page,\n    argMax(timestamp, timestamp) AS latest_timestamp\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 454,
      "tokens_out": 88,
      "cost_usd": 0.002682,
      "latency_ms": 1341
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_09",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH hours AS (\n    SELECT toDateTime('2024-06-15 00:00:00', 'UTC') + toIntervalHour(number) AS hour\n    FROM numbers(24)\n)\nSELECT \n    h.hour,\n    countIf(e.event_id IS NOT NULL) AS event_count\nFROM hours h\nLEFT JOIN events e ON toStartOfHour(e.timestamp) = h.hour\n    AND toDate(e.timestamp) = '2024-06-15'\nGROUP BY h.hour\nORDER BY h.hour",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 470,
      "tokens_out": 138,
      "cost_usd": 0.00348,
      "latency_ms": 1215
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_09",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH hours AS (\n    SELECT toDateTime('2024-06-15 00:00:00', 'UTC') + toIntervalHour(number) AS hour\n    FROM numbers(24)\n)\nSELECT \n    h.hour,\n    countIf(e.event_id IS NOT NULL) AS event_count\nFROM hours h\nLEFT JOIN events e ON toStartOfHour(e.timestamp) = h.hour\n    AND toDate(e.timestamp) = '2024-06-15'\nGROUP BY h.hour\nORDER BY h.hour",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 470,
      "tokens_out": 138,
      "cost_usd": 0.00348,
      "latency_ms": 1931
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_09",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH hours AS (\n    SELECT toDateTime('2024-06-15 00:00:00', 'UTC') + toIntervalHour(number) AS hour\n    FROM numbers(24)\n)\nSELECT \n    h.hour,\n    countIf(e.event_id IS NOT NULL) AS event_count\nFROM hours h\nLEFT JOIN events e ON toStartOfHour(e.timestamp) = h.hour\n    AND toDate(e.timestamp) = '2024-06-15'\nGROUP BY h.hour\nORDER BY h.hour",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 470,
      "tokens_out": 138,
      "cost_usd": 0.00348,
      "latency_ms": 1490
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_10",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 4660\n4742\n5090\n4944\n4504\n4394\n4174\n4348\n8112\n7938\n7782\n7892\n7196\n7342\n7626\n7544\n3684\n3798\n4018\n3840\n",
      "llm_sql": "SELECT user_id\nFROM events\nWHERE arrayExists(x -> x LIKE '%premium%', tags)\nGROUP BY user_id\nHAVING count() > 0",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 473,
      "tokens_out": 45,
      "cost_usd": 0.002094,
      "latency_ms": 1620
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_10",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 4660\n4742\n5090\n4944\n4504\n4394\n4174\n4348\n8112\n7938\n7782\n7892\n7196\n7342\n7626\n7544\n3684\n3798\n4018\n3840\n",
      "llm_sql": "SELECT user_id\nFROM events\nWHERE arrayExists(x -> x LIKE '%premium%', tags)\nGROUP BY user_id\nHAVING count() > 0",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 473,
      "tokens_out": 45,
      "cost_usd": 0.002094,
      "latency_ms": 1818
    },
    {
      "model": "claude-sonnet-4.5",
      "question_id": "t5_10",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 4660\n4742\n5090\n4944\n4504\n4394\n4174\n4348\n8112\n7938\n7782\n7892\n7196\n7342\n7626\n7544\n3684\n3798\n4018\n3840\n",
      "llm_sql": "SELECT user_id\nFROM events\nWHERE arrayExists(x -> x LIKE '%premium%', tags)\nGROUP BY user_id\nHAVING count() > 0",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 473,
      "tokens_out": 45,
      "cost_usd": 0.002094,
      "latency_ms": 1511
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_01",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events;",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 369,
      "tokens_out": 6,
      "cost_usd": 0.00010623,
      "latency_ms": 2366.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_01",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count(*) FROM events;",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 369,
      "tokens_out": 6,
      "cost_usd": 0.00010623,
      "latency_ms": 2055.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_01",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events;",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 369,
      "tokens_out": 10,
      "cost_usd": 0.00011063,
      "latency_ms": 2343.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_02",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10;",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 368,
      "tokens_out": 19,
      "cost_usd": 0.00012026000000000002,
      "latency_ms": 2009.0
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_02",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10;",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 368,
      "tokens_out": 17,
      "cost_usd": 0.00011806000000000002,
      "latency_ms": 2583.0
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_02",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10;",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 368,
      "tokens_out": 17,
      "cost_usd": 0.00011806000000000002,
      "latency_ms": 2628.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_03",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT COUNT(*) AS event_count\nFROM events\nWHERE timestamp >= '2024-03-01 00:00:00' AND timestamp < '2024-04-01 00:00:00';",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 370,
      "tokens_out": 48,
      "cost_usd": 0.00015270000000000003,
      "latency_ms": 2551.0
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_03",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT COUNT() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01';",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 370,
      "tokens_out": 31,
      "cost_usd": 0.000134,
      "latency_ms": 2942.7
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_03",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT COUNT(*) FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01';",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 370,
      "tokens_out": 31,
      "cost_usd": 0.000134,
      "latency_ms": 2799.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_04",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type;",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 366,
      "tokens_out": 16,
      "cost_usd": 0.00011642000000000001,
      "latency_ms": 2511.1
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_04",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events;",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 366,
      "tokens_out": 13,
      "cost_usd": 0.00011312,
      "latency_ms": 2632.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_04",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events;",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 366,
      "tokens_out": 12,
      "cost_usd": 0.00011202000000000002,
      "latency_ms": 1651.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_05",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS event_count\nFROM events\nWHERE country = 'DE';",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 367,
      "tokens_out": 16,
      "cost_usd": 0.00011669,
      "latency_ms": 2011.5
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_05",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT COUNT(*) AS event_count\nFROM events\nWHERE country = 'DE';",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 367,
      "tokens_out": 20,
      "cost_usd": 0.00012109000000000001,
      "latency_ms": 1962.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_05",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT COUNT(*) FROM events WHERE country = 'DE';",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 367,
      "tokens_out": 15,
      "cost_usd": 0.00011559000000000001,
      "latency_ms": 1974.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_06",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 376,
      "tokens_out": 24,
      "cost_usd": 0.00012792,
      "latency_ms": 2571.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_06",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5;",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 376,
      "tokens_out": 24,
      "cost_usd": 0.00012792,
      "latency_ms": 2634.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_06",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 5;",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 376,
      "tokens_out": 26,
      "cost_usd": 0.00013012,
      "latency_ms": 2213.2
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_07",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT COUNT() FROM users WHERE plan = 'pro';",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 371,
      "tokens_out": 11,
      "cost_usd": 0.00011227000000000001,
      "latency_ms": 1770.7
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_07",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro';",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 371,
      "tokens_out": 11,
      "cost_usd": 0.00011227000000000001,
      "latency_ms": 2488.2
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_07",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT COUNT() FROM users WHERE plan = 'pro';",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 371,
      "tokens_out": 11,
      "cost_usd": 0.00011227000000000001,
      "latency_ms": 2235.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_08",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT min(timestamp) AS earliest_event, max(timestamp) AS latest_event FROM events;",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 369,
      "tokens_out": 23,
      "cost_usd": 0.00012493,
      "latency_ms": 2507.1
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_08",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT min(timestamp) as earliest_timestamp, max(timestamp) as latest_timestamp FROM events;",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 369,
      "tokens_out": 25,
      "cost_usd": 0.00012713,
      "latency_ms": 2777.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_08",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT MIN(timestamp) AS earliest_timestamp, MAX(timestamp) AS latest_timestamp FROM events;",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 369,
      "tokens_out": 25,
      "cost_usd": 0.00012713,
      "latency_ms": 2150.0
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_09",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01 00:00:00'\n  AND timestamp < '2025-01-01 00:00:00'\nORDER BY timestamp;",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 373,
      "tokens_out": 56,
      "cost_usd": 0.00016231,
      "latency_ms": 3282.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_09",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01'\n  AND timestamp < '2025-01-01'\nORDER BY timestamp;",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 373,
      "tokens_out": 44,
      "cost_usd": 0.00014911000000000001,
      "latency_ms": 2553.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_09",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01 00:00:00'\n  AND timestamp < '2025-01-01 00:00:00'\nORDER BY timestamp;",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 373,
      "tokens_out": 56,
      "cost_usd": 0.00016231,
      "latency_ms": 2669.2
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_10",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL;",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 371,
      "tokens_out": 12,
      "cost_usd": 0.00011337000000000001,
      "latency_ms": 2089.0
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_10",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL;",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 371,
      "tokens_out": 17,
      "cost_usd": 0.00011887,
      "latency_ms": 3071.2
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t1_10",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL;",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 371,
      "tokens_out": 17,
      "cost_usd": 0.00011887,
      "latency_ms": 2972.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_01",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count() AS event_count FROM events GROUP BY event_type ORDER BY event_count DESC;",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 372,
      "tokens_out": 25,
      "cost_usd": 0.00012794000000000003,
      "latency_ms": 2639.2
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_01",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    count() AS event_count\nFROM events\nGROUP BY event_type\nORDER BY event_count DESC;",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 372,
      "tokens_out": 31,
      "cost_usd": 0.00013454000000000002,
      "latency_ms": 2167.1
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_01",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, COUNT(*) as event_count FROM events GROUP BY event_type ORDER BY event_count DESC;",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 372,
      "tokens_out": 25,
      "cost_usd": 0.00012794000000000003,
      "latency_ms": 2279.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_02",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT device, avg(duration_ms) AS avg_duration_ms FROM events WHERE duration_ms IS NOT NULL GROUP BY device;",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 370,
      "tokens_out": 29,
      "cost_usd": 0.0001318,
      "latency_ms": 2306.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_02",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    device,\n    avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY device;",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 370,
      "tokens_out": 39,
      "cost_usd": 0.0001428,
      "latency_ms": 2418.7
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_02",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    device,\n    avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY device;",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 370,
      "tokens_out": 39,
      "cost_usd": 0.0001428,
      "latency_ms": 2655.2
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_03",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 373,
      "tokens_out": 51,
      "cost_usd": 0.00015681,
      "latency_ms": 2792.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_03",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    COUNT(*) AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00'\n  AND timestamp < '2024-02-01 00:00:00'\nGROUP BY day\nORDER BY day;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 373,
      "tokens_out": 68,
      "cost_usd": 0.00017551000000000003,
      "latency_ms": 2777.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_03",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toDate(timestamp) AS date, count() AS events_count\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' AND timestamp < '2024-02-01 00:00:00'\nGROUP BY date\nORDER BY date;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 373,
      "tokens_out": 64,
      "cost_usd": 0.00017111,
      "latency_ms": 3299.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_04",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() as event_count\nFROM events\nGROUP BY country\nHAVING event_count > 10000",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 370,
      "tokens_out": 30,
      "cost_usd": 0.0001329,
      "latency_ms": 2145.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_04",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, COUNT(*) as event_count\nFROM events\nGROUP BY country\nHAVING COUNT(*) > 10000;",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 370,
      "tokens_out": 30,
      "cost_usd": 0.0001329,
      "latency_ms": 2262.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_04",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, COUNT(*) as event_count\nFROM events\nGROUP BY country\nHAVING COUNT(*) > 10000\nORDER BY event_count DESC",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 370,
      "tokens_out": 36,
      "cost_usd": 0.0001395,
      "latency_ms": 2891.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_05",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toHour(timestamp) AS hour_of_day,\n    count() AS event_count\nFROM events\nGROUP BY hour_of_day\nORDER BY hour_of_day;",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 371,
      "tokens_out": 39,
      "cost_usd": 0.00014307,
      "latency_ms": 2276.5
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_05",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toHour(timestamp) AS hour_of_day,\n    count(*) AS event_count\nFROM events\nGROUP BY hour_of_day\nORDER BY hour_of_day;",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 371,
      "tokens_out": 39,
      "cost_usd": 0.00014307,
      "latency_ms": 2683.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_05",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toHour(timestamp) AS hour_of_day,\n    COUNT(*) AS event_count\nFROM events\nGROUP BY hour_of_day\nORDER BY hour_of_day;",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 371,
      "tokens_out": 39,
      "cost_usd": 0.00014307,
      "latency_ms": 2393.0
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_06",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) FROM events WHERE event_type = 'pageview';",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 374,
      "tokens_out": 20,
      "cost_usd": 0.00012298,
      "latency_ms": 2165.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_06",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) FROM events WHERE event_type = 'pageview';",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 374,
      "tokens_out": 20,
      "cost_usd": 0.00012298,
      "latency_ms": 2163.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_06",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) FROM events WHERE event_type = 'pageview';",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 374,
      "tokens_out": 20,
      "cost_usd": 0.00012298,
      "latency_ms": 1983.1
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_07",
      "tier": 2,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t85592\n2\t79807\n3\t84690\n4\t82004\n5\t85155\n6\t82530\n7\t84695\n8\t85076\n9\t81716\n10\t84939\n11\t81855\n12\t81941",
      "llm_sql": "SELECT\n    toMonth(timestamp) AS month,\n    COUNT(*) AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY month\nORDER BY month;",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 370,
      "tokens_out": 55,
      "cost_usd": 0.0001604,
      "latency_ms": 2912.5
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_07",
      "tier": 2,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 202401\t85592\n202402\t79807\n202403\t84690\n202404\t82004\n202405\t85155\n202406\t82530\n202407\t84695\n202408\t85",
      "llm_sql": "SELECT \n    toYYYYMM(timestamp) AS month,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY month\nORDER BY month;",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 370,
      "tokens_out": 56,
      "cost_usd": 0.0001615,
      "latency_ms": 2830.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_07",
      "tier": 2,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 202401\t85592\n202402\t79807\n202403\t84690\n202404\t82004\n202405\t85155\n202406\t82530\n202407\t84695\n202408\t85",
      "llm_sql": "SELECT \n    toYYYYMM(timestamp) AS month,\n    count() AS events_count\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' \n  AND timestamp <= '2024-12-31 23:59:59'\nGROUP BY month\nORDER BY month;",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 370,
      "tokens_out": 70,
      "cost_usd": 0.00017690000000000002,
      "latency_ms": 3502.1
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_08",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    uniqExact(country) AS distinct_countries_count\nFROM events\nGROUP BY event_type\nORDER BY event_type;",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 372,
      "tokens_out": 37,
      "cost_usd": 0.00014114000000000002,
      "latency_ms": 2460.0
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_08",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type, \n    COUNT(DISTINCT country) AS distinct_countries\nFROM events\nGROUP BY event_type\nORDER BY event_type;",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 372,
      "tokens_out": 36,
      "cost_usd": 0.00014004000000000002,
      "latency_ms": 2529.1
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_08",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, uniq(country) AS distinct_countries FROM events GROUP BY event_type ORDER BY event_type;",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 372,
      "tokens_out": 28,
      "cost_usd": 0.00013124,
      "latency_ms": 3179.2
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_09",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, SUM(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC;",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 374,
      "tokens_out": 44,
      "cost_usd": 0.00014937999999999998,
      "latency_ms": 2667.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_09",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, SUM(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY country;",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 374,
      "tokens_out": 39,
      "cost_usd": 0.00014387999999999998,
      "latency_ms": 2434.0
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_09",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    country,\n    SUM(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC;",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 374,
      "tokens_out": 47,
      "cost_usd": 0.00015268,
      "latency_ms": 2657.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_10",
      "tier": 2,
      "run": 1,
      "score": 0,
      "error_type": "No SQL",
      "error_msg": "Empty",
      "llm_sql": "",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 0,
      "tokens_out": 0,
      "cost_usd": 0.0,
      "latency_ms": 0
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_10",
      "tier": 2,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: purchase\t200181\npageview\t200001",
      "llm_sql": "SELECT\n    event_type,\n    COUNT(*) as event_count\nFROM events\nWHERE event_type IN ('purchase', 'pageview')\nGROUP BY event_type;",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 374,
      "tokens_out": 37,
      "cost_usd": 0.00014168,
      "latency_ms": 2375.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t2_10",
      "tier": 2,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: purchase\t200181\npageview\t200001",
      "llm_sql": "SELECT \n    event_type,\n    COUNT(*) as event_count\nFROM events\nWHERE event_type IN ('purchase', 'pageview')\nGROUP BY event_type;",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 374,
      "tokens_out": 37,
      "cost_usd": 0.00014168,
      "latency_ms": 2558.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_01",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT median(duration_ms) AS median_duration_ms FROM events WHERE duration_ms IS NOT NULL;",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 370,
      "tokens_out": 24,
      "cost_usd": 0.0001263,
      "latency_ms": 2262.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_01",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT median(duration_ms) FROM events;",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 370,
      "tokens_out": 13,
      "cost_usd": 0.0001142,
      "latency_ms": 1893.5
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_01",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT median(duration_ms) FROM events;",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 370,
      "tokens_out": 13,
      "cost_usd": 0.0001142,
      "latency_ms": 2254.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_02",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT COUNT(DISTINCT user_id) FROM events;",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 372,
      "tokens_out": 15,
      "cost_usd": 0.00011694000000000002,
      "latency_ms": 2457.5
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_02",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT COUNT(DISTINCT user_id) AS distinct_users_count FROM events;",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 372,
      "tokens_out": 19,
      "cost_usd": 0.00012134000000000001,
      "latency_ms": 2075.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_02",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT uniqExact(user_id) FROM events;",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 372,
      "tokens_out": 11,
      "cost_usd": 0.00011254000000000002,
      "latency_ms": 2160.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_03",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 879939\t2024-12-01 00:06:12.000\t3613\tpageview\t/settings\t5267\t{'campaign':'summer_sale','source':'twit",
      "llm_sql": "SELECT * \nFROM events \nWHERE mapContains(properties, 'campaign') = 1;",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 374,
      "tokens_out": 20,
      "cost_usd": 0.00012298,
      "latency_ms": 2117.7
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_03",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 39071\t2024-07-01 00:04:45.000\t8058\tpurchase\t/pricing\t1864\t{'campaign':'spring_promo','source':'faceb",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 374,
      "tokens_out": 18,
      "cost_usd": 0.00012078,
      "latency_ms": 2231.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_03",
      "tier": 3,
      "run": 3,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 43. DB::Exception: Received from localhost:9000. DB::Exception: Illegal type Array(String) of argument of function like: In scope SELECT * FROM ",
      "llm_sql": "SELECT *\nFROM events\nWHERE mapKeys(properties) LIKE '%campaign%';",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 374,
      "tokens_out": 17,
      "cost_usd": 0.00011968,
      "latency_ms": 2542.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_04",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT \n    properties['source'] AS source\nFROM events \nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 10;",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 381,
      "tokens_out": 35,
      "cost_usd": 0.00014137,
      "latency_ms": 2783.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_04",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT \n    properties['source'] AS source_value\nFROM events \nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 10;",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 381,
      "tokens_out": 37,
      "cost_usd": 0.00014356999999999998,
      "latency_ms": 3073.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_04",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events \nWHERE event_type = 'purchase'\nORDER BY timestamp \nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 381,
      "tokens_out": 32,
      "cost_usd": 0.00013806999999999998,
      "latency_ms": 2969.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_05",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT tag, count() AS occurrences FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY occurrences DESC;",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 380,
      "tokens_out": 27,
      "cost_usd": 0.00013230000000000002,
      "latency_ms": 2305.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_05",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    tag,\n    count() AS occurrences\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY occurrences DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 380,
      "tokens_out": 29,
      "cost_usd": 0.0001345,
      "latency_ms": 2576.0
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_05",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT tag, count(*) as occurrences FROM events ARRAY JOIN tags as tag GROUP BY tag ORDER BY occurrences DESC;",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 380,
      "tokens_out": 27,
      "cost_usd": 0.00013230000000000002,
      "latency_ms": 2113.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_06",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 430502\t2024-06-01 00:05:54.000\t5047\tpageview\t/settings\t2595\t{'source':'facebook'}\t['promo','vip_memb",
      "llm_sql": "SELECT * FROM events WHERE has(tags, 'promo');",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 375,
      "tokens_out": 13,
      "cost_usd": 0.00011555,
      "latency_ms": 1783.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_06",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 490461\t2024-04-01 00:07:06.000\t302\tlogout\t/dashboard\t\\N\t{'source':'facebook'}\t['promo','mobile']\tJP\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(tags, 'promo');",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 375,
      "tokens_out": 14,
      "cost_usd": 0.00011665,
      "latency_ms": 1954.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_06",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 877989\t2024-12-01 00:09:55.000\t6543\tpageview\t/home\t9658\t{'source':'direct'}\t['promo']\tFR\tdesktop\t\\N\n",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 375,
      "tokens_out": 14,
      "cost_usd": 0.00011665,
      "latency_ms": 2660.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_07",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    quantile(0.90)(duration_ms) AS p90_duration_ms,\n    quantile(0.99)(duration_ms) AS p99_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type;",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 376,
      "tokens_out": 66,
      "cost_usd": 0.00017412,
      "latency_ms": 3886.1
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_07",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: click\t8996\t9901\nlogout\t9010\t9900\npageview\t9012\t9901\npurchase\t9007\t9903\nsignup\t9018\t9903",
      "llm_sql": "SELECT \n    event_type,\n    quantileExact(0.90)(duration_ms) AS p90_duration_ms,\n    quantileExact(0.99)(duration_ms) AS p99_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type;",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 376,
      "tokens_out": 70,
      "cost_usd": 0.00017852000000000002,
      "latency_ms": 3463.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_07",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    quantile(0.9)(duration_ms) AS p90_duration_ms,\n    quantile(0.99)(duration_ms) AS p99_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type;",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 376,
      "tokens_out": 66,
      "cost_usd": 0.00017412,
      "latency_ms": 2652.2
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_08",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') FROM events;",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 376,
      "tokens_out": 16,
      "cost_usd": 0.00011912,
      "latency_ms": 2930.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_08",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') FROM events;",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 376,
      "tokens_out": 20,
      "cost_usd": 0.00012352,
      "latency_ms": 1925.5
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_08",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') FROM events;",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 376,
      "tokens_out": 16,
      "cost_usd": 0.00011912,
      "latency_ms": 1814.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_09",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS property_key FROM events ORDER BY property_key;",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 374,
      "tokens_out": 24,
      "cost_usd": 0.00012738000000000002,
      "latency_ms": 1975.2
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_09",
      "tier": 3,
      "run": 2,
      "score": 0,
      "error_type": "No SQL",
      "error_msg": "Empty",
      "llm_sql": "",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 0,
      "tokens_out": 0,
      "cost_usd": 0.0,
      "latency_ms": 0
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_09",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS property_key FROM events ORDER BY property_key;",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 374,
      "tokens_out": 24,
      "cost_usd": 0.00012738000000000002,
      "latency_ms": 2199.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_10",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 78581\t2024-11-01 00:07:22.000\t7126\tpageview\t/dashboard\t\\N\t{'source':'email'}\t['vip_member','new']\tJP",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(tag -> startsWith(tag, 'vip'), tags);",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 22,
      "cost_usd": 0.00012653000000000002,
      "latency_ms": 1856.5
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_10",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 984733\t2024-08-01 00:00:55.000\t7041\tlogout\t/about\t5140\t{'campaign':'black_friday','source':'facebook",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(tag -> startsWith(tag, 'vip'), tags);",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 22,
      "cost_usd": 0.00012653000000000002,
      "latency_ms": 2101.5
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t3_10",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 9358\t2024-03-01 00:33:51.000\t2954\tlogout\t/blog\t4711\t{'campaign':'launch','source':'facebook'}\t['vip_",
      "llm_sql": "SELECT *\nFROM events\nWHERE hasAny(arrayFilter(t -> startsWith(t, 'vip'), tags), tags) = 1;",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 28,
      "cost_usd": 0.00013313000000000002,
      "latency_ms": 2652.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_01",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 669632\t2024-09-01 00:00:08.000\t3308\tpurchase\t/about\t7933\t{'source':'twitter'}\t['mobile']\tGB\tmobile\t3",
      "llm_sql": "SELECT \n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country AS event_country,\n    e.device,\n    e.revenue_cents,\n    u.plan AS user_plan,\n    u.created_at AS user_created_at,\n    u.email,\n    u.age,\n    u.country AS user_country,\n    u.metadata AS user_metadata\nFROM events e\nLEFT JOIN users u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 128,
      "cost_usd": 0.00024313,
      "latency_ms": 3927.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_01",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 553579\t2024-03-01 00:00:32.000\t1637\tsignup\t/dashboard\t\\N\t{'campaign':'launch','source':'google'}\t[]\t",
      "llm_sql": "SELECT \n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country AS event_country,\n    e.device,\n    e.revenue_cents,\n    u.plan AS user_plan\nFROM events e\nLEFT JOIN users u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 87,
      "cost_usd": 0.00019803000000000003,
      "latency_ms": 3485.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_01",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t/blog\t\\N\t{'source':'facebook'}\t[]\tBR\ttablet\t\\N\tpro\n774716",
      "llm_sql": "SELECT \n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events e\nLEFT JOIN users u ON e.user_id = u.user_id;",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 80,
      "cost_usd": 0.00019033,
      "latency_ms": 13922.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_02",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    COALESCE(u.plan, 'unknown') AS plan,\n    COUNT(*) AS event_count\nFROM events e\nLEFT JOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC;",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 367,
      "tokens_out": 56,
      "cost_usd": 0.00016069,
      "latency_ms": 3133.7
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_02",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    COUNT(*) AS event_count\nFROM events e\nLEFT JOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 367,
      "tokens_out": 47,
      "cost_usd": 0.00015079,
      "latency_ms": 3425.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_02",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    COALESCE(u.plan, 'unknown') AS user_plan,\n    COUNT(*) AS event_count\nFROM events e\nLEFT JOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC;",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 367,
      "tokens_out": 58,
      "cost_usd": 0.00016289,
      "latency_ms": 2904.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_03",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id\nFROM users u\nLEFT JOIN events e ON u.user_id = e.user_id\nWHERE e.user_id IS NULL;",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 369,
      "tokens_out": 33,
      "cost_usd": 0.00013593,
      "latency_ms": 2094.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_03",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id\nFROM users u\nLEFT JOIN events e ON u.user_id = e.user_id\nWHERE e.user_id IS NULL;",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 369,
      "tokens_out": 33,
      "cost_usd": 0.00013593,
      "latency_ms": 2526.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_03",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id\nFROM users u\nLEFT JOIN events e ON u.user_id = e.user_id\nWHERE e.event_id IS NULL;",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 369,
      "tokens_out": 33,
      "cost_usd": 0.00013593,
      "latency_ms": 2424.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_04",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\tenterprise\t143\n1040\tpro\t138\n6726\tpro\t135\n7449\tpro\t135\n9339\tpro\t134\n4333\tpro\t133\n3566\tenterprise",
      "llm_sql": "WITH user_event_counts AS (\n    SELECT \n        user_id,\n        COUNT() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT \n    u.user_id,\n    u.plan,\n    uec.event_count\nFROM users u\nJOIN user_event_counts uec ON u.user_id = uec.user_id\nORDER BY uec.event_count DESC;",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 380,
      "tokens_out": 95,
      "cost_usd": 0.00020710000000000002,
      "latency_ms": 3882.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_04",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS (\n    SELECT \n        user_id,\n        COUNT(*) AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT \n    tu.user_id,\n    tu.event_count,\n    COALESCE(u.plan, 'unknown') AS user_plan\nFROM top_users tu\nLEFT JOIN users u ON tu.user_id = u.user_id\nORDER BY tu.event_count DESC;",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 380,
      "tokens_out": 100,
      "cost_usd": 0.00021260000000000002,
      "latency_ms": 4839.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_04",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS (\n    SELECT \n        user_id,\n        COUNT(*) AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT \n    tu.user_id,\n    tu.event_count,\n    u.plan\nFROM top_users tu\nLEFT JOIN users u ON tu.user_id = u.user_id\nORDER BY tu.event_count DESC;",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 380,
      "tokens_out": 89,
      "cost_usd": 0.0002005,
      "latency_ms": 3593.5
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_05",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    user_id,\n    COUNT(*) as total_events\nFROM events\nGROUP BY user_id\nHAVING total_events > (\n    SELECT AVG(event_count) \n    FROM (\n        SELECT COUNT(*) as event_count \n        FROM events \n        GROUP BY user_id\n    )\n)\nORDER BY total_events DESC;",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 375,
      "tokens_out": 74,
      "cost_usd": 0.00018265,
      "latency_ms": 3945.7
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_05",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    user_id,\n    COUNT(*) AS total_events\nFROM events\nGROUP BY user_id\nHAVING total_events > (\n    SELECT AVG(event_count) \n    FROM (\n        SELECT COUNT(*) AS event_count \n        FROM events \n        GROUP BY user_id\n    )\n)\nORDER BY total_events DESC;",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 375,
      "tokens_out": 74,
      "cost_usd": 0.00018265,
      "latency_ms": 4013.0
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_05",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT user_id, event_count\nFROM (\n    SELECT user_id, COUNT() AS event_count\n    FROM events\n    GROUP BY user_id\n)\nWHERE event_count > (\n    SELECT COUNT() / COUNT(DISTINCT user_id) \n    FROM events\n);",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 375,
      "tokens_out": 58,
      "cost_usd": 0.00016505,
      "latency_ms": 3468.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_06",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 624751\t2024-12-30 23:57:52.000\t4934\tpageview\t/home\t\\N\t{'source':'twitter'}\t['vip_member']\tIN\tmobile\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise')\nORDER BY timestamp DESC;",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 31,
      "cost_usd": 0.00013643000000000002,
      "latency_ms": 2336.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_06",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 774716\t2024-12-01 00:01:20.000\t1952\tpurchase\t/blog\t1651\t{'source':'facebook'}\t[]\tGB\ttablet\t\\N\n349664",
      "llm_sql": "SELECT e.* FROM events e WHERE e.user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise');",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 28,
      "cost_usd": 0.00013313000000000002,
      "latency_ms": 2390.5
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_06",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 774716\t2024-12-01 00:01:20.000\t1952\tpurchase\t/blog\t1651\t{'source':'facebook'}\t[]\tGB\ttablet\t\\N\n349664",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n);",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 32,
      "cost_usd": 0.00013753000000000002,
      "latency_ms": 2374.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_07",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    COUNT(e.event_id) / COUNT(DISTINCT u.user_id) AS avg_events_per_user\nFROM users u\nLEFT JOIN events e ON u.user_id = e.user_id\nGROUP BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 374,
      "tokens_out": 725,
      "cost_usd": 0.0008984800000000001,
      "latency_ms": 39639.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_07",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    COUNT(*) / COUNT(DISTINCT e.user_id) AS avg_events_per_user\nFROM events e\nLEFT JOIN users u ON e.user_id = u.user_id\nWHERE u.plan IS NOT NULL\nGROUP BY u.plan;",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 374,
      "tokens_out": 61,
      "cost_usd": 0.00016808,
      "latency_ms": 2779.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_07",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    COUNT(e.event_id) / COUNT(DISTINCT u.user_id) AS avg_events_per_user\nFROM users u\nLEFT JOIN events e ON u.user_id = e.user_id\nGROUP BY u.plan\nORDER BY u.plan;",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 374,
      "tokens_out": 62,
      "cost_usd": 0.00016918,
      "latency_ms": 3489.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_08",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3553\t2024-10-10 03:29:27.000\tenterprise\tJP\t26\t856.33\n1740\t2024-06-13 20:41:25.000\tenterprise\tDE\t28\t8",
      "llm_sql": "SELECT \n    u.user_id,\n    u.created_at AS signup_date,\n    u.plan,\n    u.country AS user_country,\n    COUNT(DISTINCT e.event_id) AS purchase_count,\n    SUM(e.revenue_cents) / 100.0 AS total_revenue\nFROM users u\nLEFT JOIN events e ON u.user_id = e.user_id AND e.event_type = 'purchase'\nWHERE toYear(u.created_at) = 2024\nGROUP BY u.user_id, u.created_at, u.plan, u.country\nHAVING purchase_count >= 1\nORDER BY total_revenue DESC NULLS LAST",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 377,
      "tokens_out": 139,
      "cost_usd": 0.00025469,
      "latency_ms": 4292.7
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_08",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3553\t2024-10-10 03:29:27.000\tenterprise\tJP\t26\t856.33\n1740\t2024-06-13 20:41:25.000\tenterprise\tDE\t28\t8",
      "llm_sql": "SELECT \n    u.user_id,\n    u.created_at AS signup_date,\n    u.plan,\n    u.country AS user_country,\n    COUNT(DISTINCT e.event_id) AS purchase_count,\n    SUM(e.revenue_cents) / 100.0 AS total_revenue_usd\nFROM users u\nINNER JOIN events e ON u.user_id = e.user_id\nWHERE \n    u.created_at >= '2024-01-01 00:00:00' \n    AND u.created_at < '2025-01-01 00:00:00'\n    AND e.event_type = 'purchase'\nGROUP BY u.user_id, u.created_at, u.plan, u.country\nHAVING purchase_count >= 1\nORDER BY total_revenue_usd DESC",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 377,
      "tokens_out": 173,
      "cost_usd": 0.00029209000000000006,
      "latency_ms": 5366.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_08",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3553\t2024-10-10 03:29:27.000\tenterprise\tJP\t26\t2024-01-18 18:16:41.000\t2024-12-29 17:33:49.000\t85633\n",
      "llm_sql": "SELECT \n    u.user_id,\n    u.created_at AS signup_date,\n    u.plan,\n    u.country AS user_country,\n    COUNT(DISTINCT e.event_id) AS purchase_count,\n    MIN(e.timestamp) AS first_purchase_time,\n    MAX(e.timestamp) AS last_purchase_time,\n    SUM(e.revenue_cents) AS total_revenue_cents\nFROM users u\nINNER JOIN events e ON u.user_id = e.user_id\nWHERE \n    u.created_at >= '2024-01-01' \n    AND u.created_at < '2025-01-01'\n    AND e.event_type = 'purchase'\nGROUP BY u.user_id, u.created_at, u.plan, u.c",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 377,
      "tokens_out": 183,
      "cost_usd": 0.00030309000000000005,
      "latency_ms": 5484.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_09",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS pro_users\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY pro_users DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 374,
      "tokens_out": 37,
      "cost_usd": 0.00014168,
      "latency_ms": 2263.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_09",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, COUNT(*) AS pro_user_count\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY pro_user_count DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 374,
      "tokens_out": 39,
      "cost_usd": 0.00014387999999999998,
      "latency_ms": 2554.0
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_09",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, COUNT(*) AS user_count\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY user_count DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 374,
      "tokens_out": 37,
      "cost_usd": 0.00014168,
      "latency_ms": 2117.7
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_10",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t3118\t56",
      "llm_sql": "SELECT\n    device,\n    user_id,\n    COUNT(*) AS event_count\nFROM events\nGROUP BY device, user_id\nORDER BY device, event_count DESC\nLIMIT 1 BY device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 373,
      "tokens_out": 45,
      "cost_usd": 0.00015021000000000001,
      "latency_ms": 2657.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_10",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t5365\t56",
      "llm_sql": "SELECT\n    e.device,\n    e.user_id,\n    COUNT(*) as event_count\nFROM events e\nGROUP BY e.device, e.user_id\nORDER BY e.device, event_count DESC\nLIMIT 1 BY e.device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 373,
      "tokens_out": 56,
      "cost_usd": 0.00016231,
      "latency_ms": 2781.7
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t4_10",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t5365\t56",
      "llm_sql": "SELECT \n    e.device,\n    e.user_id,\n    COUNT(*) AS event_count\nFROM events e\nGROUP BY e.device, e.user_id\nQUALIFY ROW_NUMBER() OVER (PARTITION BY e.device ORDER BY COUNT(*) DESC) = 1\nORDER BY e.device;",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 373,
      "tokens_out": 68,
      "cost_usd": 0.00017551000000000003,
      "latency_ms": 2803.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_01",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t39540\t2024-01-01 13:38:42.000\tlogout\t1\n1\t723127\t2024-01-08 14:54:29.000\tpageview\t2\n1\t203391\t2024-0",
      "llm_sql": "SELECT \n    user_id,\n    event_id,\n    timestamp,\n    event_type,\n    ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_number\nFROM events\nORDER BY user_id, event_number;",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 375,
      "tokens_out": 53,
      "cost_usd": 0.00015955,
      "latency_ms": 2597.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_01",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t2024-01-01 13:38:42.000\tlogout\t/docs\t1\n1\t2024-01-08 14:54:29.000\tpageview\t/checkout\t2\n1\t2024-01-09",
      "llm_sql": "SELECT \n    user_id,\n    timestamp,\n    event_type,\n    page,\n    ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_seq\nFROM events\nORDER BY user_id, timestamp;",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 375,
      "tokens_out": 51,
      "cost_usd": 0.00015735,
      "latency_ms": 2690.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_01",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t2024-01-01 13:38:42.000\tlogout\t1\n1\t2024-01-08 14:54:29.000\tpageview\t2\n1\t2024-01-09 15:11:25.000\tpa",
      "llm_sql": "SELECT \n    user_id,\n    timestamp,\n    event_type,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_number\nFROM events\nORDER BY user_id, event_number",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 375,
      "tokens_out": 47,
      "cost_usd": 0.00015294999999999998,
      "latency_ms": 2747.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_02",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS date,\n    count(*) AS daily_events,\n    sum(daily_events) OVER (ORDER BY date) AS running_total\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY date\nORDER BY date",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 373,
      "tokens_out": 73,
      "cost_usd": 0.00018101000000000003,
      "latency_ms": 3676.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_02",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS daily_events,\n    sum(daily_events) OVER (ORDER BY day ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS running_total\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 373,
      "tokens_out": 88,
      "cost_usd": 0.00019751000000000002,
      "latency_ms": 5463.0
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_02",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count(*) AS daily_events,\n    sum(daily_events) OVER (ORDER BY day ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS running_total\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 373,
      "tokens_out": 88,
      "cost_usd": 0.00019751000000000002,
      "latency_ms": 3952.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_03",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count,\n    lagInFrame(event_count) OVER (ORDER BY day) AS prev_day_event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 379,
      "tokens_out": 74,
      "cost_usd": 0.00018373000000000003,
      "latency_ms": 3689.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_03",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count,\n    lag(event_count) OVER (ORDER BY day) AS prev_day_event_count\nFROM events\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 379,
      "tokens_out": 50,
      "cost_usd": 0.00015733,
      "latency_ms": 3818.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_03",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count,\n    lag(event_count) OVER (ORDER BY day) AS prev_day_event_count\nFROM events\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 379,
      "tokens_out": 50,
      "cost_usd": 0.00015733,
      "latency_ms": 2687.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_04",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 387880\t2024-11-01 00:00:19.000\t6365\tclick\t/docs\t\\N\t{'source':'google'}\t[]\tIN\tdesktop\t9843\n625631\t202",
      "llm_sql": "SELECT event_id, timestamp, user_id, event_type, page, duration_ms, properties, arrayMap(x -> upper(x), tags) AS tags, country, device, revenue_cents FROM events;",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 373,
      "tokens_out": 45,
      "cost_usd": 0.00015021000000000001,
      "latency_ms": 2473.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_04",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 139299\t2024-10-01 00:00:42.000\t7817\tclick\t/docs\t646\t{'source':'email'}\t['MOBILE']\tBR\tmobile\t7523\n509",
      "llm_sql": "SELECT event_id, timestamp, user_id, event_type, page, duration_ms, properties, arrayMap(tag -> upperUTF8(tag), tags) AS tags, country, device, revenue_cents FROM events;",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 373,
      "tokens_out": 49,
      "cost_usd": 0.00015461,
      "latency_ms": 2959.5
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_04",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 139299\t2024-10-01 00:00:42.000\t7817\tclick\t/docs\t646\t{'source':'email'}\t['MOBILE']\tBR\tmobile\t7523\n509",
      "llm_sql": "SELECT event_id, timestamp, user_id, event_type, page, duration_ms, properties, arrayMap(tag -> upperUTF8(tag), tags) AS tags, country, device, revenue_cents FROM events;",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 373,
      "tokens_out": 49,
      "cost_usd": 0.00015461,
      "latency_ms": 3022.1
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_05",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: logout\t3812\npurchase\t7125\nsignup\t8908\npageview\t2833\nclick\t1371",
      "llm_sql": "SELECT event_type, argMax(user_id, total_duration) AS longest_duration_user_id\nFROM (\n    SELECT event_type, user_id, sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 378,
      "tokens_out": 71,
      "cost_usd": 0.00018016000000000004,
      "latency_ms": 3178.4
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_05",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: logout\t3812\nsignup\t8908\npageview\t2833\npurchase\t7125\nclick\t1371",
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration) AS user_id_with_longest_duration\nFROM (\n    SELECT\n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n) \nGROUP BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 378,
      "tokens_out": 81,
      "cost_usd": 0.00019116000000000003,
      "latency_ms": 3324.7
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_05",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: logout\t3812\nsignup\t8908\npurchase\t7125\npageview\t2833\nclick\t1371",
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration) AS longest_duration_user_id\nFROM (\n    SELECT\n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 378,
      "tokens_out": 78,
      "cost_usd": 0.00018786,
      "latency_ms": 2928.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_06",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT \n    toDate(timestamp) AS date,\n    COUNT(*) AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY date\nORDER BY date ASC\nWITH FILL FROM toDate('2024-01-01') TO toDate('2024-01-31') STEP 1;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 380,
      "tokens_out": 85,
      "cost_usd": 0.00019610000000000002,
      "latency_ms": 3649.7
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_06",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count(*) AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' AND timestamp < '2024-02-01 00:00:00'\nGROUP BY day\nORDER BY day ASC\nWITH FILL FROM toDate('2024-01-01') TO toDate('2024-02-01') STEP 1;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 380,
      "tokens_out": 97,
      "cost_usd": 0.00020930000000000002,
      "latency_ms": 3602.5
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_06",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day ASC WITH FILL FROM toDate('2024-01-01') TO toDate('2024-02-01') STEP 1;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 380,
      "tokens_out": 84,
      "cost_usd": 0.000195,
      "latency_ms": 3291.1
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_07",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t['click','logout','pageview','purchase','signup']\n9529\t['click','logout','pageview','purchase',",
      "llm_sql": "SELECT user_id, arraySort(groupUniqArray(event_type)) AS event_types FROM events GROUP BY user_id;",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 374,
      "tokens_out": 27,
      "cost_usd": 0.00013068000000000002,
      "latency_ms": 2751.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_07",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1978\t['click','click','click','click','click','click','click','click','click','click','click','click",
      "llm_sql": "SELECT user_id, arraySort(groupArray(event_type)) AS event_types FROM events GROUP BY user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 374,
      "tokens_out": 25,
      "cost_usd": 0.00012848000000000002,
      "latency_ms": 2412.6
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_07",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t['logout','signup','pageview','purchase','click']\n2\t['logout','signup','pageview','purchase','clic",
      "llm_sql": "SELECT \n    user_id, \n    groupUniqArray(event_type) AS all_event_types\nFROM events \nGROUP BY user_id\nORDER BY user_id;",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 374,
      "tokens_out": 37,
      "cost_usd": 0.00014168,
      "latency_ms": 2796.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_08",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t901732\tpurchase\t/dashboard\t2024-12-29 23:26:55.000\n9529\t728022\tpurchase\t/checkout\t2024-12-26 00",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS latest_event_id,\n    argMax(event_type, timestamp) AS latest_event_type,\n    argMax(page, timestamp) AS latest_page,\n    argMax(timestamp, timestamp) AS latest_timestamp\nFROM events\nGROUP BY user_id;",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 371,
      "tokens_out": 69,
      "cost_usd": 0.00017606999999999999,
      "latency_ms": 3185.2
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_08",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 4450\t304419\tsignup\t/blog\t2024-12-30 12:56:42.000\n3986\t195430\tlogout\t/about\t2024-12-26 06:16:20.000\n7",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS latest_event_id,\n    argMax(event_type, timestamp) AS latest_event_type,\n    argMax(page, timestamp) AS latest_page,\n    argMax(timestamp, timestamp) AS latest_timestamp\nFROM events\nGROUP BY user_id;",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 371,
      "tokens_out": 69,
      "cost_usd": 0.00017606999999999999,
      "latency_ms": 4288.7
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_08",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\tpurchase\t2024-12-29 23:26:55.000\n9529\tpurchase\t2024-12-26 00:08:06.000\n6122\tpurchase\t2024-12-19",
      "llm_sql": "SELECT user_id, argMax(event_type, timestamp) AS latest_event_type, max(timestamp) AS latest_timestamp FROM events GROUP BY user_id",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 371,
      "tokens_out": 35,
      "cost_usd": 0.00013867000000000003,
      "latency_ms": 2136.8
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_09",
      "tier": 5,
      "run": 1,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 47. DB::Exception: Received from localhost:9000. DB::Exception: Identifier 'hours.hour' cannot be resolved from table_function with name hours. ",
      "llm_sql": "SELECT\n    toHour(toStartOfHour(toDateTime('2024-06-15 00:00:00')) + INTERVAL hour HOUR) as hour,\n    count(event_id) as event_count\nFROM numbers(24) AS hours\nLEFT JOIN events ON toHour(timestamp) = hours.hour \n    AND toDate(timestamp) = '2024-06-15'\nGROUP BY hour\nORDER BY hour;",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 385,
      "tokens_out": 94,
      "cost_usd": 0.00020735000000000003,
      "latency_ms": 4112.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_09",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 0\t110\n1\t109\n2\t124\n3\t103\n4\t127\n5\t103\n6\t118\n7\t128\n8\t113\n9\t123\n10\t122\n11\t126\n12\t116\n13\t116\n14\t113\n15\t94",
      "llm_sql": "SELECT toHour(timestamp) AS hour, count() AS event_count\nFROM events\nWHERE timestamp >= '2024-06-15 00:00:00' AND timestamp < '2024-06-16 00:00:00'\nGROUP BY hour\nORDER BY hour WITH FILL FROM 0 TO 23;",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 385,
      "tokens_out": 73,
      "cost_usd": 0.00018425,
      "latency_ms": 2843.1
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_09",
      "tier": 5,
      "run": 3,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 206. DB::Exception: Received from localhost:9000. DB::Exception: JOIN  LEFT JOIN ... ON toStartOfHour(events.timestamp) = hour_start no alias fo",
      "llm_sql": "SELECT\n    toStartOfHour(fromUnixTimestamp(unixtime)) AS hour_start,\n    count(event_id) AS event_count\nFROM (\n    SELECT\n        toUnixTimestamp('2024-06-15 00:00:00') + (number * 3600) AS unixtime\n    FROM numbers(24)\n)\nLEFT JOIN events ON toStartOfHour(events.timestamp) = hour_start\nGROUP BY hour_start\nORDER BY hour_start",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 385,
      "tokens_out": 102,
      "cost_usd": 0.00021615,
      "latency_ms": 4125.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_10",
      "tier": 5,
      "run": 1,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 43. DB::Exception: Received from localhost:9000. DB::Exception: First argument for function has must be an array or map. Actual String: In scope",
      "llm_sql": "SELECT DISTINCT user_id\nFROM events\nARRAY JOIN tags\nWHERE has(tags, 'premium')",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 390,
      "tokens_out": 27,
      "cost_usd": 0.000135,
      "latency_ms": 1890.3
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_10",
      "tier": 5,
      "run": 2,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 43. DB::Exception: Received from localhost:9000. DB::Exception: First argument for function has must be an array or map. Actual String: In scope",
      "llm_sql": "SELECT \n    DISTINCT user_id \nFROM events \nARRAY JOIN tags \nWHERE has(tags, 'premium')",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 390,
      "tokens_out": 29,
      "cost_usd": 0.00013720000000000003,
      "latency_ms": 2398.9
    },
    {
      "model": "deepseek-v3.2",
      "question_id": "t5_10",
      "tier": 5,
      "run": 3,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 43. DB::Exception: Received from localhost:9000. DB::Exception: First argument for function has must be an array or map. Actual String: In scope",
      "llm_sql": "SELECT DISTINCT user_id\nFROM events\nARRAY JOIN tags\nWHERE has(tags, 'premium')",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 390,
      "tokens_out": 27,
      "cost_usd": 0.000135,
      "latency_ms": 2714.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_01",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events;",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 416,
      "tokens_out": 6,
      "cost_usd": 6.6e-05,
      "latency_ms": 1165.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_01",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events;",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 418,
      "tokens_out": 6,
      "cost_usd": 6.63e-05,
      "latency_ms": 1206.0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_01",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events;",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 416,
      "tokens_out": 6,
      "cost_usd": 6.6e-05,
      "latency_ms": 1183.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_02",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10;",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 418,
      "tokens_out": 13,
      "cost_usd": 7.05e-05,
      "latency_ms": 1116.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_02",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10;",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 418,
      "tokens_out": 13,
      "cost_usd": 7.05e-05,
      "latency_ms": 1189.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_02",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10;",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 418,
      "tokens_out": 13,
      "cost_usd": 7.05e-05,
      "latency_ms": 1328.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_03",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE timestamp >= '2024-03-01 00:00:00' AND timestamp < '2024-04-01 00:00:00'",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 421,
      "tokens_out": 55,
      "cost_usd": 9.615e-05,
      "latency_ms": 1379.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_03",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE timestamp >= '2024-03-01 00:00:00' AND timestamp < '2024-04-01 00:00:00'",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 419,
      "tokens_out": 55,
      "cost_usd": 9.585e-05,
      "latency_ms": 1568.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_03",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE timestamp >= '2024-03-01 00:00:00' AND timestamp < '2024-04-01 00:00:00'",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 421,
      "tokens_out": 55,
      "cost_usd": 9.615e-05,
      "latency_ms": 1663.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_04",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events;",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 415,
      "tokens_out": 8,
      "cost_usd": 6.705e-05,
      "latency_ms": 1143.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_04",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events;",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 415,
      "tokens_out": 8,
      "cost_usd": 6.705e-05,
      "latency_ms": 1098.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_04",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events;",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 415,
      "tokens_out": 8,
      "cost_usd": 6.705e-05,
      "latency_ms": 1272.6
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_05",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE country = 'DE';",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 416,
      "tokens_out": 11,
      "cost_usd": 6.9e-05,
      "latency_ms": 1302.6
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_05",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE country = 'DE';",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 416,
      "tokens_out": 11,
      "cost_usd": 6.9e-05,
      "latency_ms": 1230.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_05",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE country = 'DE';",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 416,
      "tokens_out": 11,
      "cost_usd": 6.9e-05,
      "latency_ms": 1115.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_06",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 5;",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 422,
      "tokens_out": 26,
      "cost_usd": 7.89e-05,
      "latency_ms": 1329.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_06",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 5;",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 422,
      "tokens_out": 26,
      "cost_usd": 7.89e-05,
      "latency_ms": 1620.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_06",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 5;",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 424,
      "tokens_out": 26,
      "cost_usd": 7.919999999999999e-05,
      "latency_ms": 1480.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_07",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 418,
      "tokens_out": 11,
      "cost_usd": 6.929999999999999e-05,
      "latency_ms": 1422.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_07",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 418,
      "tokens_out": 11,
      "cost_usd": 6.929999999999999e-05,
      "latency_ms": 1735.8
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_07",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 418,
      "tokens_out": 11,
      "cost_usd": 6.929999999999999e-05,
      "latency_ms": 1297.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_08",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    min(timestamp) AS earliest_event,\n    max(timestamp) AS latest_event\nFROM events;",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 418,
      "tokens_out": 26,
      "cost_usd": 7.829999999999999e-05,
      "latency_ms": 1230.6
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_08",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    min(timestamp) AS earliest_event,\n    max(timestamp) AS latest_event\nFROM events;",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 418,
      "tokens_out": 26,
      "cost_usd": 7.829999999999999e-05,
      "latency_ms": 1120.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_08",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    min(timestamp) AS earliest_event,\n    max(timestamp) AS latest_event\nFROM events;",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 418,
      "tokens_out": 26,
      "cost_usd": 7.829999999999999e-05,
      "latency_ms": 1456.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_09",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01 00:00:00'\n  AND timestamp <= '2024-12-31 23:59:59.999'",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 426,
      "tokens_out": 70,
      "cost_usd": 0.0001059,
      "latency_ms": 11927.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_09",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01 00:00:00'\n  AND timestamp <= '2024-12-31 23:59:59.999'",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 426,
      "tokens_out": 70,
      "cost_usd": 0.0001059,
      "latency_ms": 1481.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_09",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01 00:00:00'\n  AND timestamp <= '2024-12-31 23:59:59.999'",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 424,
      "tokens_out": 70,
      "cost_usd": 0.00010559999999999999,
      "latency_ms": 1808.6
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_10",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL;",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 419,
      "tokens_out": 13,
      "cost_usd": 7.065e-05,
      "latency_ms": 1685.0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_10",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL;",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 419,
      "tokens_out": 13,
      "cost_usd": 7.065e-05,
      "latency_ms": 1506.6
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t1_10",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL;",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 421,
      "tokens_out": 13,
      "cost_usd": 7.095e-05,
      "latency_ms": 1122.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_01",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    count() AS event_count\nFROM events\nGROUP BY event_type\nORDER BY event_count DESC;",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 421,
      "tokens_out": 32,
      "cost_usd": 8.235e-05,
      "latency_ms": 1320.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_01",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    count() AS event_count\nFROM events\nGROUP BY event_type\nORDER BY event_count DESC;",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 421,
      "tokens_out": 32,
      "cost_usd": 8.235e-05,
      "latency_ms": 1196.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_01",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    count() AS event_count\nFROM events\nGROUP BY event_type\nORDER BY event_count DESC;",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 419,
      "tokens_out": 32,
      "cost_usd": 8.205e-05,
      "latency_ms": 1569.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_02",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    device,\n    avg(duration_ms)\nFROM events\nGROUP BY device;",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 418,
      "tokens_out": 21,
      "cost_usd": 7.53e-05,
      "latency_ms": 1238.8
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_02",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    device,\n    avg(duration_ms)\nFROM events\nGROUP BY device;",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 418,
      "tokens_out": 21,
      "cost_usd": 7.53e-05,
      "latency_ms": 1937.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_02",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    device,\n    avg(duration_ms)\nFROM events\nGROUP BY device;",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 420,
      "tokens_out": 21,
      "cost_usd": 7.56e-05,
      "latency_ms": 1196.0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_03",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' AND timestamp < '2024-02-01 00:00:00'\nGROUP BY day\nORDER BY day;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 422,
      "tokens_out": 79,
      "cost_usd": 0.0001107,
      "latency_ms": 2648.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_03",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' AND timestamp < '2024-02-01 00:00:00'\nGROUP BY day\nORDER BY day;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 422,
      "tokens_out": 79,
      "cost_usd": 0.0001107,
      "latency_ms": 1959.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_03",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' AND timestamp < '2024-02-01 00:00:00'\nGROUP BY day\nORDER BY day;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 424,
      "tokens_out": 84,
      "cost_usd": 0.000114,
      "latency_ms": 1598.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_04",
      "tier": 2,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: IN\nGB\nNL\nCA\nAU\nBR\nUS\nDE\nJP\nFR",
      "llm_sql": "SELECT\n    country\nFROM events\nGROUP BY country\nHAVING count() > 10000;",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 422,
      "tokens_out": 29,
      "cost_usd": 8.069999999999998e-05,
      "latency_ms": 1135.0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_04",
      "tier": 2,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: IN\nGB\nNL\nCA\nAU\nBR\nUS\nDE\nJP\nFR",
      "llm_sql": "SELECT\n    country\nFROM events\nGROUP BY country\nHAVING count() > 10000;",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 422,
      "tokens_out": 29,
      "cost_usd": 8.069999999999998e-05,
      "latency_ms": 1493.8
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_04",
      "tier": 2,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: IN\nGB\nNL\nCA\nAU\nBR\nUS\nDE\nJP\nFR",
      "llm_sql": "SELECT\n    country\nFROM events\nGROUP BY country\nHAVING count() > 10000;",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 422,
      "tokens_out": 29,
      "cost_usd": 8.069999999999998e-05,
      "latency_ms": 1810.0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_05",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toHour(timestamp) AS hour_of_day,\n    count() AS event_count\nFROM events\nGROUP BY hour_of_day\nORDER BY hour_of_day;",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 420,
      "tokens_out": 48,
      "cost_usd": 9.18e-05,
      "latency_ms": 1358.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_05",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toHour(timestamp) AS hour_of_day,\n    count() AS event_count\nFROM events\nGROUP BY hour_of_day\nORDER BY hour_of_day;",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 418,
      "tokens_out": 43,
      "cost_usd": 8.85e-05,
      "latency_ms": 1490.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_05",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toHour(timestamp) AS hour_of_day,\n    count() AS event_count\nFROM events\nGROUP BY hour_of_day\nORDER BY hour_of_day;",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 418,
      "tokens_out": 43,
      "cost_usd": 8.85e-05,
      "latency_ms": 1509.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_06",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms)\nFROM events\nWHERE event_type = 'pageview';",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 422,
      "tokens_out": 25,
      "cost_usd": 7.829999999999999e-05,
      "latency_ms": 7373.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_06",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) FROM events WHERE event_type = 'pageview';",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 424,
      "tokens_out": 18,
      "cost_usd": 7.439999999999999e-05,
      "latency_ms": 1108.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_06",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) FROM events WHERE event_type = 'pageview';",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 424,
      "tokens_out": 18,
      "cost_usd": 7.439999999999999e-05,
      "latency_ms": 1287.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_07",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toStartOfMonth(timestamp) AS month,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' AND timestamp <= '2024-12-31 23:59:59'\nGROUP BY month\nORDER BY month;",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 421,
      "tokens_out": 86,
      "cost_usd": 0.00011475,
      "latency_ms": 1764.6
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_07",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toStartOfMonth(timestamp) AS month,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' AND timestamp <= '2024-12-31 23:59:59'\nGROUP BY month\nORDER BY month;",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 421,
      "tokens_out": 86,
      "cost_usd": 0.00011475,
      "latency_ms": 2171.8
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_07",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toStartOfMonth(timestamp) AS month,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' AND timestamp <= '2024-12-31 23:59:59'\nGROUP BY month\nORDER BY month;",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 421,
      "tokens_out": 86,
      "cost_usd": 0.00011475,
      "latency_ms": 1517.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_08",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    uniq(country)\nFROM events\nGROUP BY event_type;",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 419,
      "tokens_out": 23,
      "cost_usd": 7.664999999999999e-05,
      "latency_ms": 1404.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_08",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    uniq(country)\nFROM events\nGROUP BY event_type;",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 421,
      "tokens_out": 28,
      "cost_usd": 7.995e-05,
      "latency_ms": 1266.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_08",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    uniq(country)\nFROM events\nGROUP BY event_type;",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 419,
      "tokens_out": 23,
      "cost_usd": 7.664999999999999e-05,
      "latency_ms": 1731.0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_09",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    country,\n    sum(revenue_cents) AS total_revenue\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country;",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 421,
      "tokens_out": 33,
      "cost_usd": 8.295e-05,
      "latency_ms": 1538.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_09",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    country,\n    sum(revenue_cents) AS total_revenue\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country;",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 421,
      "tokens_out": 33,
      "cost_usd": 8.295e-05,
      "latency_ms": 1704.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_09",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    country,\n    sum(revenue_cents) AS total_revenue\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country;",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 423,
      "tokens_out": 33,
      "cost_usd": 8.325e-05,
      "latency_ms": 1253.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_10",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    countIf(event_type = 'purchase') AS purchase_count,\n    countIf(event_type = 'pageview') AS pageview_count\nFROM events;",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 421,
      "tokens_out": 45,
      "cost_usd": 9.015000000000001e-05,
      "latency_ms": 1686.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_10",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    countIf(event_type = 'purchase') AS purchase_count,\n    countIf(event_type = 'pageview') AS pageview_count\nFROM events;",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 423,
      "tokens_out": 45,
      "cost_usd": 9.044999999999999e-05,
      "latency_ms": 1276.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t2_10",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    countIf(event_type = 'purchase') AS purchase_count,\n    countIf(event_type = 'pageview') AS pageview_count\nFROM events;",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 421,
      "tokens_out": 45,
      "cost_usd": 9.015000000000001e-05,
      "latency_ms": 2874.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_01",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT median(duration_ms) FROM events;",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 418,
      "tokens_out": 10,
      "cost_usd": 6.869999999999999e-05,
      "latency_ms": 1639.6
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_01",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT median(duration_ms) FROM events;",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 420,
      "tokens_out": 15,
      "cost_usd": 7.2e-05,
      "latency_ms": 1328.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_01",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT median(duration_ms) FROM events;",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 420,
      "tokens_out": 15,
      "cost_usd": 7.2e-05,
      "latency_ms": 1175.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_02",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count(DISTINCT user_id) FROM events;",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 419,
      "tokens_out": 12,
      "cost_usd": 7.005e-05,
      "latency_ms": 1398.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_02",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count(DISTINCT user_id) FROM events;",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 419,
      "tokens_out": 12,
      "cost_usd": 7.005e-05,
      "latency_ms": 1579.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_02",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count(DISTINCT user_id) FROM events;",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 421,
      "tokens_out": 17,
      "cost_usd": 7.335e-05,
      "latency_ms": 2097.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_03",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 710692\t2024-11-01 00:03:27.000\t2732\tpurchase\t/home\t\\N\t{'campaign':'spring_promo','source':'google'}\t",
      "llm_sql": "SELECT\n    *\nFROM events\nWHERE mapContains(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 422,
      "tokens_out": 17,
      "cost_usd": 7.35e-05,
      "latency_ms": 1396.0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_03",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 39071\t2024-07-01 00:04:45.000\t8058\tpurchase\t/pricing\t1864\t{'campaign':'spring_promo','source':'faceb",
      "llm_sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 420,
      "tokens_out": 15,
      "cost_usd": 7.2e-05,
      "latency_ms": 3296.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_03",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 879939\t2024-12-01 00:06:12.000\t3613\tpageview\t/settings\t5267\t{'campaign':'summer_sale','source':'twit",
      "llm_sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 420,
      "tokens_out": 15,
      "cost_usd": 7.2e-05,
      "latency_ms": 1239.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_04",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: facebook\nfacebook\nemail\ndirect\nfacebook\nemail\ngoogle\nemail\ntwitter\ngoogle",
      "llm_sql": "SELECT properties['source']\nFROM events\nWHERE event_type = 'purchase'\nLIMIT 10;",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 429,
      "tokens_out": 23,
      "cost_usd": 7.814999999999999e-05,
      "latency_ms": 1818.8
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_04",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: facebook\nfacebook\nemail\ndirect\nfacebook\nemail\ngoogle\nemail\ntwitter\ngoogle",
      "llm_sql": "SELECT properties['source']\nFROM events\nWHERE event_type = 'purchase'\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 431,
      "tokens_out": 22,
      "cost_usd": 7.785e-05,
      "latency_ms": 1288.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_04",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: twitter\ndirect\nfacebook\nfacebook\ntwitter\ngoogle\nemail\nfacebook\ngoogle\ntwitter",
      "llm_sql": "SELECT properties['source']\nFROM events\nWHERE event_type = 'purchase'\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 431,
      "tokens_out": 22,
      "cost_usd": 7.785e-05,
      "latency_ms": 1349.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_05",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    tag,\n    count() AS count\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY count DESC;",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 427,
      "tokens_out": 30,
      "cost_usd": 8.205e-05,
      "latency_ms": 1380.0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_05",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    tag,\n    count() AS count\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY count DESC;",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 427,
      "tokens_out": 30,
      "cost_usd": 8.205e-05,
      "latency_ms": 1388.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_05",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    tag,\n    count() AS count\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY count DESC;",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 429,
      "tokens_out": 30,
      "cost_usd": 8.235e-05,
      "latency_ms": 1220.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_06",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 877989\t2024-12-01 00:09:55.000\t6543\tpageview\t/home\t9658\t{'source':'direct'}\t['promo']\tFR\tdesktop\t\\N\n",
      "llm_sql": "SELECT\n    *\nFROM events\nWHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 421,
      "tokens_out": 16,
      "cost_usd": 7.275e-05,
      "latency_ms": 1241.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_06",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 644674\t2024-11-01 00:08:01.000\t6051\tclick\t/docs\t\\N\t{'source':'email'}\t['promo','vip_member','premium",
      "llm_sql": "SELECT * FROM events WHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 423,
      "tokens_out": 12,
      "cost_usd": 7.065e-05,
      "latency_ms": 1302.8
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_06",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 337459\t2024-08-01 00:05:33.000\t7274\tclick\t/docs\t8433\t{'source':'direct'}\t['promo','vip_member','mobi",
      "llm_sql": "SELECT * FROM events WHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 423,
      "tokens_out": 12,
      "cost_usd": 7.065e-05,
      "latency_ms": 1473.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_07",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    quantile(0.90)(duration_ms) AS p90,\n    quantile(0.99)(duration_ms) AS p99\nFROM events\nGROUP BY event_type;",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 426,
      "tokens_out": 57,
      "cost_usd": 9.81e-05,
      "latency_ms": 1836.0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_07",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    quantile(0.90)(duration_ms) AS p90,\n    quantile(0.99)(duration_ms) AS p99\nFROM events\nGROUP BY event_type;",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 426,
      "tokens_out": 57,
      "cost_usd": 9.81e-05,
      "latency_ms": 3002.0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_07",
      "tier": 3,
      "run": 3,
      "score": 0,
      "error_type": "No SQL",
      "error_msg": "Empty",
      "llm_sql": "",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 0,
      "tokens_out": 0,
      "cost_usd": 0.0,
      "latency_ms": 0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_08",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') FROM events;",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 426,
      "tokens_out": 16,
      "cost_usd": 7.35e-05,
      "latency_ms": 2153.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_08",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') FROM events;",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 426,
      "tokens_out": 16,
      "cost_usd": 7.35e-05,
      "latency_ms": 1393.3
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_08",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') FROM events;",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 424,
      "tokens_out": 16,
      "cost_usd": 7.319999999999999e-05,
      "latency_ms": 1421.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_09",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) FROM events;",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 423,
      "tokens_out": 13,
      "cost_usd": 7.125e-05,
      "latency_ms": 1209.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_09",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) FROM events;",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 421,
      "tokens_out": 13,
      "cost_usd": 7.095e-05,
      "latency_ms": 1261.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_09",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) FROM events;",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 421,
      "tokens_out": 13,
      "cost_usd": 7.095e-05,
      "latency_ms": 1556.3
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_10",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 78581\t2024-11-01 00:07:22.000\t7126\tpageview\t/dashboard\t\\N\t{'source':'email'}\t['vip_member','new']\tJP",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(x -> x LIKE 'vip%', tags)",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 427,
      "tokens_out": 19,
      "cost_usd": 7.545e-05,
      "latency_ms": 1387.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_10",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 382179\t2024-07-01 00:24:07.000\t5702\tsignup\t/about\t7987\t{'campaign':'spring_promo','source':'email'}\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(x -> x LIKE 'vip%', tags)",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 425,
      "tokens_out": 19,
      "cost_usd": 7.515000000000001e-05,
      "latency_ms": 1759.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t3_10",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 227800\t2024-06-01 00:02:52.000\t5652\tclick\t/checkout\t\\N\t{'campaign':'launch','source':'email'}\t['vip_",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(x -> x LIKE 'vip%', tags)",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 427,
      "tokens_out": 19,
      "cost_usd": 7.545e-05,
      "latency_ms": 1176.3
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_01",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 669632\t2024-09-01 00:00:08.000\t3308\tpurchase\t/about\t7933\t{'source':'twitter'}\t['mobile']\tGB\tmobile\t3",
      "llm_sql": "SELECT\n    e.*,\n    u.plan\nFROM events AS e\nINNER JOIN users AS u ON e.user_id = u.user_id;",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 429,
      "tokens_out": 35,
      "cost_usd": 8.535e-05,
      "latency_ms": 1257.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_01",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 823694\t2024-06-01 00:00:48.000\t3869\tclick\t/checkout\t2962\t{'campaign':'summer_sale','source':'email'}",
      "llm_sql": "SELECT\n    e.*,\n    u.plan\nFROM events AS e\nINNER JOIN users AS u ON e.user_id = u.user_id;",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 429,
      "tokens_out": 35,
      "cost_usd": 8.535e-05,
      "latency_ms": 1335.0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_01",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t/blog\t\\N\t{'source':'facebook'}\t[]\tBR\ttablet\t\\N\tpro\n774716",
      "llm_sql": "SELECT\n    e.*,\n    u.plan\nFROM events AS e\nINNER JOIN users AS u ON e.user_id = u.user_id;",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 429,
      "tokens_out": 35,
      "cost_usd": 8.535e-05,
      "latency_ms": 1255.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_02",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count() AS event_count\nFROM events AS e\nINNER JOIN users AS u ON e.user_id = u.user_id\nGROUP BY u.plan;",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 414,
      "tokens_out": 50,
      "cost_usd": 9.209999999999999e-05,
      "latency_ms": 1682.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_02",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count() AS event_count\nFROM events AS e\nINNER JOIN users AS u ON e.user_id = u.user_id\nGROUP BY u.plan;",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 414,
      "tokens_out": 50,
      "cost_usd": 9.209999999999999e-05,
      "latency_ms": 1494.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_02",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count() AS event_count\nFROM events AS e\nINNER JOIN users AS u ON e.user_id = u.user_id\nGROUP BY u.plan;",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 416,
      "tokens_out": 50,
      "cost_usd": 9.240000000000001e-05,
      "latency_ms": 1374.6
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_03",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.user_id\nFROM users AS u\nLEFT ANTI JOIN events AS e ON u.user_id = e.user_id;",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 416,
      "tokens_out": 33,
      "cost_usd": 8.22e-05,
      "latency_ms": 1728.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_03",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.user_id\nFROM users AS u\nLEFT ANTI JOIN events AS e ON u.user_id = e.user_id;",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 416,
      "tokens_out": 33,
      "cost_usd": 8.22e-05,
      "latency_ms": 1513.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_03",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.user_id\nFROM users AS u\nLEFT ANTI JOIN events AS e ON u.user_id = e.user_id;",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 416,
      "tokens_out": 33,
      "cost_usd": 8.22e-05,
      "latency_ms": 1857.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_04",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH top_users AS (\n    SELECT \n        user_id, \n        count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT \n    t.user_id, \n    t.event_count, \n    u.plan\nFROM top_users AS t\nJOIN users AS u ON t.user_id = u.user_id;",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 427,
      "tokens_out": 103,
      "cost_usd": 0.00012585,
      "latency_ms": 1909.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_04",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 185\t131\tfree\n1040\t138\tpro\n3566\t132\tenterprise\n4333\t133\tpro\n6396\t143\tenterprise\n6726\t135\tpro\n7449\t135",
      "llm_sql": "WITH top_users AS (\n    SELECT \n        user_id, \n        count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT \n    t.user_id, \n    t.event_count, \n    u.plan\nFROM top_users AS t\nJOIN users AS u ON t.user_id = u.user_id;",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 427,
      "tokens_out": 103,
      "cost_usd": 0.00012585,
      "latency_ms": 2148.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_04",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1040\t138\tpro\n3566\t132\tenterprise\n4333\t133\tpro\n6396\t143\tenterprise\n6726\t135\tpro\n7054\t131\tfree\n7449\t13",
      "llm_sql": "WITH top_users AS (\n    SELECT \n        user_id, \n        count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT \n    t.user_id, \n    t.event_count, \n    u.plan\nFROM top_users AS t\nJOIN users AS u ON t.user_id = u.user_id;",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 427,
      "tokens_out": 103,
      "cost_usd": 0.00012585,
      "latency_ms": 3006.6
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_05",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\n1105\n8493\n591\n69\n3585\n3083\n2581\n7076\n6574\n9276\n5871\n8738\n7359\n2832\n2330\n2620\n5577\n1650\n9488\n108",
      "llm_sql": "SELECT\n    user_id\nFROM events\nGROUP BY user_id\nHAVING count() > (\n    SELECT\n        count() / uniq(user_id)\n    FROM events\n)",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 424,
      "tokens_out": 47,
      "cost_usd": 9.18e-05,
      "latency_ms": 1351.6
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_05",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 4450\n3480\n2950\n2444\n6205\n5753\n9386\n1474\n9888\n8382\n988\n4717\n4199\n7974\n3229\n6456\n6012\n9647\n729\n4968\n86",
      "llm_sql": "SELECT\n    user_id\nFROM events\nGROUP BY user_id\nHAVING count() > (\n    SELECT\n        count() / uniq(user_id)\n    FROM events\n)",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 422,
      "tokens_out": 42,
      "cost_usd": 8.85e-05,
      "latency_ms": 1940.8
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_05",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 9432\n5643\n4639\n8396\n942\n8902\n7761\n4064\n3562\n6725\n5902\n1727\n5380\n683\n4368\n3311\n7518\n6474\n1627\n1105\n84",
      "llm_sql": "SELECT\n    user_id\nFROM events\nGROUP BY user_id\nHAVING count() > (\n    SELECT\n        count() / uniq(user_id)\n    FROM events\n)",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 424,
      "tokens_out": 47,
      "cost_usd": 9.18e-05,
      "latency_ms": 1806.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_06",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 276933\t2024-04-01 00:00:42.000\t5857\tlogout\t/about\t3721\t{'source':'facebook'}\t['vip_member','mobile']",
      "llm_sql": "SELECT\n    *\nFROM events\nWHERE user_id IN (\n    SELECT\n        user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 425,
      "tokens_out": 36,
      "cost_usd": 8.535e-05,
      "latency_ms": 1656.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_06",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 81015\t2024-11-01 00:04:33.000\t8349\tsignup\t/settings\t4631\t{'campaign':'launch','source':'google'}\t[]\t",
      "llm_sql": "SELECT\n    *\nFROM events\nWHERE user_id IN (\n    SELECT\n        user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 425,
      "tokens_out": 36,
      "cost_usd": 8.535e-05,
      "latency_ms": 1578.8
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_06",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 850863\t2024-08-01 00:00:37.000\t149\tpageview\t/docs\t9698\t{'source':'facebook'}\t[]\tGB\ttablet\t3393\n98473",
      "llm_sql": "SELECT\n    *\nFROM events\nWHERE user_id IN (\n    SELECT\n        user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 425,
      "tokens_out": 36,
      "cost_usd": 8.535e-05,
      "latency_ms": 1527.0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_07",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count(e.event_id) / count(DISTINCT u.user_id) AS avg_events_per_user\nFROM users AS u\nLEFT JOIN events AS e ON u.user_id = e.user_id\nGROUP BY u.plan;",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 421,
      "tokens_out": 71,
      "cost_usd": 0.00010575,
      "latency_ms": 1696.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_07",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count(e.event_id) / count(DISTINCT u.user_id) AS avg_events_per_user\nFROM users AS u\nLEFT JOIN events AS e ON u.user_id = e.user_id\nGROUP BY u.plan;",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 421,
      "tokens_out": 71,
      "cost_usd": 0.00010575,
      "latency_ms": 1777.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_07",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count(e.event_id) / count(DISTINCT u.user_id) AS avg_events_per_user\nFROM users AS u\nLEFT JOIN events AS e ON u.user_id = e.user_id\nGROUP BY u.plan;",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 423,
      "tokens_out": 66,
      "cost_usd": 0.00010305,
      "latency_ms": 1447.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_08",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3\n7\n8\n9\n11\n14\n19\n22\n28\n30\n34\n35\n36\n37\n39\n40\n41\n46\n47\n48\n51\n52\n55\n57\n58\n59\n60\n62\n63\n64\n65\n67\n70\n71\n72",
      "llm_sql": "SELECT DISTINCT\n    u.user_id\nFROM users AS u\nINNER JOIN events AS e ON u.user_id = e.user_id\nWHERE u.created_at >= '2024-01-01 00:00:00'\n  AND u.created_at <= '2024-12-31 23:59:59.999'\n  AND e.event_type = 'purchase'",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 426,
      "tokens_out": 112,
      "cost_usd": 0.0001311,
      "latency_ms": 2241.8
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_08",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3\n7\n8\n9\n11\n14\n19\n22\n28\n30\n34\n35\n36\n37\n39\n40\n41\n46\n47\n48\n51\n52\n55\n57\n58\n59\n60\n62\n63\n64\n65\n67\n70\n71\n72",
      "llm_sql": "SELECT DISTINCT\n    u.user_id\nFROM users AS u\nINNER JOIN events AS e ON u.user_id = e.user_id\nWHERE u.created_at >= '2024-01-01 00:00:00'\n  AND u.created_at <= '2024-12-31 23:59:59.999'\n  AND e.event_type = 'purchase'",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 426,
      "tokens_out": 112,
      "cost_usd": 0.0001311,
      "latency_ms": 3683.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_08",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3\n7\n8\n9\n11\n14\n19\n22\n28\n30\n34\n35\n36\n37\n39\n40\n41\n46\n47\n48\n51\n52\n55\n57\n58\n59\n60\n62\n63\n64\n65\n67\n70\n71\n72",
      "llm_sql": "SELECT DISTINCT\n    u.user_id\nFROM users AS u\nINNER JOIN events AS e ON u.user_id = e.user_id\nWHERE u.created_at >= '2024-01-01 00:00:00'\n  AND u.created_at <= '2024-12-31 23:59:59.999'\n  AND e.event_type = 'purchase'",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 426,
      "tokens_out": 112,
      "cost_usd": 0.0001311,
      "latency_ms": 1868.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_09",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: JP",
      "llm_sql": "SELECT country\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY count() DESC\nLIMIT 1;",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 421,
      "tokens_out": 27,
      "cost_usd": 7.934999999999999e-05,
      "latency_ms": 1882.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_09",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: JP",
      "llm_sql": "SELECT country\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY count() DESC\nLIMIT 1;",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 421,
      "tokens_out": 27,
      "cost_usd": 7.934999999999999e-05,
      "latency_ms": 1437.3
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_09",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: JP",
      "llm_sql": "SELECT country\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY count() DESC\nLIMIT 1;",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 423,
      "tokens_out": 27,
      "cost_usd": 7.965e-05,
      "latency_ms": 1444.8
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_10",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: tablet\t5365\nmobile\t6726\ndesktop\t8569",
      "llm_sql": "SELECT\n    device,\n    user_id\nFROM\n(\n    SELECT\n        device,\n        user_id,\n        count() AS event_count,\n        row_number() OVER (PARTITION BY device ORDER BY event_count DESC) AS rank\n    FROM events\n    GROUP BY\n        device,\n        user_id\n)\nWHERE rank = 1;",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 420,
      "tokens_out": 83,
      "cost_usd": 0.00011279999999999999,
      "latency_ms": 2656.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_10",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\ntablet\t5365\nmobile\t6726",
      "llm_sql": "SELECT\n    device,\n    user_id\nFROM\n(\n    SELECT\n        device,\n        user_id,\n        count() AS event_count,\n        row_number() OVER (PARTITION BY device ORDER BY event_count DESC) AS rank\n    FROM events\n    GROUP BY\n        device,\n        user_id\n)\nWHERE rank = 1;",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 422,
      "tokens_out": 83,
      "cost_usd": 0.0001131,
      "latency_ms": 1640.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t4_10",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: mobile\t6726\ntablet\t5365\ndesktop\t8569",
      "llm_sql": "SELECT\n    device,\n    user_id\nFROM\n(\n    SELECT\n        device,\n        user_id,\n        count() AS event_count,\n        row_number() OVER (PARTITION BY device ORDER BY event_count DESC) AS rank\n    FROM events\n    GROUP BY\n        device,\n        user_id\n)\nWHERE rank = 1;",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 422,
      "tokens_out": 83,
      "cost_usd": 0.0001131,
      "latency_ms": 1569.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_01",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 180952\t2024-01-03 15:25:22.000\t3\tpageview\t/blog\t5553\t{'source':'facebook'}\t[]\tJP\tdesktop\t\\N\t1\n542318",
      "llm_sql": "SELECT\n    *,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp ASC) AS event_seq_num\nFROM events;",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 422,
      "tokens_out": 33,
      "cost_usd": 8.31e-05,
      "latency_ms": 1497.0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_01",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 660553\t2024-01-04 06:16:05.000\t11\tpurchase\t/blog\t7374\t{'source':'facebook'}\t[]\tAU\tmobile\t\\N\t1\n130331",
      "llm_sql": "SELECT\n    *,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp ASC) AS event_seq_num\nFROM events;",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 422,
      "tokens_out": 33,
      "cost_usd": 8.31e-05,
      "latency_ms": 1838.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_01",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 276842\t2024-02-24 21:54:05.000\t8169\tpageview\t/pricing\t\\N\t{'source':'direct'}\t[]\tFR\tdesktop\t\\N\t12\n891",
      "llm_sql": "SELECT\n    *,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp ASC) AS event_seq_num\nFROM events;",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 422,
      "tokens_out": 33,
      "cost_usd": 8.31e-05,
      "latency_ms": 2558.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_02",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01 00:00:00\t2811\t2811\n2024-01-02 00:00:00\t2762\t5573\n2024-01-03 00:00:00\t2775\t8348\n2024-01-04",
      "llm_sql": "SELECT\n    toStartOfDay(timestamp) AS day,\n    count() AS daily_count,\n    sum(daily_count) OVER (ORDER BY day ASC) AS running_total\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' AND timestamp <= '2024-12-31 23:59:59'\nGROUP BY day\nORDER BY day ASC;",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 422,
      "tokens_out": 102,
      "cost_usd": 0.0001245,
      "latency_ms": 7429.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_02",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01 00:00:00\t2811\t2811\n2024-01-02 00:00:00\t2762\t5573\n2024-01-03 00:00:00\t2775\t8348\n2024-01-04",
      "llm_sql": "SELECT\n    toStartOfDay(timestamp) AS day,\n    count() AS daily_events,\n    sum(count()) OVER (ORDER BY toStartOfDay(timestamp)) AS running_total\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' AND timestamp <= '2024-12-31 23:59:59'\nGROUP BY day\nORDER BY day;",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 424,
      "tokens_out": 107,
      "cost_usd": 0.0001278,
      "latency_ms": 1733.3
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_02",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01 00:00:00\t2811\t2811\n2024-01-02 00:00:00\t2762\t5573\n2024-01-03 00:00:00\t2775\t8348\n2024-01-04",
      "llm_sql": "SELECT\n    toStartOfDay(timestamp) AS day,\n    count() AS daily_count,\n    sum(daily_count) OVER (ORDER BY day ASC) AS running_total\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' AND timestamp <= '2024-12-31 23:59:59'\nGROUP BY day\nORDER BY day ASC;",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 422,
      "tokens_out": 102,
      "cost_usd": 0.0001245,
      "latency_ms": 1853.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_03",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count,\n    lagInFrame(count()) OVER (ORDER BY toDate(timestamp) ASC) AS previous_day_event_count\nFROM events\nGROUP BY day\nORDER BY day ASC;",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 428,
      "tokens_out": 64,
      "cost_usd": 0.0001026,
      "latency_ms": 1636.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_03",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count,\n    lagInFrame(count()) OVER (ORDER BY toDate(timestamp) ASC) AS previous_day_event_count\nFROM events\nGROUP BY day\nORDER BY day ASC;",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 428,
      "tokens_out": 64,
      "cost_usd": 0.0001026,
      "latency_ms": 1511.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_03",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count,\n    lagInFrame(count()) OVER (ORDER BY toDate(timestamp) ASC) AS previous_day_event_count\nFROM events\nGROUP BY day\nORDER BY day ASC;",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 428,
      "tokens_out": 64,
      "cost_usd": 0.0001026,
      "latency_ms": 1718.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_04",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: ['MOBILE']\n[]\n[]\n[]\n[]\n[]\n['PROMO']\n['PROMO','MOBILE']\n[]\n[]\n['PREMIUM_USER']\n['MOBILE','NEW']\n[]\n[]",
      "llm_sql": "SELECT arrayMap(x -> upper(x), tags) FROM events;",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 422,
      "tokens_out": 15,
      "cost_usd": 7.23e-05,
      "latency_ms": 2008.6
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_04",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: ['MOBILE']\n[]\n['PROMO']\n[]\n['MOBILE']\n[]\n[]\n[]\n[]\n[]\n[]\n['VIP_MEMBER','MOBILE']\n[]\n['MOBILE']\n['NEW'",
      "llm_sql": "SELECT arrayMap(x -> upper(x), tags) FROM events;",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 420,
      "tokens_out": 15,
      "cost_usd": 7.2e-05,
      "latency_ms": 1852.8
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_04",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: ['MOBILE']\n[]\n[]\n[]\n[]\n[]\n['PROMO']\n['PROMO','MOBILE']\n[]\n[]\n['PREMIUM_USER']\n['MOBILE','NEW']\n[]\n[]",
      "llm_sql": "SELECT arrayMap(x -> upper(x), tags) FROM events;",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 422,
      "tokens_out": 15,
      "cost_usd": 7.23e-05,
      "latency_ms": 1376.6
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_05",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: logout\t3812\nsignup\t8908\npurchase\t7125\npageview\t2833\nclick\t1371",
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration) AS user_with_longest_duration\nFROM (\n    SELECT\n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    GROUP BY\n        event_type,\n        user_id\n)\nGROUP BY event_type;",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 428,
      "tokens_out": 91,
      "cost_usd": 0.00011880000000000001,
      "latency_ms": 1864.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_05",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: logout\t3812\nsignup\t8908\npurchase\t7125\nclick\t1371\npageview\t2833",
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration) AS user_with_longest_duration\nFROM (\n    SELECT\n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    GROUP BY\n        event_type,\n        user_id\n)\nGROUP BY event_type;",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 428,
      "tokens_out": 91,
      "cost_usd": 0.00011880000000000001,
      "latency_ms": 1902.3
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_05",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: logout\t3812\nsignup\t8908\npurchase\t7125\npageview\t2833\nclick\t1371",
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration) AS user_with_longest_duration\nFROM\n(\n    SELECT\n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    GROUP BY\n        event_type,\n        user_id\n)\nGROUP BY event_type;",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 426,
      "tokens_out": 87,
      "cost_usd": 0.00011609999999999999,
      "latency_ms": 2115.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_06",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' AND timestamp < '2024-02-01 00:00:00'\nGROUP BY day\nORDER BY day ASC WITH FILL FROM toDate('2024-01-01') TO toDate('2024-02-01') STEP 1;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 428,
      "tokens_out": 115,
      "cost_usd": 0.00013319999999999999,
      "latency_ms": 1983.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_06",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' AND timestamp < '2024-02-01 00:00:00'\nGROUP BY day\nORDER BY day ASC WITH FILL FROM toDate('2024-01-01') TO toDate('2024-02-01') STEP 1;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 428,
      "tokens_out": 115,
      "cost_usd": 0.00013319999999999999,
      "latency_ms": 2520.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_06",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01 00:00:00' AND timestamp < '2024-02-01 00:00:00'\nGROUP BY day\nORDER BY day ASC WITH FILL FROM toDate('2024-01-01') TO toDate('2024-02-01') STEP 1;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 428,
      "tokens_out": 115,
      "cost_usd": 0.00013319999999999999,
      "latency_ms": 2418.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_07",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1978\t['click','click','click','click','click','click','click','click','click','click','click','click",
      "llm_sql": "SELECT\n    user_id,\n    arraySort(groupArray(event_type)) AS event_types\nFROM events\nGROUP BY user_id;",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 421,
      "tokens_out": 33,
      "cost_usd": 8.295e-05,
      "latency_ms": 1491.2
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_07",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3699\t['click','click','click','click','click','click','click','click','click','click','click','click",
      "llm_sql": "SELECT\n    user_id,\n    arraySort(groupArray(event_type)) AS event_types\nFROM events\nGROUP BY user_id;",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 421,
      "tokens_out": 33,
      "cost_usd": 8.295e-05,
      "latency_ms": 1467.7
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_07",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t['click','click','click','click','click','click','click','click','click','click','click','click",
      "llm_sql": "SELECT\n    user_id,\n    arraySort(groupArray(event_type)) AS event_types\nFROM events\nGROUP BY user_id;",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 421,
      "tokens_out": 33,
      "cost_usd": 8.295e-05,
      "latency_ms": 1853.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_08",
      "tier": 5,
      "run": 1,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 184. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function max(timestamp) AS timestamp is found inside another aggregat",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS event_id,\n    max(timestamp) AS timestamp,\n    argMax(event_type, timestamp) AS event_type,\n    argMax(page, timestamp) AS page,\n    argMax(duration_ms, timestamp) AS duration_ms,\n    argMax(properties, timestamp) AS properties,\n    argMax(tags, timestamp) AS tags,\n    argMax(country, timestamp) AS country,\n    argMax(device, timestamp) AS device,\n    argMax(revenue_cents, timestamp) AS revenue_cents\nFROM events\nGROUP BY user_id;",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 420,
      "tokens_out": 154,
      "cost_usd": 0.00015539999999999998,
      "latency_ms": 1908.0
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_08",
      "tier": 5,
      "run": 2,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 184. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function max(timestamp) AS timestamp is found inside another aggregat",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS event_id,\n    max(timestamp) AS timestamp,\n    argMax(event_type, timestamp) AS event_type,\n    argMax(page, timestamp) AS page,\n    argMax(duration_ms, timestamp) AS duration_ms,\n    argMax(properties, timestamp) AS properties,\n    argMax(tags, timestamp) AS tags,\n    argMax(country, timestamp) AS country,\n    argMax(device, timestamp) AS device,\n    argMax(revenue_cents, timestamp) AS revenue_cents\nFROM events\nGROUP BY user_id;",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 418,
      "tokens_out": 149,
      "cost_usd": 0.00015209999999999998,
      "latency_ms": 2103.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_08",
      "tier": 5,
      "run": 3,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 184. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function max(timestamp) AS timestamp is found inside another aggregat",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS event_id,\n    max(timestamp) AS timestamp,\n    argMax(event_type, timestamp) AS event_type,\n    argMax(page, timestamp) AS page,\n    argMax(duration_ms, timestamp) AS duration_ms,\n    argMax(properties, timestamp) AS properties,\n    argMax(tags, timestamp) AS tags,\n    argMax(country, timestamp) AS country,\n    argMax(device, timestamp) AS device,\n    argMax(revenue_cents, timestamp) AS revenue_cents\nFROM events\nGROUP BY user_id;",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 418,
      "tokens_out": 149,
      "cost_usd": 0.00015209999999999998,
      "latency_ms": 4659.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_09",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    h.hour AS event_hour,\n    count(e.event_id) AS event_count\nFROM (\n    SELECT toStartOfHour(toDateTime64('2024-06-15 00:00:00', 3, 'UTC') + number * 3600) AS hour\n    FROM numbers(24)\n) AS h\nLEFT JOIN events AS e ON toStartOfHour(e.timestamp) = h.hour\n    AND e.timestamp >= '2024-06-15 00:00:00'\n    AND e.timestamp < '2024-06-16 00:00:00'\nGROUP BY event_hour\nORDER BY event_hour;",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 437,
      "tokens_out": 184,
      "cost_usd": 0.00017595,
      "latency_ms": 2781.6
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_09",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    h.hour AS event_hour,\n    count(e.event_id) AS event_count\nFROM (\n    SELECT toStartOfHour(toDateTime64('2024-06-15 00:00:00', 3, 'UTC') + number * 3600) AS hour\n    FROM numbers(24)\n) AS h\nLEFT JOIN events AS e ON toStartOfHour(e.timestamp) = h.hour\n    AND e.timestamp >= '2024-06-15 00:00:00'\n    AND e.timestamp < '2024-06-16 00:00:00'\nGROUP BY event_hour\nORDER BY event_hour;",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 437,
      "tokens_out": 184,
      "cost_usd": 0.00017595,
      "latency_ms": 2478.5
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_09",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    h.hour AS event_hour,\n    count(e.event_id) AS event_count\nFROM (\n    SELECT toStartOfHour(toDateTime64('2024-06-15 00:00:00', 3, 'UTC') + number * 3600) AS hour\n    FROM numbers(24)\n) AS h\nLEFT JOIN events AS e ON toStartOfHour(e.timestamp) = h.hour\n    AND e.timestamp >= '2024-06-15 00:00:00'\n    AND e.timestamp < '2024-06-16 00:00:00'\nGROUP BY event_hour\nORDER BY event_hour;",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 437,
      "tokens_out": 184,
      "cost_usd": 0.00017595,
      "latency_ms": 2204.9
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_10",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t['premium_user']\n9529\t['premium_user']\n6122\t['premium_user']\n5600\t['premium_user']\n1105\t['premi",
      "llm_sql": "SELECT\n    user_id,\n    arrayDistinct(arrayFilter(x -> x LIKE '%premium%', arrayFlatten(groupArray(tags)))) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING NOT empty(premium_tags)",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 436,
      "tokens_out": 58,
      "cost_usd": 0.00010019999999999998,
      "latency_ms": 2164.1
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_10",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3699\t['premium_user']\n8130\t['premium_user']\n3193\t['premium_user']\n7624\t['premium_user']\n7126\t['premi",
      "llm_sql": "SELECT\n    user_id,\n    arrayDistinct(arrayFilter(x -> x LIKE '%premium%', arrayFlatten(groupArray(tags)))) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING NOT empty(premium_tags)",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 436,
      "tokens_out": 58,
      "cost_usd": 0.00010019999999999998,
      "latency_ms": 1965.4
    },
    {
      "model": "gemini-3-flash",
      "question_id": "t5_10",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 4450\t['premium_user']\n3986\t['premium_user']\n7715\t['premium_user']\n3480\t['premium_user']\n7209\t['premi",
      "llm_sql": "SELECT\n    user_id,\n    arrayDistinct(arrayFilter(x -> x LIKE '%premium%', arrayFlatten(groupArray(tags)))) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING NOT empty(premium_tags)",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 436,
      "tokens_out": 58,
      "cost_usd": 0.00010019999999999998,
      "latency_ms": 1821.7
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_01",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS event_count\nFROM events;",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 362,
      "tokens_out": 14,
      "cost_usd": 0.000836,
      "latency_ms": 542
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_01",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS event_count\nFROM events;",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 362,
      "tokens_out": 14,
      "cost_usd": 0.000836,
      "latency_ms": 510
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_01",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS event_count\nFROM events;",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 362,
      "tokens_out": 14,
      "cost_usd": 0.000836,
      "latency_ms": 525
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_02",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nORDER BY timestamp DESC, event_id DESC\nLIMIT 10;",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 361,
      "tokens_out": 61,
      "cost_usd": 0.00121,
      "latency_ms": 533
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_02",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nORDER BY timestamp DESC, event_id DESC\nLIMIT 10;",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 361,
      "tokens_out": 61,
      "cost_usd": 0.00121,
      "latency_ms": 753
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_02",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nORDER BY timestamp DESC, event_id DESC\nLIMIT 10;",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 361,
      "tokens_out": 61,
      "cost_usd": 0.00121,
      "latency_ms": 512
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_03",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS events_in_march_2024\nFROM events\nWHERE timestamp >= toDateTime64('2024-03-01 00:00:00', 3, 'UTC')\n  AND timestamp <  toDateTime64('2024-04-01 00:00:00', 3, 'UTC');",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 363,
      "tokens_out": 75,
      "cost_usd": 0.001326,
      "latency_ms": 1725
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_03",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS events_count\nFROM events\nWHERE timestamp >= toDateTime64('2024-03-01 00:00:00', 3, 'UTC')\n  AND timestamp <  toDateTime64('2024-04-01 00:00:00', 3, 'UTC');",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 363,
      "tokens_out": 70,
      "cost_usd": 0.001286,
      "latency_ms": 604
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_03",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS events_in_march_2024\nFROM events\nWHERE timestamp >= toDateTime64('2024-03-01 00:00:00', 3, 'UTC')\n  AND timestamp <  toDateTime64('2024-04-01 00:00:00', 3, 'UTC');",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 363,
      "tokens_out": 75,
      "cost_usd": 0.001326,
      "latency_ms": 704
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_04",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type\nFROM events\nORDER BY event_type;",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 359,
      "tokens_out": 17,
      "cost_usd": 0.000854,
      "latency_ms": 593
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_04",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type\nFROM events;",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 359,
      "tokens_out": 12,
      "cost_usd": 0.000814,
      "latency_ms": 564
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_04",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type\nFROM events\nORDER BY event_type;",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 359,
      "tokens_out": 17,
      "cost_usd": 0.000854,
      "latency_ms": 521
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_05",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS events_from_germany\nFROM events\nWHERE country = 'DE';",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 360,
      "tokens_out": 22,
      "cost_usd": 0.000896,
      "latency_ms": 576
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_05",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS events_from_germany\nFROM events\nWHERE country = 'DE';",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 360,
      "tokens_out": 22,
      "cost_usd": 0.000896,
      "latency_ms": 546
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_05",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS events_from_germany\nFROM events\nWHERE country = 'DE';",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 360,
      "tokens_out": 22,
      "cost_usd": 0.000896,
      "latency_ms": 570
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_06",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 5;",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 368,
      "tokens_out": 64,
      "cost_usd": 0.001248,
      "latency_ms": 521
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_06",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 5;",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 368,
      "tokens_out": 64,
      "cost_usd": 0.001248,
      "latency_ms": 541
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_06",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 5;",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 368,
      "tokens_out": 64,
      "cost_usd": 0.001248,
      "latency_ms": 487
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_07",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS pro_users\nFROM users\nWHERE plan = 'pro';",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 364,
      "tokens_out": 20,
      "cost_usd": 0.000888,
      "latency_ms": 506
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_07",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS pro_users\nFROM users\nWHERE plan = 'pro';",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 364,
      "tokens_out": 20,
      "cost_usd": 0.000888,
      "latency_ms": 542
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_07",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS pro_users\nFROM users\nWHERE plan = 'pro';",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 364,
      "tokens_out": 20,
      "cost_usd": 0.000888,
      "latency_ms": 603
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_08",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    min(timestamp) AS earliest_event_timestamp,\n    max(timestamp) AS latest_event_timestamp\nFROM events;",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 362,
      "tokens_out": 27,
      "cost_usd": 0.00094,
      "latency_ms": 552
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_08",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    min(timestamp) AS earliest_event_timestamp,\n    max(timestamp) AS latest_event_timestamp\nFROM events;",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 362,
      "tokens_out": 27,
      "cost_usd": 0.00094,
      "latency_ms": 685
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_08",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    min(timestamp) AS earliest_event_timestamp,\n    max(timestamp) AS latest_event_timestamp\nFROM events;",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 362,
      "tokens_out": 27,
      "cost_usd": 0.00094,
      "latency_ms": 505
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_09",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nWHERE\n    user_id = 42\n    AND timestamp >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n    AND timestamp <  toDateTime64('2025-01-01 00:00:00', 3, 'UTC')\nORDER BY timestamp, event_id;",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 366,
      "tokens_out": 121,
      "cost_usd": 0.0017,
      "latency_ms": 517
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_09",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nWHERE user_id = 42\n  AND timestamp >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n  AND timestamp <  toDateTime64('2025-01-01 00:00:00', 3, 'UTC')\nORDER BY timestamp, event_id;",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 366,
      "tokens_out": 119,
      "cost_usd": 0.001684,
      "latency_ms": 584
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_09",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nWHERE user_id = 42\n  AND timestamp >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n  AND timestamp <  toDateTime64('2025-01-01 00:00:00', 3, 'UTC')\nORDER BY timestamp, event_id;",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 366,
      "tokens_out": 119,
      "cost_usd": 0.001684,
      "latency_ms": 640
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_10",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE duration_ms IS NOT NULL;",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 363,
      "tokens_out": 17,
      "cost_usd": 0.000862,
      "latency_ms": 593
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_10",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS events_with_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL;",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 363,
      "tokens_out": 23,
      "cost_usd": 0.00091,
      "latency_ms": 540
    },
    {
      "model": "gpt-5.2",
      "question_id": "t1_10",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE duration_ms IS NOT NULL;",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 363,
      "tokens_out": 17,
      "cost_usd": 0.000862,
      "latency_ms": 549
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_01",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    count() AS event_count\nFROM events\nGROUP BY event_type\nORDER BY event_count DESC;",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 365,
      "tokens_out": 31,
      "cost_usd": 0.000978,
      "latency_ms": 596
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_01",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    count() AS events_count\nFROM events\nGROUP BY event_type\nORDER BY events_count DESC;",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 365,
      "tokens_out": 31,
      "cost_usd": 0.000978,
      "latency_ms": 555
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_01",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    count() AS event_count\nFROM events\nGROUP BY event_type\nORDER BY event_count DESC;",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 365,
      "tokens_out": 31,
      "cost_usd": 0.000978,
      "latency_ms": 681
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_02",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    device,\n    avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY device;",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 363,
      "tokens_out": 37,
      "cost_usd": 0.001022,
      "latency_ms": 638
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_02",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    device,\n    avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY device;",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 363,
      "tokens_out": 37,
      "cost_usd": 0.001022,
      "latency_ms": 567
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_02",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    device,\n    avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY device;",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 363,
      "tokens_out": 37,
      "cost_usd": 0.001022,
      "latency_ms": 546
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_03",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS events\nFROM events\nWHERE timestamp >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n  AND timestamp <  toDateTime64('2024-02-01 00:00:00', 3, 'UTC')\nGROUP BY day\nORDER BY day;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 366,
      "tokens_out": 87,
      "cost_usd": 0.001428,
      "latency_ms": 546
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_03",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS events\nFROM events\nWHERE timestamp >= toDateTime('2024-01-01 00:00:00', 'UTC')\n  AND timestamp <  toDateTime('2024-02-01 00:00:00', 'UTC')\nGROUP BY day\nORDER BY day;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 366,
      "tokens_out": 79,
      "cost_usd": 0.001364,
      "latency_ms": 513
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_03",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS events\nFROM events\nWHERE timestamp >= toDateTime('2024-01-01 00:00:00', 'UTC')\n  AND timestamp <  toDateTime('2024-02-01 00:00:00', 'UTC')\nGROUP BY day\nORDER BY day;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 366,
      "tokens_out": 79,
      "cost_usd": 0.001364,
      "latency_ms": 570
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_04",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    country,\n    count() AS event_count\nFROM events\nGROUP BY country\nHAVING event_count > 10000\nORDER BY event_count DESC;",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 363,
      "tokens_out": 38,
      "cost_usd": 0.00103,
      "latency_ms": 559
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_04",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    country,\n    count() AS event_count\nFROM events\nGROUP BY country\nHAVING event_count > 10000\nORDER BY event_count DESC;",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 363,
      "tokens_out": 38,
      "cost_usd": 0.00103,
      "latency_ms": 535
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_04",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    country,\n    count() AS event_count\nFROM events\nGROUP BY country\nHAVING event_count > 10000\nORDER BY event_count DESC;",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 363,
      "tokens_out": 38,
      "cost_usd": 0.00103,
      "latency_ms": 511
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_05",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toHour(timestamp) AS hour_of_day,\n    count() AS events\nFROM events\nGROUP BY hour_of_day\nORDER BY hour_of_day;",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 364,
      "tokens_out": 37,
      "cost_usd": 0.001024,
      "latency_ms": 553
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_05",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toHour(timestamp) AS hour_of_day,\n    count() AS event_count\nFROM events\nGROUP BY hour_of_day\nORDER BY hour_of_day;",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 364,
      "tokens_out": 38,
      "cost_usd": 0.001032,
      "latency_ms": 590
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_05",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toHour(timestamp) AS hour_of_day,\n    count() AS event_count\nFROM events\nGROUP BY hour_of_day\nORDER BY hour_of_day;",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 364,
      "tokens_out": 38,
      "cost_usd": 0.001032,
      "latency_ms": 527
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_06",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE event_type = 'pageview';",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 367,
      "tokens_out": 25,
      "cost_usd": 0.000934,
      "latency_ms": 489
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_06",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE event_type = 'pageview';",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 367,
      "tokens_out": 25,
      "cost_usd": 0.000934,
      "latency_ms": 558
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_06",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE event_type = 'pageview';",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 367,
      "tokens_out": 25,
      "cost_usd": 0.000934,
      "latency_ms": 1210
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_07",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toStartOfMonth(timestamp) AS month,\n    count() AS events\nFROM events\nWHERE timestamp >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n  AND timestamp <  toDateTime64('2025-01-01 00:00:00', 3, 'UTC')\nGROUP BY month\nORDER BY month;",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 363,
      "tokens_out": 89,
      "cost_usd": 0.001438,
      "latency_ms": 517
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_07",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toStartOfMonth(timestamp) AS month,\n    count() AS events\nFROM events\nWHERE timestamp >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n  AND timestamp <  toDateTime64('2025-01-01 00:00:00', 3, 'UTC')\nGROUP BY month\nORDER BY month;",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 363,
      "tokens_out": 89,
      "cost_usd": 0.001438,
      "latency_ms": 564
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_07",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toStartOfMonth(timestamp) AS month,\n    count() AS events\nFROM events\nWHERE timestamp >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n  AND timestamp <  toDateTime64('2025-01-01 00:00:00', 3, 'UTC')\nGROUP BY month\nORDER BY month;",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 363,
      "tokens_out": 89,
      "cost_usd": 0.001438,
      "latency_ms": 516
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_08",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    uniqExact(country) AS distinct_countries\nFROM events\nGROUP BY event_type\nORDER BY event_type;",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 365,
      "tokens_out": 33,
      "cost_usd": 0.000994,
      "latency_ms": 526
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_08",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    uniqExact(country) AS distinct_countries\nFROM events\nGROUP BY event_type\nORDER BY event_type;",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 365,
      "tokens_out": 33,
      "cost_usd": 0.000994,
      "latency_ms": 641
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_08",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    countDistinct(country) AS distinct_countries\nFROM events\nGROUP BY event_type\nORDER BY event_type;",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 365,
      "tokens_out": 33,
      "cost_usd": 0.000994,
      "latency_ms": 607
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_09",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    country,\n    sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC;",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 367,
      "tokens_out": 47,
      "cost_usd": 0.00111,
      "latency_ms": 545
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_09",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    country,\n    sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC;",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 367,
      "tokens_out": 47,
      "cost_usd": 0.00111,
      "latency_ms": 542
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_09",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    country,\n    sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC;",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 367,
      "tokens_out": 47,
      "cost_usd": 0.00111,
      "latency_ms": 530
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_10",
      "tier": 2,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: pageview\t200001\npurchase\t200181",
      "llm_sql": "SELECT\n    event_type,\n    count() AS event_count\nFROM events\nWHERE event_type IN ('purchase', 'pageview')\nGROUP BY event_type\nORDER BY event_type;",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 367,
      "tokens_out": 41,
      "cost_usd": 0.001062,
      "latency_ms": 536
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_10",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    countIf(event_type = 'purchase') AS purchase_events,\n    countIf(event_type = 'pageview') AS pageview_events\nFROM events;",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 367,
      "tokens_out": 37,
      "cost_usd": 0.00103,
      "latency_ms": 563
    },
    {
      "model": "gpt-5.2",
      "question_id": "t2_10",
      "tier": 2,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: purchase\t200181\npageview\t200001",
      "llm_sql": "SELECT\n    event_type,\n    count() AS event_count\nFROM events\nWHERE event_type IN ('purchase', 'pageview')\nGROUP BY event_type;",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 367,
      "tokens_out": 36,
      "cost_usd": 0.001022,
      "latency_ms": 596
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_01",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 5046",
      "llm_sql": "SELECT medianExactIf(toFloat64(duration_ms), duration_ms IS NOT NULL) AS median_duration_ms\nFROM events;",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 363,
      "tokens_out": 28,
      "cost_usd": 0.00095,
      "latency_ms": 557
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_01",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 5046",
      "llm_sql": "SELECT medianExact(duration_ms) AS median_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL;",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 363,
      "tokens_out": 25,
      "cost_usd": 0.000926,
      "latency_ms": 553
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_01",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 5046",
      "llm_sql": "SELECT quantileExact(0.5)(duration_ms) AS median_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL;",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 363,
      "tokens_out": 31,
      "cost_usd": 0.000974,
      "latency_ms": 559
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_02",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT countDistinct(user_id) AS exact_distinct_users\nFROM events;",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 365,
      "tokens_out": 19,
      "cost_usd": 0.000882,
      "latency_ms": 536
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_02",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT uniqExact(user_id) AS exact_distinct_users\nFROM events;",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 365,
      "tokens_out": 19,
      "cost_usd": 0.000882,
      "latency_ms": 542
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_02",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT countDistinct(user_id) AS exact_distinct_users\nFROM events;",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 365,
      "tokens_out": 19,
      "cost_usd": 0.000882,
      "latency_ms": 533
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_03",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 879939\t2024-12-01 00:06:12.000\t3613\tpageview\t/settings\t5267\t{'campaign':'summer_sale','source':'twit",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nWHERE mapContains(properties, 'campaign');",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 366,
      "tokens_out": 56,
      "cost_usd": 0.00118,
      "latency_ms": 644
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_03",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 322580\t2024-09-01 00:01:24.000\t2253\tsignup\t/blog\t2583\t{'campaign':'black_friday','source':'twitter'}",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nWHERE mapContains(properties, 'campaign');",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 366,
      "tokens_out": 56,
      "cost_usd": 0.00118,
      "latency_ms": 525
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_03",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 710692\t2024-11-01 00:03:27.000\t2732\tpurchase\t/home\t\\N\t{'campaign':'spring_promo','source':'google'}\t",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nWHERE mapContains(properties, 'campaign');",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 366,
      "tokens_out": 56,
      "cost_usd": 0.00118,
      "latency_ms": 851
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_04",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC, event_id ASC\nLIMIT 10;",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 374,
      "tokens_out": 35,
      "cost_usd": 0.001028,
      "latency_ms": 753
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_04",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp, event_id\nLIMIT 10;",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 374,
      "tokens_out": 33,
      "cost_usd": 0.001012,
      "latency_ms": 606
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_04",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC, event_id ASC\nLIMIT 10;",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 374,
      "tokens_out": 35,
      "cost_usd": 0.001028,
      "latency_ms": 686
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_05",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    tag,\n    count() AS occurrences\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY occurrences DESC, tag ASC;",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 373,
      "tokens_out": 36,
      "cost_usd": 0.001034,
      "latency_ms": 508
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_05",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    tag,\n    count() AS occurrences\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY occurrences DESC, tag ASC;",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 373,
      "tokens_out": 36,
      "cost_usd": 0.001034,
      "latency_ms": 539
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_05",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    tag,\n    count() AS occurrences\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY occurrences DESC, tag ASC;",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 373,
      "tokens_out": 36,
      "cost_usd": 0.001034,
      "latency_ms": 636
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_06",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 514447\t2024-07-01 00:01:18.000\t7003\tpurchase\t/dashboard\t4455\t{'source':'twitter'}\t['promo','mobile']",
      "llm_sql": "SELECT\n    *\nFROM events\nWHERE has(tags, 'promo');",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 367,
      "tokens_out": 18,
      "cost_usd": 0.000878,
      "latency_ms": 506
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_06",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 368743\t2024-09-01 00:00:25.000\t3202\tsignup\t/blog\t8419\t{'source':'direct'}\t['promo']\tUS\tdesktop\t\\N\n88",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nWHERE has(tags, 'promo');",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 367,
      "tokens_out": 55,
      "cost_usd": 0.001174,
      "latency_ms": 548
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_06",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 143654\t2024-03-01 00:11:19.000\t291\tsignup\t/docs\t2910\t{'source':'facebook'}\t['promo','mobile']\tDE\tmob",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nWHERE has(tags, 'promo');",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 367,
      "tokens_out": 55,
      "cost_usd": 0.001174,
      "latency_ms": 560
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_07",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: click\t8996\t9901\nlogout\t9010\t9900\npageview\t9012\t9901\npurchase\t9007\t9903\nsignup\t9018\t9903",
      "llm_sql": "SELECT\n    event_type,\n    quantileExactIf(0.90)(duration_ms, duration_ms IS NOT NULL) AS p90_duration_ms,\n    quantileExactIf(0.99)(duration_ms, duration_ms IS NOT NULL) AS p99_duration_ms\nFROM events\nGROUP BY event_type\nORDER BY event_type;",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 369,
      "tokens_out": 73,
      "cost_usd": 0.001322,
      "latency_ms": 324
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_07",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: click\t8995.329\t9900.977\nlogout\t9008.941\t9899.814\npageview\t9012.204\t9900.815\npurchase\t9006.174\t9902.7",
      "llm_sql": "SELECT\n    event_type,\n    quantileTDigest(0.90)(toFloat64(duration_ms)) AS p90_duration_ms,\n    quantileTDigest(0.99)(toFloat64(duration_ms)) AS p99_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type;",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 369,
      "tokens_out": 74,
      "cost_usd": 0.00133,
      "latency_ms": 612
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_07",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: click\t8996\t9901\nlogout\t9010\t9900\npageview\t9012\t9901\npurchase\t9007\t9903\nsignup\t9018\t9903",
      "llm_sql": "SELECT\n    event_type,\n    quantileExactIf(0.90)(duration_ms, duration_ms IS NOT NULL) AS p90_duration_ms,\n    quantileExactIf(0.99)(duration_ms, duration_ms IS NOT NULL) AS p99_duration_ms\nFROM events\nGROUP BY event_type\nORDER BY event_type;",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 369,
      "tokens_out": 73,
      "cost_usd": 0.001322,
      "latency_ms": 627
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_08",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS revenue_cents_mobile\nFROM events;",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 370,
      "tokens_out": 26,
      "cost_usd": 0.000948,
      "latency_ms": 564
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_08",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue_cents\nFROM events;",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 370,
      "tokens_out": 27,
      "cost_usd": 0.000956,
      "latency_ms": 1423
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_08",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    sumIf(revenue_cents, device = 'mobile') AS revenue_cents_mobile\nFROM events;",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 370,
      "tokens_out": 28,
      "cost_usd": 0.000964,
      "latency_ms": 643
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_09",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: ['campaign','source']\n['source']",
      "llm_sql": "SELECT DISTINCT mapKeys(properties) AS property_key\nFROM events\nARRAY JOIN mapKeys(properties) AS property_key\nORDER BY property_key;",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 367,
      "tokens_out": 32,
      "cost_usd": 0.00099,
      "latency_ms": 571
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_09",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: ['campaign','source']\n['source']",
      "llm_sql": "SELECT DISTINCT mapKeys(properties) AS property_key\nFROM events\nARRAY JOIN mapKeys(properties)\nORDER BY property_key;",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 367,
      "tokens_out": 28,
      "cost_usd": 0.000958,
      "latency_ms": 539
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_09",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT arrayJoin(mapKeys(properties)) AS property_key\nFROM events\nGROUP BY property_key\nORDER BY property_key ASC;",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 367,
      "tokens_out": 29,
      "cost_usd": 0.000966,
      "latency_ms": 512
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_10",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 78581\t2024-11-01 00:07:22.000\t7126\tpageview\t/dashboard\t\\N\t{'source':'email'}\t['vip_member','new']\tJP",
      "llm_sql": "SELECT\n    *\nFROM events\nWHERE arrayExists(tag -> startsWith(tag, 'vip'), tags);",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 371,
      "tokens_out": 25,
      "cost_usd": 0.000942,
      "latency_ms": 534
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_10",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 934864\t2024-09-01 00:03:37.000\t8365\tpurchase\t/about\t4405\t{'campaign':'black_friday','source':'twitte",
      "llm_sql": "SELECT\n    *\nFROM events\nWHERE arrayExists(t -> startsWith(t, 'vip'), tags);",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 371,
      "tokens_out": 25,
      "cost_usd": 0.000942,
      "latency_ms": 520
    },
    {
      "model": "gpt-5.2",
      "question_id": "t3_10",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 349664\t2024-12-01 00:01:56.000\t1508\tpageview\t/home\t\\N\t{'source':'google'}\t['vip_member']\tGB\ttablet\t\\",
      "llm_sql": "SELECT\n    *\nFROM events\nWHERE arrayExists(t -> startsWith(t, 'vip'), tags);",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 371,
      "tokens_out": 25,
      "cost_usd": 0.000942,
      "latency_ms": 536
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_01",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 139299\t2024-10-01 00:00:42.000\t7817\tclick\t/docs\t646\t{'source':'email'}\t['mobile']\tBR\tmobile\t7523\tent",
      "llm_sql": "SELECT\n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan AS user_plan\nFROM events AS e\nLEFT JOIN users AS u\n    ON e.user_id = u.user_id;",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 371,
      "tokens_out": 85,
      "cost_usd": 0.001422,
      "latency_ms": 522
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_01",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t/blog\t\\N\t{'source':'facebook'}\t[]\tBR\ttablet\t\\N\tpro\n774716",
      "llm_sql": "SELECT\n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events AS e\nINNER JOIN users AS u\n    ON e.user_id = u.user_id;",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 371,
      "tokens_out": 82,
      "cost_usd": 0.001398,
      "latency_ms": 549
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_01",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t/blog\t\\N\t{'source':'facebook'}\t[]\tBR\ttablet\t\\N\tpro\n774716",
      "llm_sql": "SELECT\n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events AS e\nLEFT JOIN users AS u\n    ON e.user_id = u.user_id;",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 371,
      "tokens_out": 82,
      "cost_usd": 0.001398,
      "latency_ms": 523
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_02",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count() AS events_count\nFROM events AS e\nINNER JOIN users AS u ON u.user_id = e.user_id\nGROUP BY u.plan\nORDER BY events_count DESC;",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 360,
      "tokens_out": 47,
      "cost_usd": 0.001096,
      "latency_ms": 534
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_02",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count() AS event_count\nFROM events AS e\nINNER JOIN users AS u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC;",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 360,
      "tokens_out": 47,
      "cost_usd": 0.001096,
      "latency_ms": 528
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_02",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    count() AS event_count\nFROM events AS e\nINNER JOIN users AS u ON u.user_id = e.user_id\nGROUP BY u.plan\nORDER BY event_count DESC;",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 360,
      "tokens_out": 47,
      "cost_usd": 0.001096,
      "latency_ms": 597
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_03",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id\nFROM users AS u\nLEFT JOIN\n(\n    SELECT DISTINCT user_id\n    FROM events\n) AS e USING (user_id)\nWHERE e.user_id IS NULL;",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 362,
      "tokens_out": 43,
      "cost_usd": 0.001068,
      "latency_ms": 598
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_03",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id\nFROM users AS u\nLEFT JOIN\n(\n    SELECT DISTINCT user_id\n    FROM events\n) AS e USING (user_id)\nWHERE e.user_id IS NULL;",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 362,
      "tokens_out": 43,
      "cost_usd": 0.001068,
      "latency_ms": 733
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_03",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.user_id\nFROM users AS u\nLEFT JOIN\n(\n    SELECT DISTINCT user_id\n    FROM events\n) AS e\nON u.user_id = e.user_id\nWHERE e.user_id IS NULL;",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 362,
      "tokens_out": 48,
      "cost_usd": 0.001108,
      "latency_ms": 575
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_04",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS\n(\n    SELECT\n        user_id,\n        count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT\n    tu.user_id,\n    tu.event_count,\n    u.plan\nFROM top_users AS tu\nLEFT JOIN users AS u USING (user_id)\nORDER BY tu.event_count DESC;",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 373,
      "tokens_out": 86,
      "cost_usd": 0.001434,
      "latency_ms": 532
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_04",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS\n(\n    SELECT\n        user_id,\n        count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT\n    tu.user_id,\n    tu.event_count,\n    u.plan\nFROM top_users AS tu\nLEFT JOIN users AS u USING (user_id)\nORDER BY tu.event_count DESC;",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 373,
      "tokens_out": 86,
      "cost_usd": 0.001434,
      "latency_ms": 547
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_04",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS\n(\n    SELECT\n        user_id,\n        count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT\n    t.user_id,\n    t.event_count,\n    u.plan\nFROM top_users AS t\nLEFT JOIN users AS u USING (user_id)\nORDER BY t.event_count DESC, t.user_id;",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 373,
      "tokens_out": 90,
      "cost_usd": 0.001466,
      "latency_ms": 603
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_05",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    user_id,\n    event_count\nFROM\n(\n    SELECT\n        user_id,\n        count() AS event_count\n    FROM events\n    GROUP BY user_id\n)\nWHERE event_count > (\n    SELECT avg(event_count)\n    FROM\n    (\n        SELECT\n            user_id,\n            count() AS event_count\n        FROM events\n        GROUP BY user_id\n    )\n)\nORDER BY event_count DESC;",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 368,
      "tokens_out": 91,
      "cost_usd": 0.001464,
      "latency_ms": 598
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_05",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    user_id,\n    count() AS total_events\nFROM events\nGROUP BY user_id\nHAVING total_events > (\n    SELECT avg(event_count)\n    FROM\n    (\n        SELECT\n            user_id,\n            count() AS event_count\n        FROM events\n        GROUP BY user_id\n    )\n);",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 372,
      "tokens_out": 65,
      "cost_usd": 0.001264,
      "latency_ms": 546
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_05",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    user_id,\n    count() AS total_event_count\nFROM events\nGROUP BY user_id\nHAVING total_event_count > (\n    SELECT avg(event_count)\n    FROM\n    (\n        SELECT\n            user_id,\n            count() AS event_count\n        FROM events\n        GROUP BY user_id\n    )\n);",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 368,
      "tokens_out": 71,
      "cost_usd": 0.001304,
      "latency_ms": 570
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_06",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 139299\t2024-10-01 00:00:42.000\t7817\tclick\t/docs\t646\t{'source':'email'}\t['mobile']\tBR\tmobile\t7523\n509",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n);",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 371,
      "tokens_out": 70,
      "cost_usd": 0.001302,
      "latency_ms": 507
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_06",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 81015\t2024-11-01 00:04:33.000\t8349\tsignup\t/settings\t4631\t{'campaign':'launch','source':'google'}\t[]\t",
      "llm_sql": "SELECT\n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents\nFROM events AS e\nWHERE e.user_id IN\n(\n    SELECT u.user_id\n    FROM users AS u\n    WHERE u.plan = 'enterprise'\n);",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 371,
      "tokens_out": 90,
      "cost_usd": 0.001462,
      "latency_ms": 500
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_06",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 270475\t2024-09-01 00:00:19.000\t1544\tpurchase\t/pricing\t7171\t{'source':'twitter'}\t[]\tDE\ttablet\t\\N\n8631",
      "llm_sql": "SELECT\n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents\nFROM events AS e\nWHERE e.user_id IN\n(\n    SELECT u.user_id\n    FROM users AS u\n    WHERE u.plan = 'enterprise'\n);",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 371,
      "tokens_out": 90,
      "cost_usd": 0.001462,
      "latency_ms": 1200
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_07",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    avg(e.events_per_user) AS avg_events_per_user\nFROM\n(\n    SELECT\n        user_id,\n        count() AS events_per_user\n    FROM events\n    GROUP BY user_id\n) AS e\nINNER JOIN users AS u ON u.user_id = e.user_id\nGROUP BY u.plan\nORDER BY u.plan;",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 367,
      "tokens_out": 79,
      "cost_usd": 0.001366,
      "latency_ms": 690
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_07",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    avg(e.events_per_user) AS avg_events_per_user\nFROM\n(\n    SELECT\n        user_id,\n        count() AS events_per_user\n    FROM events\n    GROUP BY user_id\n) AS e\nINNER JOIN users AS u ON u.user_id = e.user_id\nGROUP BY u.plan\nORDER BY u.plan;",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 367,
      "tokens_out": 79,
      "cost_usd": 0.001366,
      "latency_ms": 546
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_07",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.plan,\n    avg(events_per_user) AS avg_events_per_user\nFROM\n(\n    SELECT\n        user_id,\n        count() AS events_per_user\n    FROM events\n    GROUP BY user_id\n) e\nINNER JOIN users u ON u.user_id = e.user_id\nGROUP BY u.plan\nORDER BY u.plan;",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 367,
      "tokens_out": 76,
      "cost_usd": 0.001342,
      "latency_ms": 604
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_08",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6458\n7340\n1945\n6650\n3129\n9161\n280\n2639\n1753\n639\n6052\n5956\n2329\n6274\n3193\n8395\n6393\n1740\n7545\n8665\n26",
      "llm_sql": "SELECT DISTINCT e.user_id\nFROM events AS e\nINNER JOIN users AS u ON u.user_id = e.user_id\nWHERE u.created_at >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n  AND u.created_at <  toDateTime64('2025-01-01 00:00:00', 3, 'UTC')\n  AND e.event_type = 'purchase';",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 370,
      "tokens_out": 98,
      "cost_usd": 0.001524,
      "latency_ms": 537
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_08",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3\t2024-09-08 08:16:45.000\tenterprise\tuser3@example.com\tGB\n7\t2024-04-19 14:50:53.000\tfree\tuser7@examp",
      "llm_sql": "SELECT\n    u.user_id,\n    u.created_at,\n    u.plan,\n    u.email,\n    u.country\nFROM users AS u\nWHERE u.created_at >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n  AND u.created_at <  toDateTime64('2025-01-01 00:00:00', 3, 'UTC')\n  AND u.user_id IN (\n      SELECT DISTINCT user_id\n      FROM events\n      WHERE event_type = 'purchase'\n  );",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 370,
      "tokens_out": 120,
      "cost_usd": 0.0017,
      "latency_ms": 1286
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_08",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 8023\t2024-02-01 09:28:35.000\tfree\tuser8023@example.com\tIN\n6664\t2024-06-20 12:47:21.000\tenterprise\tus",
      "llm_sql": "SELECT\n    u.user_id,\n    u.created_at AS signup_time,\n    u.plan,\n    u.email,\n    u.country\nFROM users AS u\nWHERE u.created_at >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n  AND u.created_at <  toDateTime64('2025-01-01 00:00:00', 3, 'UTC')\n  AND EXISTS\n  (\n      SELECT 1\n      FROM events AS e\n      WHERE e.user_id = u.user_id\n        AND e.event_type = 'purchase'\n      LIMIT 1\n  );",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 370,
      "tokens_out": 139,
      "cost_usd": 0.001852,
      "latency_ms": 611
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_09",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    country,\n    count() AS pro_users\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY pro_users DESC\nLIMIT 1;",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 367,
      "tokens_out": 39,
      "cost_usd": 0.001046,
      "latency_ms": 626
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_09",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    u.country,\n    count() AS pro_users\nFROM users AS u\nWHERE u.plan = 'pro'\nGROUP BY u.country\nORDER BY pro_users DESC\nLIMIT 1;",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 367,
      "tokens_out": 44,
      "cost_usd": 0.001086,
      "latency_ms": 588
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_09",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    country,\n    count() AS pro_users\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY pro_users DESC\nLIMIT 1;",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 367,
      "tokens_out": 39,
      "cost_usd": 0.001046,
      "latency_ms": 541
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_10",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t3118\t56",
      "llm_sql": "WITH counts AS\n(\n    SELECT\n        device,\n        user_id,\n        count() AS event_count\n    FROM events\n    GROUP BY\n        device,\n        user_id\n)\nSELECT\n    device,\n    user_id,\n    event_count\nFROM\n(\n    SELECT\n        device,\n        user_id,\n        event_count,\n        row_number() OVER (PARTITION BY device ORDER BY event_count DESC, user_id ASC) AS rn\n    FROM counts\n)\nWHERE rn = 1\nORDER BY device;",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 366,
      "tokens_out": 110,
      "cost_usd": 0.001612,
      "latency_ms": 553
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_10",
      "tier": 4,
      "run": 2,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 184. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function max(event_count) AS event_count is found inside another aggr",
      "llm_sql": "WITH counts AS\n(\n    SELECT\n        device,\n        user_id,\n        count() AS event_count\n    FROM events\n    GROUP BY\n        device,\n        user_id\n)\nSELECT\n    device,\n    argMax(user_id, event_count) AS user_id,\n    max(event_count) AS event_count\nFROM counts\nGROUP BY device\nORDER BY device;",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 366,
      "tokens_out": 229,
      "cost_usd": 0.002564,
      "latency_ms": 505
    },
    {
      "model": "gpt-5.2",
      "question_id": "t4_10",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t3118\t56",
      "llm_sql": "WITH counts AS\n(\n    SELECT\n        device,\n        user_id,\n        count() AS event_count\n    FROM events\n    GROUP BY\n        device,\n        user_id\n)\nSELECT\n    device,\n    user_id,\n    event_count\nFROM\n(\n    SELECT\n        device,\n        user_id,\n        event_count,\n        row_number() OVER (PARTITION BY device ORDER BY event_count DESC, user_id ASC) AS rn\n    FROM counts\n)\nWHERE rn = 1\nORDER BY device;",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 366,
      "tokens_out": 188,
      "cost_usd": 0.002236,
      "latency_ms": 500
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_01",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 922606\t2024-05-15 00:21:18.000\t8039\tpurchase\t/blog\t9993\t{'campaign':'black_friday','source':'faceboo",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp, event_id) AS event_seq\nFROM events;",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 369,
      "tokens_out": 70,
      "cost_usd": 0.001298,
      "latency_ms": 680
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_01",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 322782\t2024-09-19 04:19:42.000\t8067\tpurchase\t/checkout\t9693\t{'source':'direct'}\t['vip_member','premi",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp, event_id) AS event_seq\nFROM events;",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 369,
      "tokens_out": 70,
      "cost_usd": 0.001298,
      "latency_ms": 570
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_01",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 322782\t2024-09-19 04:19:42.000\t8067\tpurchase\t/checkout\t9693\t{'source':'direct'}\t['vip_member','premi",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp, event_id) AS event_number\nFROM events;",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 369,
      "tokens_out": 70,
      "cost_usd": 0.001298,
      "latency_ms": 537
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_02",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH daily AS\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS events_count\n    FROM events\n    WHERE timestamp >= toDateTime64('2024-01-01 00:00:00.000', 3, 'UTC')\n      AND timestamp <  toDateTime64('2025-01-01 00:00:00.000', 3, 'UTC')\n    GROUP BY day\n)\nSELECT\n    day,\n    events_count,\n    sum(events_count) OVER (ORDER BY day ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS running_total_events\nFROM daily\nORDER BY day;",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 366,
      "tokens_out": 143,
      "cost_usd": 0.001876,
      "latency_ms": 663
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_02",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH daily AS\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS events_count\n    FROM events\n    WHERE timestamp >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n      AND timestamp <  toDateTime64('2025-01-01 00:00:00', 3, 'UTC')\n    GROUP BY day\n)\nSELECT\n    day,\n    events_count,\n    sum(events_count) OVER (ORDER BY day ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS running_total_events\nFROM daily\nORDER BY day;",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 366,
      "tokens_out": 139,
      "cost_usd": 0.001844,
      "latency_ms": 539
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_02",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\t2811\n2024-01-02\t2762\t5573\n2024-01-03\t2775\t8348\n2024-01-04\t2690\t11038\n2024-01-05\t2694",
      "llm_sql": "WITH daily AS\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS events_per_day\n    FROM events\n    WHERE timestamp >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n      AND timestamp <  toDateTime64('2025-01-01 00:00:00', 3, 'UTC')\n    GROUP BY day\n),\ncalendar AS\n(\n    SELECT\n        day\n    FROM\n    (\n        SELECT\n            arrayJoin(\n                arrayMap(\n                    i -> toDate('2024-01-01') + toIntervalDay(i),\n                    range(dateDiff('day', toDate(",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 366,
      "tokens_out": 255,
      "cost_usd": 0.002772,
      "latency_ms": 541
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_03",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    day,\n    event_count,\n    lagInFrame(event_count, 1) OVER (ORDER BY day) AS prev_day_event_count\nFROM\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS event_count\n    FROM events\n    GROUP BY day\n)\nORDER BY day;",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 371,
      "tokens_out": 70,
      "cost_usd": 0.001302,
      "latency_ms": 588
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_03",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    day,\n    event_count,\n    lagInFrame(event_count, 1) OVER (ORDER BY day) AS prev_day_event_count\nFROM\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS event_count\n    FROM events\n    GROUP BY day\n)\nORDER BY day;",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 371,
      "tokens_out": 70,
      "cost_usd": 0.001302,
      "latency_ms": 640
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_03",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    day,\n    event_count,\n    lagInFrame(event_count, 1) OVER (ORDER BY day) AS prev_day_event_count\nFROM\n(\n    SELECT\n        toDate(timestamp) AS day,\n        count() AS event_count\n    FROM events\n    GROUP BY day\n)\nORDER BY day;",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 371,
      "tokens_out": 70,
      "cost_usd": 0.001302,
      "latency_ms": 649
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_04",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 823694\t2024-06-01 00:00:48.000\t3869\tclick\t/checkout\t2962\t{'campaign':'summer_sale','source':'email'}",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    arrayMap(t -> upper(t), tags) AS tags_upper,\n    country,\n    device,\n    revenue_cents\nFROM events;",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 366,
      "tokens_out": 59,
      "cost_usd": 0.001204,
      "latency_ms": 549
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_04",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t/blog\t\\N\t{'source':'facebook'}\t[]\tBR\ttablet\t\\N\n774716\t202",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    arrayMap(t -> upperUTF8(t), tags) AS tags_upper,\n    country,\n    device,\n    revenue_cents\nFROM events;",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 366,
      "tokens_out": 61,
      "cost_usd": 0.00122,
      "latency_ms": 526
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_04",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 139299\t2024-10-01 00:00:42.000\t7817\tclick\t/docs\t646\t{'source':'email'}\t['MOBILE']\tBR\tmobile\t7523\n509",
      "llm_sql": "SELECT\n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    arrayMap(t -> upper(t), tags) AS tags_upper,\n    country,\n    device,\n    revenue_cents\nFROM events;",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 366,
      "tokens_out": 59,
      "cost_usd": 0.001204,
      "latency_ms": 540
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_05",
      "tier": 5,
      "run": 1,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 184. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function max(total_duration_ms) AS total_duration_ms is found inside ",
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration_ms) AS user_id,\n    max(total_duration_ms) AS total_duration_ms\nFROM\n(\n    SELECT\n        event_type,\n        user_id,\n        sum(ifNull(duration_ms, 0)) AS total_duration_ms\n    FROM events\n    GROUP BY\n        event_type,\n        user_id\n)\nGROUP BY event_type;",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 371,
      "tokens_out": 258,
      "cost_usd": 0.002806,
      "latency_ms": 633
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_05",
      "tier": 5,
      "run": 2,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 184. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function max(total_duration_ms) AS total_duration_ms is found inside ",
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration_ms) AS user_id,\n    max(total_duration_ms) AS total_duration_ms\nFROM\n(\n    SELECT\n        event_type,\n        user_id,\n        sum(ifNull(duration_ms, 0)) AS total_duration_ms\n    FROM events\n    GROUP BY\n        event_type,\n        user_id\n)\nGROUP BY event_type;",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 371,
      "tokens_out": 212,
      "cost_usd": 0.002438,
      "latency_ms": 560
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_05",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration_ms) AS user_id_with_longest_total_duration,\n    max(total_duration_ms) AS longest_total_duration_ms\nFROM\n(\n    SELECT\n        event_type,\n        user_id,\n        sum(coalesce(duration_ms, 0)) AS total_duration_ms\n    FROM events\n    GROUP BY\n        event_type,\n        user_id\n)\nGROUP BY event_type;",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 371,
      "tokens_out": 256,
      "cost_usd": 0.00279,
      "latency_ms": 629
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_06",
      "tier": 5,
      "run": 1,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 47. DB::Exception: Received from localhost:9000. DB::Exception: Unknown expression identifier `day` in scope SELECT day, count() AS event_count ",
      "llm_sql": "SELECT\n    day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n  AND timestamp <  toDateTime64('2024-02-01 00:00:00', 3, 'UTC')\nGROUP BY\n    day = toDate(timestamp)\nORDER BY day\nWITH FILL\n    FROM toDate('2024-01-01')\n    TO   toDate('2024-02-01')\n    STEP 1;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 373,
      "tokens_out": 123,
      "cost_usd": 0.00173,
      "latency_ms": 584
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_06",
      "tier": 5,
      "run": 2,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 47. DB::Exception: Received from localhost:9000. DB::Exception: Unknown expression identifier `day` in scope SELECT day, count() AS event_count ",
      "llm_sql": "SELECT\n    day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n  AND timestamp <  toDateTime64('2024-02-01 00:00:00', 3, 'UTC')\nGROUP BY\n    day = toDate(timestamp)\nORDER BY day\nWITH FILL\n    FROM toDate('2024-01-01')\n    TO   toDate('2024-02-01')\n    STEP 1;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 373,
      "tokens_out": 123,
      "cost_usd": 0.00173,
      "latency_ms": 1599
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_06",
      "tier": 5,
      "run": 3,
      "score": 0,
      "error_type": "Syntax Error",
      "error_msg": "Code: 62. DB::Exception: Syntax error: failed at position 200 (=) (line 7, col 15): = toDate(timestamp)\nORDER BY day\nWITH FILL\n    FROM toDate('2024-01-01')\n    TO toDate('2024-02-01')\n    STEP 1;. Ex",
      "llm_sql": "SELECT\n    day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n  AND timestamp <  toDateTime64('2024-02-01 00:00:00', 3, 'UTC')\nGROUP BY day := toDate(timestamp)\nORDER BY day\nWITH FILL\n    FROM toDate('2024-01-01')\n    TO toDate('2024-02-01')\n    STEP 1;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 373,
      "tokens_out": 120,
      "cost_usd": 0.001706,
      "latency_ms": 587
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_07",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3699\t['click','click','click','click','click','click','click','click','click','click','click','click",
      "llm_sql": "SELECT\n    user_id,\n    arraySort(groupArray(event_type)) AS event_types_sorted\nFROM events\nGROUP BY user_id;",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 367,
      "tokens_out": 31,
      "cost_usd": 0.000982,
      "latency_ms": 531
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_07",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3523\t['click','click','click','click','click','click','click','click','click','click','click','click",
      "llm_sql": "SELECT\n    user_id,\n    arraySort(groupArray(event_type)) AS event_types_sorted\nFROM events\nGROUP BY user_id;",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 367,
      "tokens_out": 31,
      "cost_usd": 0.000982,
      "latency_ms": 507
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_07",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1978\t['click','click','click','click','click','click','click','click','click','click','click','click",
      "llm_sql": "SELECT\n    user_id,\n    arraySort(groupArray(event_type)) AS event_types_sorted\nFROM events\nGROUP BY user_id;",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 367,
      "tokens_out": 31,
      "cost_usd": 0.000982,
      "latency_ms": 635
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_08",
      "tier": 5,
      "run": 1,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 184. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function max(timestamp) AS timestamp is found inside another aggregat",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS event_id,\n    max(timestamp) AS timestamp,\n    argMax(event_type, timestamp) AS event_type,\n    argMax(page, timestamp) AS page,\n    argMax(duration_ms, timestamp) AS duration_ms,\n    argMax(properties, timestamp) AS properties,\n    argMax(tags, timestamp) AS tags,\n    argMax(country, timestamp) AS country,\n    argMax(device, timestamp) AS device,\n    argMax(revenue_cents, timestamp) AS revenue_cents\nFROM events\nGROUP BY user_id;",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 364,
      "tokens_out": 126,
      "cost_usd": 0.001736,
      "latency_ms": 604
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_08",
      "tier": 5,
      "run": 2,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 184. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function max(timestamp) AS timestamp is found inside another aggregat",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp)        AS event_id,\n    max(timestamp)                     AS timestamp,\n    argMax(event_type, timestamp)      AS event_type,\n    argMax(page, timestamp)            AS page,\n    argMax(duration_ms, timestamp)     AS duration_ms,\n    argMax(properties, timestamp)      AS properties,\n    argMax(tags, timestamp)            AS tags,\n    argMax(country, timestamp)         AS country,\n    argMax(device, timestamp)          AS device,\n    argMax(reve",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 364,
      "tokens_out": 136,
      "cost_usd": 0.001816,
      "latency_ms": 496
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_08",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3699\t188795\t2024-12-17 19:20:00.000\tpageview\t/about\t5018\t{'source':'direct'}\t[]\tGB\tdesktop\t2915\n8130",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS most_recent_event_id,\n    max(timestamp) AS most_recent_timestamp,\n    argMax(event_type, timestamp) AS most_recent_event_type,\n    argMax(page, timestamp) AS most_recent_page,\n    argMax(duration_ms, timestamp) AS most_recent_duration_ms,\n    argMax(properties, timestamp) AS most_recent_properties,\n    argMax(tags, timestamp) AS most_recent_tags,\n    argMax(country, timestamp) AS most_recent_country,\n    argMax(device, timestamp) AS most_re",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 364,
      "tokens_out": 147,
      "cost_usd": 0.001904,
      "latency_ms": 553
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_09",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH\n    toDateTime('2024-06-15 00:00:00', 'UTC') AS day_start\nSELECT\n    hours.h AS hour,\n    coalesce(e.cnt, 0) AS event_count\nFROM\n(\n    SELECT\n        addHours(day_start, number) AS h\n    FROM numbers(24)\n) AS hours\nLEFT JOIN\n(\n    SELECT\n        toStartOfHour(timestamp) AS h,\n        count() AS cnt\n    FROM events\n    WHERE timestamp >= day_start\n      AND timestamp < addDays(day_start, 1)\n    GROUP BY h\n) AS e\nON e.h = hours.h\nORDER BY hour;",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 378,
      "tokens_out": 146,
      "cost_usd": 0.001924,
      "latency_ms": 529
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_09",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH\n    toDateTime('2024-06-15 00:00:00', 'UTC') AS day_start,\n    day_start + INTERVAL 1 DAY AS day_end\nSELECT\n    h AS hour_start,\n    coalesce(e.cnt, 0) AS event_count\nFROM\n(\n    SELECT\n        addHours(day_start, number) AS h\n    FROM numbers(24)\n) AS hours\nLEFT JOIN\n(\n    SELECT\n        toStartOfHour(timestamp) AS hour_start,\n        count() AS cnt\n    FROM events\n    WHERE timestamp >= day_start\n      AND timestamp < day_end\n    GROUP BY hour_start\n) AS e\nON e.hour_start = hours.h\nORDER B",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 378,
      "tokens_out": 158,
      "cost_usd": 0.00202,
      "latency_ms": 543
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_09",
      "tier": 5,
      "run": 3,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 43. DB::Exception: Received from localhost:9000. DB::Exception: Illegal types UInt64 and IntervalHour of arguments of function multiply: In scop",
      "llm_sql": "WITH hours AS\n(\n    SELECT toDateTime64('2024-06-15 00:00:00', 3, 'UTC') + number * INTERVAL 1 HOUR AS hour\n    FROM numbers(24)\n)\nSELECT\n    h.hour,\n    coalesce(e.cnt, 0) AS event_count\nFROM hours AS h\nLEFT JOIN\n(\n    SELECT\n        toStartOfHour(timestamp) AS hour,\n        count() AS cnt\n    FROM events\n    WHERE timestamp >= toDateTime64('2024-06-15 00:00:00', 3, 'UTC')\n      AND timestamp <  toDateTime64('2024-06-16 00:00:00', 3, 'UTC')\n    GROUP BY hour\n) AS e\nON h.hour = e.hour\nORDER BY h",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 378,
      "tokens_out": 184,
      "cost_usd": 0.002228,
      "latency_ms": 522
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_10",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3699\t['premium_user']\n8130\t['premium_user']\n3193\t['premium_user']\n7624\t['premium_user']\n7126\t['premi",
      "llm_sql": "SELECT\n    user_id,\n    arrayDistinct(arrayFlatten(groupArray(arrayFilter(t -> positionCaseInsensitive(t, 'premium') > 0, tags)))) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING length(premium_tags) > 0;",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 382,
      "tokens_out": 58,
      "cost_usd": 0.001228,
      "latency_ms": 578
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_10",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t['premium_user']\n9529\t['premium_user']\n6122\t['premium_user']\n5600\t['premium_user']\n1105\t['premi",
      "llm_sql": "SELECT\n    user_id,\n    arrayDistinct(\n        arrayFlatten(\n            groupArray(\n                arrayFilter(t -> positionCaseInsensitiveUTF8(t, 'premium') > 0, tags)\n            )\n        )\n    ) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING length(premium_tags) > 0;",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 382,
      "tokens_out": 72,
      "cost_usd": 0.00134,
      "latency_ms": 678
    },
    {
      "model": "gpt-5.2",
      "question_id": "t5_10",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1978\t['premium_user']\n9432\t['premium_user']\n5643\t['premium_user']\n9938\t['premium_user']\n1456\t['premi",
      "llm_sql": "SELECT\n    user_id,\n    arrayDistinct(\n        arrayFlatten(\n            groupArray(\n                arrayFilter(t -> positionCaseInsensitiveUTF8(t, 'premium') > 0, tags)\n            )\n        )\n    ) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING length(premium_tags) > 0;",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 382,
      "tokens_out": 72,
      "cost_usd": 0.00134,
      "latency_ms": 541
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_01",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT COUNT(*) FROM events;",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 354,
      "tokens_out": 209,
      "cost_usd": 0.000714,
      "latency_ms": 5363.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_01",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 354,
      "tokens_out": 221,
      "cost_usd": 0.0007428,
      "latency_ms": 15807.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_01",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 354,
      "tokens_out": 139,
      "cost_usd": 0.000546,
      "latency_ms": 3700.3
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_02",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 353,
      "tokens_out": 222,
      "cost_usd": 0.0007445999999999999,
      "latency_ms": 5312.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_02",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 353,
      "tokens_out": 241,
      "cost_usd": 0.0007901999999999999,
      "latency_ms": 5601.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_02",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 353,
      "tokens_out": 252,
      "cost_usd": 0.0008165999999999999,
      "latency_ms": 5929.4
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_03",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE toYYYYMM(timestamp) = 202403",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 355,
      "tokens_out": 1111,
      "cost_usd": 0.0028794000000000003,
      "latency_ms": 24019.4
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_03",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE timestamp >= '2024-03-01'\n  AND timestamp < '2024-04-01'",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 355,
      "tokens_out": 937,
      "cost_usd": 0.0024617999999999997,
      "latency_ms": 19722.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_03",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE toYYYYMM(timestamp) = 202403",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 355,
      "tokens_out": 769,
      "cost_usd": 0.0020586,
      "latency_ms": 16544.6
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_04",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type\nFROM events\nORDER BY event_type",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 351,
      "tokens_out": 301,
      "cost_usd": 0.000933,
      "latency_ms": 7009.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_04",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 351,
      "tokens_out": 329,
      "cost_usd": 0.0010002000000000001,
      "latency_ms": 7397.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_04",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 351,
      "tokens_out": 259,
      "cost_usd": 0.0008322000000000001,
      "latency_ms": 6538.3
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_05",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE country = 'DE'",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 352,
      "tokens_out": 231,
      "cost_usd": 0.0007656,
      "latency_ms": 5588.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_05",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE country = 'DE';",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 352,
      "tokens_out": 282,
      "cost_usd": 0.000888,
      "latency_ms": 6720.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_05",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE country = 'DE'",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 352,
      "tokens_out": 200,
      "cost_usd": 0.0006912,
      "latency_ms": 5120.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_06",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 360,
      "tokens_out": 287,
      "cost_usd": 0.0009048,
      "latency_ms": 6925.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_06",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 360,
      "tokens_out": 407,
      "cost_usd": 0.0011928,
      "latency_ms": 9559.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_06",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 360,
      "tokens_out": 751,
      "cost_usd": 0.0020184,
      "latency_ms": 16032.8
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_07",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT COUNT(*) \nFROM users \nWHERE plan = 'pro';",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 356,
      "tokens_out": 198,
      "cost_usd": 0.0006887999999999999,
      "latency_ms": 5341.3
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_07",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 356,
      "tokens_out": 286,
      "cost_usd": 0.0009,
      "latency_ms": 6874.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_07",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT COUNT(*) FROM users WHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 356,
      "tokens_out": 278,
      "cost_usd": 0.0008807999999999999,
      "latency_ms": 6470.8
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_08",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT min(timestamp) AS earliest_timestamp, max(timestamp) AS latest_timestamp FROM events",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 354,
      "tokens_out": 276,
      "cost_usd": 0.0008747999999999999,
      "latency_ms": 6582.7
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_08",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    min(timestamp) AS earliest_timestamp,\n    max(timestamp) AS latest_timestamp\nFROM events",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 354,
      "tokens_out": 206,
      "cost_usd": 0.0007067999999999999,
      "latency_ms": 5258.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_08",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT MIN(timestamp) AS earliest, MAX(timestamp) AS latest FROM events;",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 354,
      "tokens_out": 317,
      "cost_usd": 0.0009731999999999999,
      "latency_ms": 7011.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_09",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01'\n  AND timestamp < '2025-01-01'\nORDER BY timestamp",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 358,
      "tokens_out": 1045,
      "cost_usd": 0.0027228,
      "latency_ms": 22051.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_09",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01'\n  AND timestamp < '2025-01-01'",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 358,
      "tokens_out": 657,
      "cost_usd": 0.0017916,
      "latency_ms": 14019.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_09",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01'\n  AND timestamp < '2025-01-01'\nORDER BY timestamp",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 358,
      "tokens_out": 1426,
      "cost_usd": 0.0036372,
      "latency_ms": 27955.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_10",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count(duration_ms)\nFROM events",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 355,
      "tokens_out": 334,
      "cost_usd": 0.0010146,
      "latency_ms": 6754.3
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_10",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count()\nFROM events\nWHERE duration_ms IS NOT NULL",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 355,
      "tokens_out": 258,
      "cost_usd": 0.0008322,
      "latency_ms": 5666.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t1_10",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT COUNT(duration_ms) FROM events;",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 355,
      "tokens_out": 272,
      "cost_usd": 0.0008657999999999999,
      "latency_ms": 6222.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_01",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    count() AS event_count\nFROM events\nGROUP BY event_type\nORDER BY event_count DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 357,
      "tokens_out": 206,
      "cost_usd": 0.0007085999999999999,
      "latency_ms": 5037.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_01",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type, \n    count() AS event_count\nFROM events\nGROUP BY event_type\nORDER BY event_count DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 357,
      "tokens_out": 218,
      "cost_usd": 0.0007373999999999998,
      "latency_ms": 4942.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_01",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    count() AS event_count\nFROM events\nGROUP BY event_type\nORDER BY event_count DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 357,
      "tokens_out": 242,
      "cost_usd": 0.000795,
      "latency_ms": 4894.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_02",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    device,\n    avg(duration_ms) AS avg_duration_ms\nFROM events\nGROUP BY device\nORDER BY device",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 355,
      "tokens_out": 474,
      "cost_usd": 0.0013506,
      "latency_ms": 9779.4
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_02",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT device, avg(duration_ms) AS avg_duration_ms\nFROM events\nGROUP BY device\nORDER BY device",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 355,
      "tokens_out": 758,
      "cost_usd": 0.0020322,
      "latency_ms": 14977.6
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_02",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    device,\n    avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY device\nORDER BY device",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 355,
      "tokens_out": 407,
      "cost_usd": 0.0011898,
      "latency_ms": 7949.7
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_03",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 358,
      "tokens_out": 898,
      "cost_usd": 0.00237,
      "latency_ms": 16516.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_03",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS date,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY date\nORDER BY date",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 358,
      "tokens_out": 747,
      "cost_usd": 0.0020076,
      "latency_ms": 13374.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_03",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 358,
      "tokens_out": 779,
      "cost_usd": 0.0020844,
      "latency_ms": 16410.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_04",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS event_count\nFROM events\nGROUP BY country\nHAVING event_count > 10000\nORDER BY event_count DESC",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 355,
      "tokens_out": 488,
      "cost_usd": 0.0013842000000000001,
      "latency_ms": 9898.3
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_04",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS event_count\nFROM events\nGROUP BY country\nHAVING event_count > 10000\nORDER BY event_count DESC",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 355,
      "tokens_out": 820,
      "cost_usd": 0.002181,
      "latency_ms": 16132.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_04",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS event_count\nFROM events\nGROUP BY country\nHAVING event_count > 10000\nORDER BY event_count DESC",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 355,
      "tokens_out": 545,
      "cost_usd": 0.001521,
      "latency_ms": 10101.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_05",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toHour(timestamp) AS hour_of_day,\n    count() AS event_count\nFROM events\nGROUP BY hour_of_day\nORDER BY hour_of_day",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 356,
      "tokens_out": 371,
      "cost_usd": 0.001104,
      "latency_ms": 7637.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_05",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toHour(timestamp) AS hour_of_day,\n    count() AS event_count\nFROM events\nGROUP BY hour_of_day\nORDER BY hour_of_day ASC",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 356,
      "tokens_out": 267,
      "cost_usd": 0.0008544,
      "latency_ms": 5645.3
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_05",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toHour(timestamp) AS hour_of_day, count() AS event_count\nFROM events\nGROUP BY hour_of_day\nORDER BY hour_of_day",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 356,
      "tokens_out": 355,
      "cost_usd": 0.0010655999999999999,
      "latency_ms": 6860.8
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_06",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) FROM events WHERE event_type = 'pageview';",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 359,
      "tokens_out": 329,
      "cost_usd": 0.001005,
      "latency_ms": 7026.4
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_06",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE event_type = 'pageview';",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 359,
      "tokens_out": 291,
      "cost_usd": 0.0009138,
      "latency_ms": 6096.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_06",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT AVG(duration_ms) AS avg_duration_ms\nFROM events\nWHERE event_type = 'pageview';",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 359,
      "tokens_out": 436,
      "cost_usd": 0.0012618,
      "latency_ms": 8255.8
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_07",
      "tier": 2,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 202401\t85592\n202402\t79807\n202403\t84690\n202404\t82004\n202405\t85155\n202406\t82530\n202407\t84695\n202408\t85",
      "llm_sql": "SELECT \n    toYYYYMM(timestamp) AS month,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY month\nORDER BY month",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 355,
      "tokens_out": 937,
      "cost_usd": 0.0024617999999999997,
      "latency_ms": 18332.4
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_07",
      "tier": 2,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 202401\t85592\n202402\t79807\n202403\t84690\n202404\t82004\n202405\t85155\n202406\t82530\n202407\t84695\n202408\t85",
      "llm_sql": "SELECT \n    toYYYYMM(timestamp) AS month,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY month\nORDER BY month",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 355,
      "tokens_out": 1471,
      "cost_usd": 0.0037434,
      "latency_ms": 25993.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_07",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toStartOfMonth(timestamp) AS month,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY month\nORDER BY month",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 355,
      "tokens_out": 1694,
      "cost_usd": 0.0042786000000000005,
      "latency_ms": 29729.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_08",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    uniqExact(country) AS distinct_countries\nFROM events\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 357,
      "tokens_out": 750,
      "cost_usd": 0.0020142,
      "latency_ms": 14578.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_08",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    COUNT(DISTINCT country) AS distinct_countries\nFROM events\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 357,
      "tokens_out": 622,
      "cost_usd": 0.001707,
      "latency_ms": 11244.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_08",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    countDistinct(country) AS distinct_countries\nFROM events\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 357,
      "tokens_out": 686,
      "cost_usd": 0.0018606,
      "latency_ms": 12458.8
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_09",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    country,\n    SUM(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 359,
      "tokens_out": 715,
      "cost_usd": 0.0019314,
      "latency_ms": 12882.4
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_09",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 359,
      "tokens_out": 982,
      "cost_usd": 0.0025721999999999997,
      "latency_ms": 17998.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_09",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    country, \n    sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY country",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 359,
      "tokens_out": 1072,
      "cost_usd": 0.0027882,
      "latency_ms": 22636.7
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_10",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    countIf(event_type = 'purchase') AS purchase_count,\n    countIf(event_type = 'pageview') AS pageview_count\nFROM events",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 359,
      "tokens_out": 477,
      "cost_usd": 0.0013602,
      "latency_ms": 9254.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_10",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    countIf(event_type = 'purchase') AS purchase_events,\n    countIf(event_type = 'pageview') AS pageview_events\nFROM events",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 359,
      "tokens_out": 776,
      "cost_usd": 0.0020778,
      "latency_ms": 14448.6
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t2_10",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    countIf(event_type = 'purchase') AS purchase_count,\n    countIf(event_type = 'pageview') AS pageview_count\nFROM events",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 359,
      "tokens_out": 701,
      "cost_usd": 0.0018978,
      "latency_ms": 12470.8
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_01",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 5046",
      "llm_sql": "SELECT quantileExact(0.5)(duration_ms) AS median_duration_ms\nFROM events;",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 355,
      "tokens_out": 1012,
      "cost_usd": 0.0026417999999999997,
      "latency_ms": 18888.3
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_01",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT median(duration_ms) FROM events",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 355,
      "tokens_out": 717,
      "cost_usd": 0.0019338,
      "latency_ms": 13475.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_01",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT median(duration_ms) FROM events",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 355,
      "tokens_out": 675,
      "cost_usd": 0.001833,
      "latency_ms": 12587.6
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_02",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT uniqExact(user_id) FROM events;",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 357,
      "tokens_out": 636,
      "cost_usd": 0.0017406,
      "latency_ms": 13116.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_02",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT uniqExact(user_id) FROM events;",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 357,
      "tokens_out": 791,
      "cost_usd": 0.0021126,
      "latency_ms": 14839.7
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_02",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT uniqExact(user_id) FROM events",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 357,
      "tokens_out": 389,
      "cost_usd": 0.0011478,
      "latency_ms": 7881.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_03",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 521466\t2024-10-01 00:01:11.000\t1302\tlogout\t/docs\t9913\t{'campaign':'black_friday','source':'direct'}\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 358,
      "tokens_out": 591,
      "cost_usd": 0.0016331999999999998,
      "latency_ms": 11436.7
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_03",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 322580\t2024-09-01 00:01:24.000\t2253\tsignup\t/blog\t2583\t{'campaign':'black_friday','source':'twitter'}",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 358,
      "tokens_out": 567,
      "cost_usd": 0.0015756,
      "latency_ms": 10944.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_03",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 521466\t2024-10-01 00:01:11.000\t1302\tlogout\t/docs\t9913\t{'campaign':'black_friday','source':'direct'}\t",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 358,
      "tokens_out": 553,
      "cost_usd": 0.001542,
      "latency_ms": 11017.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_04",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 366,
      "tokens_out": 455,
      "cost_usd": 0.0013116,
      "latency_ms": 9465.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_04",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 366,
      "tokens_out": 407,
      "cost_usd": 0.0011963999999999998,
      "latency_ms": 8407.7
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_04",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 366,
      "tokens_out": 609,
      "cost_usd": 0.0016811999999999999,
      "latency_ms": 11655.8
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_05",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    arrayJoin(tags) AS tag,\n    count() AS occurrences\nFROM events\nGROUP BY tag\nORDER BY occurrences DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 365,
      "tokens_out": 396,
      "cost_usd": 0.0011694000000000001,
      "latency_ms": 8104.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_05",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    tag,\n    count() AS count\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY count DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 365,
      "tokens_out": 1003,
      "cost_usd": 0.0026262,
      "latency_ms": 18387.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_05",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    tag,\n    count() AS tag_count\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY tag_count DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 365,
      "tokens_out": 604,
      "cost_usd": 0.0016686,
      "latency_ms": 10987.6
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_06",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 337459\t2024-08-01 00:05:33.000\t7274\tclick\t/docs\t8433\t{'source':'direct'}\t['promo','vip_member','mobi",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 360,
      "tokens_out": 447,
      "cost_usd": 0.0012887999999999999,
      "latency_ms": 8964.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_06",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 877989\t2024-12-01 00:09:55.000\t6543\tpageview\t/home\t9658\t{'source':'direct'}\t['promo']\tFR\tdesktop\t\\N\n",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 360,
      "tokens_out": 419,
      "cost_usd": 0.0012216,
      "latency_ms": 8291.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_06",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 877989\t2024-12-01 00:09:55.000\t6543\tpageview\t/home\t9658\t{'source':'direct'}\t['promo']\tFR\tdesktop\t\\N\n",
      "llm_sql": "SELECT *\nFROM events\nWHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 360,
      "tokens_out": 279,
      "cost_usd": 0.0008856000000000001,
      "latency_ms": 5707.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_07",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    quantile(0.9)(duration_ms) AS p90,\n    quantile(0.99)(duration_ms) AS p99\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 361,
      "tokens_out": 1733,
      "cost_usd": 0.0043758,
      "latency_ms": 32435.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_07",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    quantile(0.9)(duration_ms) AS p90,\n    quantile(0.99)(duration_ms) AS p99\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 361,
      "tokens_out": 1499,
      "cost_usd": 0.0038142,
      "latency_ms": 27793.6
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_07",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    quantile(0.9)(duration_ms) AS p90,\n    quantile(0.99)(duration_ms) AS p99\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 361,
      "tokens_out": 703,
      "cost_usd": 0.0019038,
      "latency_ms": 13117.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_08",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile')\nFROM events",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 362,
      "tokens_out": 447,
      "cost_usd": 0.00129,
      "latency_ms": 9940.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_08",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue\nFROM events",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 362,
      "tokens_out": 802,
      "cost_usd": 0.002142,
      "latency_ms": 23637.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_08",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS total_revenue_cents\nFROM events",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 362,
      "tokens_out": 310,
      "cost_usd": 0.0009612,
      "latency_ms": 6998.4
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_09",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS property_key\nFROM events\nORDER BY property_key",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 359,
      "tokens_out": 414,
      "cost_usd": 0.001209,
      "latency_ms": 9306.6
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_09",
      "tier": 3,
      "run": 2,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 46. DB::Exception: Received from localhost:9000. DB::Exception: Function with name `keys` does not exist. In scope SELECT DISTINCT arrayJoin(key",
      "llm_sql": "SELECT DISTINCT arrayJoin(keys(properties)) AS property_key\nFROM events",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 359,
      "tokens_out": 750,
      "cost_usd": 0.0020154,
      "latency_ms": 15725.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_09",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS property_key\nFROM events",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 359,
      "tokens_out": 417,
      "cost_usd": 0.0012162,
      "latency_ms": 8499.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_10",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 227800\t2024-06-01 00:02:52.000\t5652\tclick\t/checkout\t\\N\t{'campaign':'launch','source':'email'}\t['vip_",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(x -> startsWith(x, 'vip'), tags)",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 363,
      "tokens_out": 632,
      "cost_usd": 0.0017346,
      "latency_ms": 13135.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_10",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 227800\t2024-06-01 00:02:52.000\t5652\tclick\t/checkout\t\\N\t{'campaign':'launch','source':'email'}\t['vip_",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(x -> startsWith(x, 'vip'), tags)",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 363,
      "tokens_out": 710,
      "cost_usd": 0.0019218,
      "latency_ms": 13590.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t3_10",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 78581\t2024-11-01 00:07:22.000\t7126\tpageview\t/dashboard\t\\N\t{'source':'email'}\t['vip_member','new']\tJP",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(x -> startsWith(x, 'vip'), tags)",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 363,
      "tokens_out": 684,
      "cost_usd": 0.0018593999999999998,
      "latency_ms": 13198.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_01",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 669632\t2024-09-01 00:00:08.000\t3308\tpurchase\t/about\t7933\t{'source':'twitter'}\t['mobile']\tGB\tmobile\t3",
      "llm_sql": "SELECT \n    e.*,\n    u.plan\nFROM events e\nJOIN users u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 363,
      "tokens_out": 635,
      "cost_usd": 0.0017418,
      "latency_ms": 12239.4
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_01",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t/blog\t\\N\t{'source':'facebook'}\t[]\tBR\ttablet\t\\N\tpro\n774716",
      "llm_sql": "SELECT \n    e.*,\n    u.plan\nFROM events e\nJOIN users u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 363,
      "tokens_out": 534,
      "cost_usd": 0.0014994,
      "latency_ms": 10805.8
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_01",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t/blog\t\\N\t{'source':'facebook'}\t[]\tBR\ttablet\t\\N\tpro\n774716",
      "llm_sql": "SELECT \n    e.*,\n    u.plan\nFROM events e\nJOIN users u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 363,
      "tokens_out": 1026,
      "cost_usd": 0.0026802,
      "latency_ms": 19423.6
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_02",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    COUNT(*) as event_count\nFROM events e\nJOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 352,
      "tokens_out": 714,
      "cost_usd": 0.0019248,
      "latency_ms": 12973.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_02",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    count() AS event_count\nFROM events e\nJOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 352,
      "tokens_out": 1021,
      "cost_usd": 0.0026616,
      "latency_ms": 19646.3
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_02",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    plan,\n    count() AS event_count\nFROM events\nJOIN users USING (user_id)\nGROUP BY plan\nORDER BY event_count DESC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 352,
      "tokens_out": 1111,
      "cost_usd": 0.0028776,
      "latency_ms": 20670.7
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_03",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.*\nFROM users u\nLEFT JOIN events e ON u.user_id = e.user_id\nWHERE e.user_id IS NULL",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 354,
      "tokens_out": 1085,
      "cost_usd": 0.0028164,
      "latency_ms": 20630.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_03",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    user_id,\n    email,\n    plan,\n    created_at\nFROM users\nWHERE user_id NOT IN (\n    SELECT user_id \n    FROM events\n)",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 354,
      "tokens_out": 1084,
      "cost_usd": 0.002814,
      "latency_ms": 20889.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_03",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM users\nWHERE user_id NOT IN (SELECT user_id FROM events)",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 354,
      "tokens_out": 1802,
      "cost_usd": 0.0045372,
      "latency_ms": 34447.6
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_04",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\tenterprise\t143\n1040\tpro\t138\n6726\tpro\t135\n7449\tpro\t135\n9339\tpro\t134\n4333\tpro\t133\n3566\tenterprise",
      "llm_sql": "WITH top_users AS (\n    SELECT \n        user_id,\n        count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT \n    t.user_id,\n    u.plan,\n    t.event_count\nFROM top_users t\nJOIN users u ON t.user_id = u.user_id\nORDER BY t.event_count DESC",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 365,
      "tokens_out": 642,
      "cost_usd": 0.0017598,
      "latency_ms": 11935.6
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_04",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH top_users AS (\n    SELECT \n        user_id,\n        count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT \n    t.user_id,\n    t.event_count,\n    u.plan\nFROM top_users t\nJOIN users u ON t.user_id = u.user_id\nORDER BY t.event_count DESC",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 365,
      "tokens_out": 524,
      "cost_usd": 0.0014766,
      "latency_ms": 10181.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_04",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\tenterprise\t143\n1040\tpro\t138\n6726\tpro\t135\n7449\tpro\t135\n9339\tpro\t134\n4333\tpro\t133\n3566\tenterprise",
      "llm_sql": "WITH top_event_users AS (\n    SELECT \n        user_id, \n        count() AS event_count\n    FROM events\n    GROUP BY user_id\n    ORDER BY event_count DESC\n    LIMIT 10\n)\nSELECT \n    t.user_id,\n    u.plan,\n    t.event_count\nFROM top_event_users AS t\nJOIN users AS u ON t.user_id = u.user_id\nORDER BY t.event_count DESC",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 365,
      "tokens_out": 748,
      "cost_usd": 0.0020142,
      "latency_ms": 14838.6
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_05",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH\n    (SELECT count() / uniqExact(user_id) FROM events) AS avg_event_count\nSELECT\n    user_id,\n    count() AS total_events\nFROM events\nGROUP BY user_id\nHAVING total_events > avg_event_count\nORDER BY total_events DESC",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 360,
      "tokens_out": 1849,
      "cost_usd": 0.004653599999999999,
      "latency_ms": 33731.3
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_05",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\n1105\n8493\n591\n69\n3585\n3083\n2581\n7076\n6574\n9276\n5871\n8738\n7359\n2832\n2330\n9432\n5643\n4639\n8396\n942",
      "llm_sql": "SELECT user_id\nFROM events\nGROUP BY user_id\nHAVING count() > (SELECT count() / toFloat64(uniqExact(user_id)) FROM events)",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 360,
      "tokens_out": 3982,
      "cost_usd": 0.0097728,
      "latency_ms": 71275.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_05",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT user_id, event_count\nFROM (\n    SELECT \n        user_id,\n        count() AS event_count,\n        avg(count()) OVER () AS avg_event_count\n    FROM events\n    GROUP BY user_id\n)\nWHERE event_count > avg_event_count\nORDER BY event_count DESC",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 360,
      "tokens_out": 3879,
      "cost_usd": 0.0095256,
      "latency_ms": 73299.4
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_06",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 139299\t2024-10-01 00:00:42.000\t7817\tclick\t/docs\t646\t{'source':'email'}\t['mobile']\tBR\tmobile\t7523\n509",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 363,
      "tokens_out": 375,
      "cost_usd": 0.0011178,
      "latency_ms": 7617.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_06",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 139299\t2024-10-01 00:00:42.000\t7817\tclick\t/docs\t646\t{'source':'email'}\t['mobile']\tBR\tmobile\t7523\n509",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 363,
      "tokens_out": 525,
      "cost_usd": 0.0014778,
      "latency_ms": 11260.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_06",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 636202\t2024-05-01 00:07:30.000\t3382\tsignup\t/pricing\t1768\t{'campaign':'black_friday','source':'direct",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 363,
      "tokens_out": 469,
      "cost_usd": 0.0013433999999999998,
      "latency_ms": 9012.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_07",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    avg(e.event_count) AS avg_events_per_user\nFROM users u\nLEFT JOIN (\n    SELECT user_id, count() AS event_count\n    FROM events\n    GROUP BY user_id\n) e ON u.user_id = e.user_id\nGROUP BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 359,
      "tokens_out": 3900,
      "cost_usd": 0.0095754,
      "latency_ms": 72986.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_07",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    avg(COALESCE(e.event_count, 0)) AS avg_events_per_user\nFROM users u\nLEFT JOIN (\n    SELECT user_id, count() AS event_count\n    FROM events\n    GROUP BY user_id\n) e ON u.user_id = e.user_id\nGROUP BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 359,
      "tokens_out": 2687,
      "cost_usd": 0.0066641999999999995,
      "latency_ms": 47558.8
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_07",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    toFloat64(count(e.event_id)) / count(DISTINCT u.user_id) AS avg_events_per_user\nFROM users u\nLEFT JOIN events e ON u.user_id = e.user_id\nGROUP BY u.plan\nORDER BY avg_events_per_user DESC",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 359,
      "tokens_out": 1816,
      "cost_usd": 0.004573799999999999,
      "latency_ms": 33953.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_08",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3\tuser3@example.com\tenterprise\t2024-09-08 08:16:45.000\n7\tuser7@example.com\tfree\t2024-04-19 14:50:53.",
      "llm_sql": "SELECT \n    user_id,\n    email,\n    plan,\n    created_at\nFROM users\nWHERE created_at >= '2024-01-01' \n  AND created_at < '2025-01-01'\n  AND user_id IN (\n    SELECT user_id \n    FROM events \n    WHERE event_type = 'purchase'\n  )",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 362,
      "tokens_out": 1928,
      "cost_usd": 0.0048444,
      "latency_ms": 36526.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_08",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 5130\tuser5130@example.com\tfree\t2024-01-01 01:03:55.000\tUS\n5826\tuser5826@example.com\tfree\t2024-01-01 ",
      "llm_sql": "SELECT user_id, email, plan, created_at, country\nFROM users\nWHERE created_at >= '2024-01-01' \n  AND created_at < '2025-01-01'\n  AND user_id IN (\n    SELECT user_id \n    FROM events \n    WHERE event_type = 'purchase'\n  )\nORDER BY created_at;",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 362,
      "tokens_out": 1877,
      "cost_usd": 0.004722,
      "latency_ms": 34372.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_08",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3\tuser3@example.com\tenterprise\t2024-09-08 08:16:45.000\n7\tuser7@example.com\tfree\t2024-04-19 14:50:53.",
      "llm_sql": "SELECT \n    user_id,\n    email,\n    plan,\n    created_at\nFROM users\nWHERE created_at >= '2024-01-01' \n  AND created_at < '2025-01-01'\n  AND user_id IN (\n    SELECT user_id \n    FROM events \n    WHERE event_type = 'purchase'\n  )",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 362,
      "tokens_out": 1215,
      "cost_usd": 0.0031331999999999996,
      "latency_ms": 23387.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_09",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: JP",
      "llm_sql": "SELECT country\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY count() DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 359,
      "tokens_out": 696,
      "cost_usd": 0.0018858,
      "latency_ms": 13528.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_09",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, COUNT(*) AS pro_user_count\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY pro_user_count DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 359,
      "tokens_out": 356,
      "cost_usd": 0.0010697999999999999,
      "latency_ms": 7089.6
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_09",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS pro_user_count\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY pro_user_count DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 359,
      "tokens_out": 303,
      "cost_usd": 0.0009425999999999999,
      "latency_ms": 6446.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_10",
      "tier": 4,
      "run": 1,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 184. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function max(event_count) AS event_count is found inside another aggr",
      "llm_sql": "SELECT \n    device,\n    argMax(user_id, event_count) AS user_id,\n    max(event_count) AS event_count\nFROM (\n    SELECT device, user_id, count() AS event_count\n    FROM events\n    GROUP BY device, user_id\n)\nGROUP BY device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 358,
      "tokens_out": 2037,
      "cost_usd": 0.005103600000000001,
      "latency_ms": 37412.4
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_10",
      "tier": 4,
      "run": 2,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 184. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function max(event_count) AS event_count is found inside another aggr",
      "llm_sql": "SELECT \n    device,\n    argMax(user_id, event_count) AS user_id,\n    max(event_count) AS event_count\nFROM (\n    SELECT device, user_id, count() AS event_count\n    FROM events\n    GROUP BY device, user_id\n)\nGROUP BY device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 358,
      "tokens_out": 1503,
      "cost_usd": 0.003822,
      "latency_ms": 27916.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t4_10",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t3118\t56",
      "llm_sql": "SELECT \n    device, \n    user_id, \n    count() AS event_count\nFROM events\nGROUP BY device, user_id\nORDER BY device, event_count DESC\nLIMIT 1 BY device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 358,
      "tokens_out": 2514,
      "cost_usd": 0.0062483999999999994,
      "latency_ms": 45886.6
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_01",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 276842\t2024-02-24 21:54:05.000\t8169\tpageview\t/pricing\t\\N\t{'source':'direct'}\t[]\tFR\tdesktop\t\\N\t12\n891",
      "llm_sql": "SELECT\n    *,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp, event_id) AS event_seq\nFROM events",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 360,
      "tokens_out": 869,
      "cost_usd": 0.0023016,
      "latency_ms": 16880.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_01",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 39540\t1\t2024-01-01 13:38:42.000\tlogout\t1\n723127\t1\t2024-01-08 14:54:29.000\tpageview\t2\n203391\t1\t2024-0",
      "llm_sql": "SELECT\n    event_id,\n    user_id,\n    timestamp,\n    event_type,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp, event_id) AS event_sequence\nFROM events\nORDER BY user_id, event_sequence",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 360,
      "tokens_out": 712,
      "cost_usd": 0.0019248,
      "latency_ms": 12969.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_01",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 260421\t2024-07-10 04:01:15.000\t8205\tpageview\t/blog\t\\N\t{'source':'google'}\t['premium_user','mobile']\t",
      "llm_sql": "SELECT\n    *,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_number\nFROM events",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 360,
      "tokens_out": 780,
      "cost_usd": 0.002088,
      "latency_ms": 14404.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_02",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_date,\n    daily_count,\n    sum(daily_count) OVER (ORDER BY event_date) AS running_total\nFROM (\n    SELECT toDate(timestamp) AS event_date, count() AS daily_count\n    FROM events\n    WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\n    GROUP BY event_date\n)\nORDER BY event_date",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 358,
      "tokens_out": 3005,
      "cost_usd": 0.0074268,
      "latency_ms": 54562.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_02",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS daily_events,\n    sum(count()) OVER (ORDER BY toDate(timestamp)) AS running_total\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 358,
      "tokens_out": 946,
      "cost_usd": 0.0024852000000000003,
      "latency_ms": 18041.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_02",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS date,\n    count() AS daily_events,\n    sum(count()) OVER (ORDER BY date) AS running_total\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY date\nORDER BY date",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 358,
      "tokens_out": 1612,
      "cost_usd": 0.0040836,
      "latency_ms": 28913.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_03",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    date,\n    event_count,\n    lag(event_count) OVER (ORDER BY date) AS prev_day_count\nFROM (\n    SELECT \n        toDate(timestamp) AS date,\n        count() AS event_count\n    FROM events\n    GROUP BY date\n)\nORDER BY date",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 363,
      "tokens_out": 775,
      "cost_usd": 0.0020778000000000003,
      "latency_ms": 14575.8
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_03",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count,\n    lag(event_count) OVER (ORDER BY day) AS prev_day_count\nFROM events\nGROUP BY day\nORDER BY day",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 363,
      "tokens_out": 1237,
      "cost_usd": 0.0031866,
      "latency_ms": 23361.3
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_03",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    day,\n    event_count,\n    lag(event_count) OVER (ORDER BY day) AS prev_day_event_count\nFROM (\n    SELECT toDate(timestamp) AS day, count() AS event_count\n    FROM events\n    GROUP BY day\n)\nORDER BY day",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 363,
      "tokens_out": 1168,
      "cost_usd": 0.003021,
      "latency_ms": 21191.7
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_04",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 945636\t2024-01-01 00:00:05.000\t3091\tpageview\t[]\n63890\t2024-01-01 00:00:24.000\t93\tsignup\t[]\n953423\t20",
      "llm_sql": "SELECT \n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    arrayMap(tag -> upper(tag), tags) AS tags_uppercase\nFROM events\nLIMIT 100;",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 358,
      "tokens_out": 502,
      "cost_usd": 0.0014195999999999998,
      "latency_ms": 9989.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_04",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 669632\t['MOBILE']\n270475\t[]\n368743\t['PROMO']\n863110\t[]\n322580\t['MOBILE']\n806033\t[]\n223705\t[]\n385534\t",
      "llm_sql": "SELECT \n    event_id,\n    arrayMap(tag -> upper(tag), tags) AS tags_upper\nFROM events",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 358,
      "tokens_out": 805,
      "cost_usd": 0.0021468000000000004,
      "latency_ms": 14803.6
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_04",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t[]\n774716\t[]\n531475\t[]\n303997\t[]\n349664\t['VIP_MEMBER']\n452256\t[]\n1021\t[]\n559929\t[]\n512911\t[]\n",
      "llm_sql": "SELECT \n    event_id,\n    arrayMap(x -> upper(x), tags) AS upper_tags\nFROM events",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 358,
      "tokens_out": 499,
      "cost_usd": 0.0014123999999999999,
      "latency_ms": 9394.5
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_05",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration) AS user_id,\n    max(total_duration) AS longest_duration_ms\nFROM (\n    SELECT\n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 363,
      "tokens_out": 1551,
      "cost_usd": 0.0039402,
      "latency_ms": 27914.8
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_05",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: logout\t3812\nsignup\t8908\npurchase\t7125\nclick\t1371\npageview\t2833",
      "llm_sql": "SELECT \n    event_type,\n    argMax(user_id, total_duration) AS user_id\nFROM (\n    SELECT \n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 363,
      "tokens_out": 2113,
      "cost_usd": 0.005289,
      "latency_ms": 38114.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_05",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    argMax(user_id, total_duration) AS user_id,\n    max(total_duration) AS total_duration_ms\nFROM (\n    SELECT \n        event_type,\n        user_id,\n        sum(COALESCE(duration_ms, 0)) AS total_duration\n    FROM events\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 363,
      "tokens_out": 1282,
      "cost_usd": 0.0032946,
      "latency_ms": 22693.8
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_06",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day WITH FILL FROM toDate('2024-01-01') TO toDate('2024-02-01') STEP 1",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 365,
      "tokens_out": 920,
      "cost_usd": 0.002427,
      "latency_ms": 16434.3
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_06",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day\nWITH FILL FROM toDate('2024-01-01') TO toDate('2024-02-01') STEP 1",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 365,
      "tokens_out": 1491,
      "cost_usd": 0.0037974000000000003,
      "latency_ms": 25338.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_06",
      "tier": 5,
      "run": 3,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 475. DB::Exception: Received from localhost:9000. DB::Exception: Sort FILL FROM expression must be constant with numeric type. Actual: '2024-01-",
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY day\nORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP 1",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 365,
      "tokens_out": 1694,
      "cost_usd": 0.0042846,
      "latency_ms": 29118.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_07",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t['click','click','click','click','click','click','click','click','click','click','click','click','",
      "llm_sql": "SELECT \n    user_id,\n    arraySort(groupArray(event_type)) AS event_types\nFROM events\nGROUP BY user_id\nORDER BY user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 359,
      "tokens_out": 1116,
      "cost_usd": 0.0028938,
      "latency_ms": 20214.9
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_07",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 9529\t['click','logout','pageview','purchase','signup']\n1627\t['click','logout','pageview','purchase',",
      "llm_sql": "SELECT \n    u.user_id,\n    arraySort(groupUniqArray(e.event_type)) AS event_types\nFROM users u\nLEFT JOIN events e ON u.user_id = e.user_id\nGROUP BY u.user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 359,
      "tokens_out": 2762,
      "cost_usd": 0.0068442,
      "latency_ms": 48958.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_07",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t['click','logout','pageview','purchase','signup']\n9529\t['click','logout','pageview','purchase',",
      "llm_sql": "SELECT \n    user_id,\n    arraySort(groupUniqArray(event_type)) AS event_types\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 359,
      "tokens_out": 2145,
      "cost_usd": 0.0053634,
      "latency_ms": 40288.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_08",
      "tier": 5,
      "run": 1,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 184. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function max(timestamp) AS timestamp is found inside another aggregat",
      "llm_sql": "SELECT \n    user_id,\n    argMax(event_id, timestamp) AS event_id,\n    argMax(event_type, timestamp) AS event_type,\n    argMax(page, timestamp) AS page,\n    max(timestamp) AS timestamp\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 356,
      "tokens_out": 1450,
      "cost_usd": 0.0036936,
      "latency_ms": 26376.4
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_08",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1515\t216255\t2024-12-25 09:18:13.000\tsignup\t/home\t\\N\t{'campaign':'black_friday','source':'direct'}\t[]",
      "llm_sql": "SELECT \n    user_id,\n    latest_event.1 AS event_id,\n    latest_event.2 AS timestamp,\n    latest_event.3 AS event_type,\n    latest_event.4 AS page,\n    latest_event.5 AS duration_ms,\n    latest_event.6 AS properties,\n    latest_event.7 AS tags,\n    latest_event.8 AS country,\n    latest_event.9 AS device,\n    latest_event.10 AS revenue_cents\nFROM (\n    SELECT \n        user_id,\n        argMax((event_id, timestamp, event_type, page, duration_ms, properties, tags, country, device, revenue_cents), ti",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 356,
      "tokens_out": 2374,
      "cost_usd": 0.0059112,
      "latency_ms": 39450.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_08",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t364030\t2024-12-23 03:49:15.000\tclick\t/pricing\t2519\t{'source':'facebook'}\t[]\tGB\tdesktop\t1479\n2\t1902",
      "llm_sql": "SELECT\n    user_id,\n    latest_event.1 AS event_id,\n    latest_event.2 AS timestamp,\n    latest_event.3 AS event_type,\n    latest_event.4 AS page,\n    latest_event.5 AS duration_ms,\n    latest_event.6 AS properties,\n    latest_event.7 AS tags,\n    latest_event.8 AS country,\n    latest_event.9 AS device,\n    latest_event.10 AS revenue_cents\nFROM (\n    SELECT\n        user_id,\n        argMax((event_id, timestamp, event_type, page, duration_ms, properties, tags, country, device, revenue_cents), time",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 356,
      "tokens_out": 3350,
      "cost_usd": 0.0082536,
      "latency_ms": 60401.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_09",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 0\t110\n1\t109\n2\t124\n3\t103\n4\t127\n5\t103\n6\t118\n7\t128\n8\t113\n9\t123\n10\t122\n11\t126\n12\t116\n13\t116\n14\t113\n15\t94",
      "llm_sql": "SELECT \n    h.number AS hour,\n    count(e.event_id) AS event_count\nFROM numbers(24) AS h\nLEFT JOIN (\n    SELECT event_id, toHour(timestamp) AS hour\n    FROM events\n    WHERE toDate(timestamp) = '2024-06-15'\n) AS e ON e.hour = h.number\nGROUP BY h.number\nORDER BY h.number",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 370,
      "tokens_out": 1862,
      "cost_usd": 0.0046908,
      "latency_ms": 33677.0
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_09",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    hours.hour,\n    count(e.event_id) as event_count\nFROM (\n    SELECT toStartOfHour(toDateTime('2024-06-15') + number * 3600) as hour\n    FROM numbers(24)\n) hours\nLEFT JOIN events e ON toStartOfHour(e.timestamp) = hours.hour \n    AND toDate(e.timestamp) = '2024-06-15'\nGROUP BY hours.hour\nORDER BY hours.hour",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 370,
      "tokens_out": 1609,
      "cost_usd": 0.0040836,
      "latency_ms": 29427.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_09",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 0\t110\n1\t109\n2\t124\n3\t103\n4\t127\n5\t103\n6\t118\n7\t128\n8\t113\n9\t123\n10\t122\n11\t126\n12\t116\n13\t116\n14\t113\n15\t94",
      "llm_sql": "SELECT \n    h.hour,\n    COALESCE(ec.event_count, 0) AS event_count\nFROM (\n    SELECT number AS hour \n    FROM numbers(24)\n) h\nLEFT JOIN (\n    SELECT toHour(timestamp) AS hour, count() AS event_count\n    FROM events\n    WHERE toDate(timestamp) = '2024-06-15'\n    GROUP BY hour\n) ec ON h.hour = ec.hour\nORDER BY h.hour",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 370,
      "tokens_out": 1044,
      "cost_usd": 0.0027275999999999997,
      "latency_ms": 18916.1
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_10",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\tuser1@example.com\tfree\t['premium_user']\n2\tuser2@example.com\tenterprise\t['premium_user']\n3\tuser3@ex",
      "llm_sql": "SELECT \n    u.user_id,\n    u.email,\n    u.plan,\n    pt.premium_tags\nFROM users u\nJOIN (\n    SELECT \n        user_id,\n        arrayFilter(tag -> tag ILIKE '%premium%', groupUniqArrayArray(tags)) AS premium_tags\n    FROM events\n    GROUP BY user_id\n    HAVING length(premium_tags) > 0\n) pt ON u.user_id = pt.user_id",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 374,
      "tokens_out": 4494,
      "cost_usd": 0.01101,
      "latency_ms": 77912.3
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_10",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t['premium_user']\n9529\t['premium_user']\n6122\t['premium_user']\n5600\t['premium_user']\n1105\t['premi",
      "llm_sql": "SELECT \n    user_id,\n    arrayDistinct(arrayFilter(tag -> tag LIKE '%premium%', groupArrayArray(tags))) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING length(premium_tags) > 0",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 374,
      "tokens_out": 1698,
      "cost_usd": 0.0042996,
      "latency_ms": 28983.2
    },
    {
      "model": "kimi-k2.5",
      "question_id": "t5_10",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t['premium_user']\n9529\t['premium_user']\n6122\t['premium_user']\n5600\t['premium_user']\n1105\t['premi",
      "llm_sql": "SELECT \n    user_id,\n    arrayDistinct(arrayFilter(tag -> tag LIKE '%premium%', groupArrayArray(tags))) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING length(premium_tags) > 0",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 374,
      "tokens_out": 2304,
      "cost_usd": 0.005753999999999999,
      "latency_ms": 42160.0
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_01",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events;",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 370,
      "tokens_out": 38,
      "cost_usd": 0.000261,
      "latency_ms": 1796
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_01",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events;",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 370,
      "tokens_out": 36,
      "cost_usd": 0.000257,
      "latency_ms": 1129
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_01",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events;",
      "reference_sql": "SELECT count() FROM events",
      "tokens_in": 370,
      "tokens_out": 53,
      "cost_usd": 0.000291,
      "latency_ms": 2011
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_02",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 369,
      "tokens_out": 96,
      "cost_usd": 0.0003765,
      "latency_ms": 1273
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_02",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 369,
      "tokens_out": 70,
      "cost_usd": 0.0003245,
      "latency_ms": 1933
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_02",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nORDER BY timestamp DESC\nLIMIT 10",
      "reference_sql": "SELECT * FROM events ORDER BY timestamp DESC LIMIT 10",
      "tokens_in": 369,
      "tokens_out": 45,
      "cost_usd": 0.0002745,
      "latency_ms": 1411
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_03",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 371,
      "tokens_out": 201,
      "cost_usd": 0.0005875,
      "latency_ms": 2291
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_03",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS event_count\nFROM events\nWHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 371,
      "tokens_out": 152,
      "cost_usd": 0.0004895,
      "latency_ms": 1053
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_03",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count(*)\nFROM events\nWHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "reference_sql": "SELECT count() FROM events WHERE timestamp >= '2024-03-01' AND timestamp < '2024-04-01'",
      "tokens_in": 371,
      "tokens_out": 275,
      "cost_usd": 0.0007355,
      "latency_ms": 1938
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_04",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type;",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 367,
      "tokens_out": 44,
      "cost_usd": 0.0002715,
      "latency_ms": 1131
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_04",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events;",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 367,
      "tokens_out": 80,
      "cost_usd": 0.0003435,
      "latency_ms": 1076
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_04",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT event_type FROM events;",
      "reference_sql": "SELECT DISTINCT event_type FROM events ORDER BY event_type",
      "tokens_in": 367,
      "tokens_out": 58,
      "cost_usd": 0.0002995,
      "latency_ms": 1600
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_05",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count(*) FROM events WHERE country = 'DE';",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 368,
      "tokens_out": 114,
      "cost_usd": 0.000412,
      "latency_ms": 2041
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_05",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count(*) FROM events WHERE country = 'DE';",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 368,
      "tokens_out": 62,
      "cost_usd": 0.000308,
      "latency_ms": 1269
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_05",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count(*) FROM events WHERE country = 'DE';",
      "reference_sql": "SELECT count() FROM events WHERE country = 'DE'",
      "tokens_in": 368,
      "tokens_out": 82,
      "cost_usd": 0.000348,
      "latency_ms": 1856
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_06",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 376,
      "tokens_out": 121,
      "cost_usd": 0.00043,
      "latency_ms": 1509
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_06",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 376,
      "tokens_out": 140,
      "cost_usd": 0.000468,
      "latency_ms": 1667
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_06",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp ASC\nLIMIT 5",
      "reference_sql": "SELECT * FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 5",
      "tokens_in": 376,
      "tokens_out": 107,
      "cost_usd": 0.000402,
      "latency_ms": 1101
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_07",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM users WHERE plan = 'pro';",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 372,
      "tokens_out": 127,
      "cost_usd": 0.00044,
      "latency_ms": 1018
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_07",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS users_on_pro_plan\nFROM users\nWHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 372,
      "tokens_out": 78,
      "cost_usd": 0.000342,
      "latency_ms": 1590
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_07",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() AS pro_users\nFROM users\nWHERE plan = 'pro'",
      "reference_sql": "SELECT count() FROM users WHERE plan = 'pro'",
      "tokens_in": 372,
      "tokens_out": 83,
      "cost_usd": 0.000352,
      "latency_ms": 1084
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_08",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT MIN(timestamp) AS earliest, MAX(timestamp) AS latest FROM events;",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 370,
      "tokens_out": 92,
      "cost_usd": 0.000369,
      "latency_ms": 1372
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_08",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT MIN(timestamp) AS earliest_event, MAX(timestamp) AS latest_event FROM events;",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 370,
      "tokens_out": 66,
      "cost_usd": 0.000317,
      "latency_ms": 6553
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_08",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT MIN(timestamp) AS earliest_event, MAX(timestamp) AS latest_event FROM events;",
      "reference_sql": "SELECT min(timestamp) AS earliest, max(timestamp) AS latest FROM events",
      "tokens_in": 370,
      "tokens_out": 74,
      "cost_usd": 0.000333,
      "latency_ms": 10327
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_09",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01'\n  AND timestamp < '2025-01-01'\nORDER BY timestamp",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 374,
      "tokens_out": 222,
      "cost_usd": 0.000631,
      "latency_ms": 2584
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_09",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id = 42\n  AND timestamp >= '2024-01-01 00:00:00'\n  AND timestamp < '2025-01-01 00:00:00'\nORDER BY timestamp;",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 374,
      "tokens_out": 138,
      "cost_usd": 0.000463,
      "latency_ms": 1040
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_09",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "reference_sql": "SELECT * FROM events WHERE user_id = 42 AND timestamp >= '2024-01-01' AND timestamp < '2025-01-01' ORDER BY timestamp",
      "tokens_in": 374,
      "tokens_out": 385,
      "cost_usd": 0.000957,
      "latency_ms": 1286
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_10",
      "tier": 1,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 371,
      "tokens_out": 127,
      "cost_usd": 0.0004395,
      "latency_ms": 1766
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_10",
      "tier": 1,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL;",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 371,
      "tokens_out": 91,
      "cost_usd": 0.0003675,
      "latency_ms": 1215
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t1_10",
      "tier": 1,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count(duration_ms) FROM events;",
      "reference_sql": "SELECT count() FROM events WHERE duration_ms IS NOT NULL",
      "tokens_in": 371,
      "tokens_out": 138,
      "cost_usd": 0.0004615,
      "latency_ms": 1421
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_01",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count() AS cnt\nFROM events\nGROUP BY event_type\nORDER BY cnt DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 373,
      "tokens_out": 120,
      "cost_usd": 0.0004265,
      "latency_ms": 1044
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_01",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count() AS cnt\nFROM events\nGROUP BY event_type\nORDER BY cnt DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 373,
      "tokens_out": 63,
      "cost_usd": 0.0003125,
      "latency_ms": 1087
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_01",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count() AS cnt\nFROM events\nGROUP BY event_type\nORDER BY cnt DESC",
      "reference_sql": "SELECT event_type, count() AS cnt FROM events GROUP BY event_type ORDER BY cnt DESC",
      "tokens_in": 373,
      "tokens_out": 148,
      "cost_usd": 0.0004825,
      "latency_ms": 1170
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_02",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    device,\n    avg(duration_ms) AS avg_duration_ms\nFROM events\nGROUP BY device",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 371,
      "tokens_out": 148,
      "cost_usd": 0.0004815,
      "latency_ms": 974
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_02",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    device,\n    avg(duration_ms) AS avg_duration_ms\nFROM events\nGROUP BY device",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 371,
      "tokens_out": 139,
      "cost_usd": 0.0004635,
      "latency_ms": 1583
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_02",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    device,\n    avg(duration_ms) AS avg_duration_ms\nFROM events\nGROUP BY device\nORDER BY device;",
      "reference_sql": "SELECT device, avg(duration_ms) AS avg_duration FROM events GROUP BY device ORDER BY avg_duration DESC",
      "tokens_in": 371,
      "tokens_out": 146,
      "cost_usd": 0.0004775,
      "latency_ms": 10237
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_03",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toDate(timestamp) AS date, count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY toDate(timestamp)\nORDER BY date;",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 374,
      "tokens_out": 191,
      "cost_usd": 0.000569,
      "latency_ms": 10271
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_03",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toDate(timestamp) AS date, COUNT(*) AS events\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY toDate(timestamp)\nORDER BY date",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 374,
      "tokens_out": 235,
      "cost_usd": 0.000657,
      "latency_ms": 4095
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_03",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS date,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY toDate(timestamp)\nORDER BY date",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day",
      "tokens_in": 374,
      "tokens_out": 269,
      "cost_usd": 0.000725,
      "latency_ms": 1068
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_04",
      "tier": 2,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: IN\nGB\nNL\nCA\nAU\nBR\nUS\nDE\nJP\nFR",
      "llm_sql": "SELECT country\nFROM events\nGROUP BY country\nHAVING count(*) > 10000",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 371,
      "tokens_out": 129,
      "cost_usd": 0.0004435,
      "latency_ms": 1141
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_04",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT country, count() AS event_count\nFROM events\nGROUP BY country\nHAVING event_count > 10000\nORDER BY event_count DESC",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 371,
      "tokens_out": 167,
      "cost_usd": 0.0005195,
      "latency_ms": 1163
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_04",
      "tier": 2,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: AU\nBR\nCA\nDE\nFR\nGB\nIN\nJP\nNL\nUS",
      "llm_sql": "SELECT country\nFROM events\nGROUP BY country\nHAVING count() > 10000\nORDER BY country;",
      "reference_sql": "SELECT country, count() AS cnt FROM events GROUP BY country HAVING cnt > 10000 ORDER BY cnt DESC",
      "tokens_in": 371,
      "tokens_out": 259,
      "cost_usd": 0.0007035,
      "latency_ms": 1318
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_05",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toHour(timestamp) AS hour, count(*) AS event_count\nFROM events\nGROUP BY toHour(timestamp)\nORDER BY hour",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 372,
      "tokens_out": 217,
      "cost_usd": 0.00062,
      "latency_ms": 1151
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_05",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toHour(timestamp) AS hour, count() AS event_count\nFROM events\nGROUP BY hour\nORDER BY hour",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 372,
      "tokens_out": 157,
      "cost_usd": 0.0005,
      "latency_ms": 1214
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_05",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT toHour(timestamp) AS hour, count(*) AS event_count\nFROM events\nGROUP BY toHour(timestamp)\nORDER BY hour;",
      "reference_sql": "SELECT toHour(timestamp) AS hour, count() AS cnt FROM events GROUP BY hour ORDER BY hour",
      "tokens_in": 372,
      "tokens_out": 221,
      "cost_usd": 0.000628,
      "latency_ms": 1047
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_06",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE event_type = 'pageview'",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 375,
      "tokens_out": 246,
      "cost_usd": 0.0006795,
      "latency_ms": 1156
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_06",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE event_type = 'pageview'",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 375,
      "tokens_out": 150,
      "cost_usd": 0.0004875,
      "latency_ms": 1297
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_06",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT avg(duration_ms) AS avg_duration_ms\nFROM events\nWHERE event_type = 'pageview';",
      "reference_sql": "SELECT avgIf(duration_ms, event_type = 'pageview') AS avg_pageview_duration FROM events",
      "tokens_in": 375,
      "tokens_out": 152,
      "cost_usd": 0.0004915,
      "latency_ms": 1124
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_07",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toStartOfMonth(timestamp) AS month,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY toStartOfMonth(timestamp)\nORDER BY month ASC",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 371,
      "tokens_out": 230,
      "cost_usd": 0.0006455,
      "latency_ms": 1367
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_07",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toStartOfMonth(timestamp) AS month,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY month\nORDER BY month",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 371,
      "tokens_out": 135,
      "cost_usd": 0.0004555,
      "latency_ms": 1227
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_07",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toStartOfMonth(timestamp) AS month,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY month\nORDER BY month;",
      "reference_sql": "SELECT toStartOfMonth(timestamp) AS month, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY month ORDER BY month",
      "tokens_in": 371,
      "tokens_out": 142,
      "cost_usd": 0.0004695,
      "latency_ms": 1044
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_08",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count(distinct country) AS distinct_countries\nFROM events\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 373,
      "tokens_out": 113,
      "cost_usd": 0.0004125,
      "latency_ms": 1103
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_08",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count(distinct country) AS distinct_countries\nFROM events\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 373,
      "tokens_out": 110,
      "cost_usd": 0.0004065,
      "latency_ms": 1053
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_08",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT event_type, count(distinct country) AS distinct_countries\nFROM events\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, uniq(country) AS country_count FROM events GROUP BY event_type ORDER BY country_count DESC",
      "tokens_in": 373,
      "tokens_out": 87,
      "cost_usd": 0.0003605,
      "latency_ms": 1594
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_09",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    country,\n    sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL AND country IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 375,
      "tokens_out": 253,
      "cost_usd": 0.0006935,
      "latency_ms": 1362
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_09",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    country,\n    sum(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC;",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 375,
      "tokens_out": 201,
      "cost_usd": 0.0005895,
      "latency_ms": 1126
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_09",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    country,\n    SUM(revenue_cents) AS total_revenue_cents\nFROM events\nWHERE revenue_cents IS NOT NULL\n  AND country IS NOT NULL\nGROUP BY country\nORDER BY total_revenue_cents DESC",
      "reference_sql": "SELECT country, sum(revenue_cents) AS total_revenue FROM events WHERE revenue_cents IS NOT NULL GROUP BY country ORDER BY total_revenue DESC",
      "tokens_in": 375,
      "tokens_out": 232,
      "cost_usd": 0.0006515,
      "latency_ms": 8930
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_10",
      "tier": 2,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    countIf(event_type = 'purchase') AS purchase_count,\n    countIf(event_type = 'pageview') AS pageview_count\nFROM events\nWHERE event_type IN ('purchase', 'pageview');",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 375,
      "tokens_out": 109,
      "cost_usd": 0.0004055,
      "latency_ms": 1122
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_10",
      "tier": 2,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    countIf(event_type = 'purchase') AS purchase_events,\n    countIf(event_type = 'pageview') AS pageview_events\nFROM events;",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 375,
      "tokens_out": 104,
      "cost_usd": 0.0003955,
      "latency_ms": 1513
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t2_10",
      "tier": 2,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    countIf(event_type = 'purchase') AS purchase_events,\n    countIf(event_type = 'pageview') AS pageview_events\nFROM events\nWHERE event_type IN ('purchase', 'pageview');",
      "reference_sql": "SELECT countIf(event_type = 'purchase') AS purchases, countIf(event_type = 'pageview') AS pageviews FROM events",
      "tokens_in": 375,
      "tokens_out": 91,
      "cost_usd": 0.0003695,
      "latency_ms": 973
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_01",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT median(duration_ms) AS median_duration_ms FROM events;",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 371,
      "tokens_out": 198,
      "cost_usd": 0.0005815,
      "latency_ms": 1454
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_01",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT median(duration_ms) AS median_duration_ms\nFROM events;",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 371,
      "tokens_out": 242,
      "cost_usd": 0.0006695,
      "latency_ms": 1218
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_01",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration_ms\nFROM events;",
      "reference_sql": "SELECT quantile(0.5)(duration_ms) AS median_duration FROM events",
      "tokens_in": 371,
      "tokens_out": 233,
      "cost_usd": 0.0006515,
      "latency_ms": 1003
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_02",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count(distinct user_id) FROM events",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 373,
      "tokens_out": 81,
      "cost_usd": 0.0003485,
      "latency_ms": 1467
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_02",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT COUNT(DISTINCT user_id) FROM events;",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 373,
      "tokens_out": 107,
      "cost_usd": 0.0004005,
      "latency_ms": 1663
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_02",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT count(DISTINCT user_id) FROM events;",
      "reference_sql": "SELECT uniqExact(user_id) AS exact_unique_users FROM events",
      "tokens_in": 373,
      "tokens_out": 97,
      "cost_usd": 0.0003805,
      "latency_ms": 1183
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_03",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 39071\t2024-07-01 00:04:45.000\t8058\tpurchase\t/pricing\t1864\t{'campaign':'spring_promo','source':'faceb",
      "llm_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') = 1",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 374,
      "tokens_out": 207,
      "cost_usd": 0.000601,
      "latency_ms": 1380
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_03",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 553579\t2024-03-01 00:00:32.000\t1637\tsignup\t/dashboard\t\\N\t{'campaign':'launch','source':'google'}\t[]\t",
      "llm_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') = 1",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 374,
      "tokens_out": 179,
      "cost_usd": 0.000545,
      "latency_ms": 1085
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_03",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 566193\t2024-05-01 00:01:55.000\t2505\tsignup\t/dashboard\t9494\t{'campaign':'black_friday','source':'twit",
      "llm_sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
      "reference_sql": "SELECT * FROM events WHERE mapContains(properties, 'campaign') ORDER BY timestamp LIMIT 100",
      "tokens_in": 374,
      "tokens_out": 138,
      "cost_usd": 0.000463,
      "latency_ms": 935
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_04",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 382,
      "tokens_out": 130,
      "cost_usd": 0.000451,
      "latency_ms": 1084
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_04",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 382,
      "tokens_out": 122,
      "cost_usd": 0.000435,
      "latency_ms": 1368
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_04",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect",
      "llm_sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp, event_id\nLIMIT 10",
      "reference_sql": "SELECT event_id, properties['source'] AS source FROM events WHERE event_type = 'purchase' ORDER BY timestamp LIMIT 10",
      "tokens_in": 382,
      "tokens_out": 411,
      "cost_usd": 0.001013,
      "latency_ms": 1046
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_05",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    tag,\n    count() AS tag_count\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY tag_count DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 381,
      "tokens_out": 187,
      "cost_usd": 0.0005645,
      "latency_ms": 1589
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_05",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    tag,\n    count() AS count\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY count DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 381,
      "tokens_out": 184,
      "cost_usd": 0.0005585,
      "latency_ms": 1284
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_05",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    tag,\n    count(*) AS count\nFROM events\nARRAY JOIN tags AS tag\nGROUP BY tag\nORDER BY count DESC",
      "reference_sql": "SELECT tag, count() AS cnt FROM events ARRAY JOIN tags AS tag GROUP BY tag ORDER BY cnt DESC",
      "tokens_in": 381,
      "tokens_out": 173,
      "cost_usd": 0.0005365,
      "latency_ms": 1402
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_06",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 985551\t2024-10-01 00:02:49.000\t6618\tpageview\t/settings\t\\N\t{'source':'facebook'}\t['promo']\tFR\tmobile\t",
      "llm_sql": "SELECT * FROM events WHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 376,
      "tokens_out": 157,
      "cost_usd": 0.000502,
      "latency_ms": 1137
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_06",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 877989\t2024-12-01 00:09:55.000\t6543\tpageview\t/home\t9658\t{'source':'direct'}\t['promo']\tFR\tdesktop\t\\N\n",
      "llm_sql": "SELECT * FROM events WHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 376,
      "tokens_out": 243,
      "cost_usd": 0.000674,
      "latency_ms": 1131
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_06",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 514447\t2024-07-01 00:01:18.000\t7003\tpurchase\t/dashboard\t4455\t{'source':'twitter'}\t['promo','mobile']",
      "llm_sql": "SELECT * FROM events WHERE has(tags, 'promo')",
      "reference_sql": "SELECT * FROM events WHERE has(tags, 'promo') ORDER BY timestamp LIMIT 100",
      "tokens_in": 376,
      "tokens_out": 197,
      "cost_usd": 0.000582,
      "latency_ms": 1040
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_07",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    quantile(0.9)(duration_ms) AS p90,\n    quantile(0.99)(duration_ms) AS p99\nFROM events\nWHERE duration_ms IS NOT NULL\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 377,
      "tokens_out": 325,
      "cost_usd": 0.0008385,
      "latency_ms": 2620
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_07",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    quantile(0.9)(duration_ms) AS p90_duration_ms,\n    quantile(0.99)(duration_ms) AS p99_duration_ms\nFROM events\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 377,
      "tokens_out": 310,
      "cost_usd": 0.0008085,
      "latency_ms": 1077
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_07",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    event_type,\n    quantile(0.9)(duration_ms) AS p90,\n    quantile(0.99)(duration_ms) AS p99\nFROM events\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, quantile(0.9)(duration_ms) AS p90, quantile(0.99)(duration_ms) AS p99 FROM events GROUP BY event_type ORDER BY event_type",
      "tokens_in": 377,
      "tokens_out": 231,
      "cost_usd": 0.0006505,
      "latency_ms": 1295
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_08",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') FROM events;",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 378,
      "tokens_out": 287,
      "cost_usd": 0.000763,
      "latency_ms": 1032
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_08",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') FROM events;",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 378,
      "tokens_out": 216,
      "cost_usd": 0.000621,
      "latency_ms": 1139
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_08",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS total_mobile_revenue_cents FROM events;",
      "reference_sql": "SELECT sumIf(revenue_cents, device = 'mobile') AS mobile_revenue FROM events",
      "tokens_in": 378,
      "tokens_out": 123,
      "cost_usd": 0.000435,
      "latency_ms": 1442
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_09",
      "tier": 3,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 375,
      "tokens_out": 263,
      "cost_usd": 0.0007135,
      "latency_ms": 1002
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_09",
      "tier": 3,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT key\nFROM events\nARRAY JOIN mapKeys(properties) AS key",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 375,
      "tokens_out": 139,
      "cost_usd": 0.0004655,
      "latency_ms": 1754
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_09",
      "tier": 3,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT DISTINCT key\nFROM events\nARRAY JOIN mapKeys(properties) AS key",
      "reference_sql": "SELECT DISTINCT arrayJoin(mapKeys(properties)) AS key FROM events ORDER BY key",
      "tokens_in": 375,
      "tokens_out": 344,
      "cost_usd": 0.0008755,
      "latency_ms": 1197
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_10",
      "tier": 3,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 867916\t2024-01-01 00:05:49.000\t6583\tpageview\t/about\t5290\t{'source':'email'}\t['vip_member']\tNL\tdeskto",
      "llm_sql": "SELECT * FROM events\nWHERE arrayExists(tag -> tag LIKE 'vip%', tags)",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 380,
      "tokens_out": 315,
      "cost_usd": 0.00082,
      "latency_ms": 1362
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_10",
      "tier": 3,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 349664\t2024-12-01 00:01:56.000\t1508\tpageview\t/home\t\\N\t{'source':'google'}\t['vip_member']\tGB\ttablet\t\\",
      "llm_sql": "SELECT * FROM events WHERE arrayExists(tag -> tag LIKE 'vip%', tags)",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 380,
      "tokens_out": 313,
      "cost_usd": 0.000816,
      "latency_ms": 1072
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t3_10",
      "tier": 3,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 349664\t2024-12-01 00:01:56.000\t1508\tpageview\t/home\t\\N\t{'source':'google'}\t['vip_member']\tGB\ttablet\t\\",
      "llm_sql": "SELECT *\nFROM events\nWHERE arrayExists(tag -> startsWith(tag, 'vip'), tags) = 1",
      "reference_sql": "SELECT * FROM events WHERE notEmpty(arrayFilter(x -> x LIKE 'vip%', tags)) ORDER BY timestamp LIMIT 100",
      "tokens_in": 380,
      "tokens_out": 472,
      "cost_usd": 0.001134,
      "latency_ms": 987
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_01",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t/blog\t\\N\t{'source':'facebook'}\t[]\tBR\ttablet\t\\N\tpro\n774716",
      "llm_sql": "SELECT \n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events e\nJOIN users u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 157,
      "cost_usd": 0.0005035,
      "latency_ms": 1470
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_01",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 945636\t2024-01-01 00:00:05.000\t3091\tpageview\t/dashboard\t\\N\t{'source':'facebook'}\t[]\tNL\tmobile\t4485\tf",
      "llm_sql": "SELECT \n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country AS event_country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events e\nJOIN users u ON e.user_id = u.user_id\nORDER BY e.timestamp, e.user_id\nLIMIT 1000",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 220,
      "cost_usd": 0.0006295,
      "latency_ms": 4684
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_01",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 776022\t2024-12-01 00:00:44.000\t4026\tlogout\t/blog\t\\N\t{'source':'facebook'}\t[]\tBR\ttablet\t\\N\tpro\n774716",
      "llm_sql": "SELECT \n    e.event_id,\n    e.timestamp,\n    e.user_id,\n    e.event_type,\n    e.page,\n    e.duration_ms,\n    e.properties,\n    e.tags,\n    e.country,\n    e.device,\n    e.revenue_cents,\n    u.plan\nFROM events e\nJOIN users u ON e.user_id = u.user_id",
      "reference_sql": "SELECT e.event_id, e.timestamp, e.event_type, u.plan FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id ORDER BY e.timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 287,
      "cost_usd": 0.0007635,
      "latency_ms": 1080
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_02",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT u.plan, count(*) AS event_count\nFROM events e\nJOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 368,
      "tokens_out": 130,
      "cost_usd": 0.000444,
      "latency_ms": 1472
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_02",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    count() AS event_count\nFROM events e\nJOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY u.plan ASC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 368,
      "tokens_out": 181,
      "cost_usd": 0.000546,
      "latency_ms": 1014
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_02",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    count(*) AS event_count\nFROM events e\nJOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan\nORDER BY event_count DESC",
      "reference_sql": "SELECT u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY u.plan ORDER BY cnt DESC",
      "tokens_in": 368,
      "tokens_out": 181,
      "cost_usd": 0.000546,
      "latency_ms": 1098
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_03",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT user_id\nFROM users\nWHERE user_id NOT IN (SELECT user_id FROM events)",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 370,
      "tokens_out": 221,
      "cost_usd": 0.000627,
      "latency_ms": 1160
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_03",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM users\nWHERE user_id NOT IN (SELECT user_id FROM events)",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 370,
      "tokens_out": 271,
      "cost_usd": 0.000727,
      "latency_ms": 1354
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_03",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT *\nFROM users\nWHERE user_id NOT IN (SELECT user_id FROM events)",
      "reference_sql": "SELECT u.user_id, u.email FROM users AS u LEFT JOIN events AS e ON u.user_id = e.user_id WHERE e.user_id IS NULL",
      "tokens_in": 370,
      "tokens_out": 190,
      "cost_usd": 0.000565,
      "latency_ms": 932
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_04",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH user_event_counts AS (\n    SELECT user_id, count(*) AS event_count\n    FROM events\n    GROUP BY user_id\n)\nSELECT \n    e.user_id,\n    e.event_count,\n    u.plan\nFROM user_event_counts e\nJOIN users u ON e.user_id = u.user_id\nORDER BY e.event_count DESC\nLIMIT 10",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 380,
      "tokens_out": 236,
      "cost_usd": 0.000662,
      "latency_ms": 1213
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_04",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\tenterprise\t143\n1040\tpro\t138\n7449\tpro\t135\n6726\tpro\t135\n9339\tpro\t134\n4333\tpro\t133\n3566\tenterprise",
      "llm_sql": "WITH user_event_counts AS (\n    SELECT user_id, count() AS event_count\n    FROM events\n    GROUP BY user_id\n)\nSELECT\n    c.user_id,\n    u.plan,\n    c.event_count\nFROM user_event_counts c\nJOIN users u ON c.user_id = u.user_id\nORDER BY c.event_count DESC\nLIMIT 10",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 380,
      "tokens_out": 247,
      "cost_usd": 0.000684,
      "latency_ms": 1165
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_04",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 6396\t143\tenterprise\n1040\t138\tpro\n6726\t135\tpro\n7449\t135\tpro\n9339\t134\tpro\n4333\t133\tpro\n3566\t132\tenterp",
      "llm_sql": "WITH events_per_user AS (\n    SELECT user_id, count() AS event_count\n    FROM events\n    GROUP BY user_id\n)\nSELECT \n    e.user_id,\n    e.event_count,\n    u.plan\nFROM events_per_user e\nJOIN users u ON e.user_id = u.user_id\nORDER BY e.event_count DESC\nLIMIT 10",
      "reference_sql": "WITH top_users AS (SELECT user_id, count() AS cnt FROM events GROUP BY user_id ORDER BY cnt DESC LIMIT 10) SELECT t.user_id, t.cnt, u.plan FROM top_users AS t INNER JOIN users AS u ON t.user_id = u.user_id ORDER BY t.cnt DESC",
      "tokens_in": 380,
      "tokens_out": 269,
      "cost_usd": 0.000728,
      "latency_ms": 1055
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_05",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT user_id, count() AS event_count\nFROM events\nGROUP BY user_id\nHAVING count() > (\n    SELECT avg(cnt)\n    FROM (\n        SELECT count() AS cnt\n        FROM events\n        GROUP BY user_id\n    )\n)",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 376,
      "tokens_out": 323,
      "cost_usd": 0.000834,
      "latency_ms": 1529
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_05",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT user_id, count() AS event_count\nFROM events\nGROUP BY user_id\nHAVING count() > (\n    SELECT avg(cnt)\n    FROM (\n        SELECT count() AS cnt\n        FROM events\n        GROUP BY user_id\n    ) AS t\n)",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 376,
      "tokens_out": 332,
      "cost_usd": 0.000852,
      "latency_ms": 1109
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_05",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "WITH user_event_counts AS (\n    SELECT user_id, count() AS event_count\n    FROM events\n    GROUP BY user_id\n)\nSELECT user_id, event_count\nFROM user_event_counts\nWHERE event_count > (SELECT avg(event_count) FROM user_event_counts)",
      "reference_sql": "SELECT user_id, count() AS cnt FROM events GROUP BY user_id HAVING cnt > (SELECT avg(c) FROM (SELECT count() AS c FROM events GROUP BY user_id))",
      "tokens_in": 376,
      "tokens_out": 314,
      "cost_usd": 0.000816,
      "latency_ms": 1227
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_06",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 850863\t2024-08-01 00:00:37.000\t149\tpageview\t/docs\t9698\t{'source':'facebook'}\t[]\tGB\ttablet\t3393\n98473",
      "llm_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise')",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 128,
      "cost_usd": 0.0004455,
      "latency_ms": 1041
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_06",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 774716\t2024-12-01 00:01:20.000\t1952\tpurchase\t/blog\t1651\t{'source':'facebook'}\t[]\tGB\ttablet\t\\N\n349664",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 93,
      "cost_usd": 0.0003755,
      "latency_ms": 1243
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_06",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 276933\t2024-04-01 00:00:42.000\t5857\tlogout\t/about\t3721\t{'source':'facebook'}\t['vip_member','mobile']",
      "llm_sql": "SELECT *\nFROM events\nWHERE user_id IN (\n    SELECT user_id\n    FROM users\n    WHERE plan = 'enterprise'\n)",
      "reference_sql": "SELECT * FROM events WHERE user_id IN (SELECT user_id FROM users WHERE plan = 'enterprise') ORDER BY timestamp LIMIT 100",
      "tokens_in": 379,
      "tokens_out": 92,
      "cost_usd": 0.0003735,
      "latency_ms": 1027
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_07",
      "tier": 4,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    avg(event_count) AS avg_events_per_user\nFROM (\n    SELECT \n        user_id,\n        count() AS event_count\n    FROM events\n    GROUP BY user_id\n) e\nJOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 375,
      "tokens_out": 279,
      "cost_usd": 0.0007455,
      "latency_ms": 1146
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_07",
      "tier": 4,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    AVG(event_count) AS avg_events_per_user\nFROM (\n    SELECT \n        user_id,\n        count() AS event_count\n    FROM events\n    GROUP BY user_id\n) e\nJOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 375,
      "tokens_out": 232,
      "cost_usd": 0.0006515,
      "latency_ms": 1879
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_07",
      "tier": 4,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    u.plan,\n    count(*) / count(distinct e.user_id) AS avg_events_per_user\nFROM events e\nJOIN users u ON e.user_id = u.user_id\nGROUP BY u.plan",
      "reference_sql": "WITH user_counts AS (SELECT e.user_id, u.plan, count() AS cnt FROM events AS e INNER JOIN users AS u ON e.user_id = u.user_id GROUP BY e.user_id, u.plan) SELECT plan, avg(cnt) AS avg_events_per_user FROM user_counts GROUP BY plan ORDER BY avg_events_per_user DESC",
      "tokens_in": 375,
      "tokens_out": 343,
      "cost_usd": 0.0008735,
      "latency_ms": 972
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_08",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3\t2024-09-08 08:16:45.000\tenterprise\tuser3@example.com\t64\tGB\n7\t2024-04-19 14:50:53.000\tfree\tuser7@ex",
      "llm_sql": "SELECT DISTINCT u.user_id, u.created_at, u.plan, u.email, u.age, u.country\nFROM users u\nINNER JOIN events e ON u.user_id = e.user_id\nWHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01'\nAND e.event_type = 'purchase'\nORDER BY u.user_id",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 378,
      "tokens_out": 553,
      "cost_usd": 0.001295,
      "latency_ms": 1162
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_08",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 8023\t2024-02-01 09:28:35.000\tuser8023@example.com\tfree\n2366\t2024-09-28 01:35:32.000\tuser2366@example",
      "llm_sql": "SELECT u.user_id, u.created_at, u.email, u.plan\nFROM users u\nWHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01'\nAND EXISTS (\n    SELECT 1 FROM events e\n    WHERE e.user_id = u.user_id\n    AND e.event_type = 'purchase'\n)",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 378,
      "tokens_out": 365,
      "cost_usd": 0.000919,
      "latency_ms": 1041
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_08",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 3\t2024-09-08 08:16:45.000\tenterprise\tuser3@example.com\t64\tGB\t{'signup_source':'social'}\n7\t2024-04-19",
      "llm_sql": "SELECT DISTINCT u.*\nFROM users u\nINNER JOIN events e ON u.user_id = e.user_id\nWHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01'\nAND e.event_type = 'purchase'",
      "reference_sql": "SELECT DISTINCT u.user_id, u.email, u.created_at FROM users AS u INNER JOIN events AS e ON u.user_id = e.user_id WHERE u.created_at >= '2024-01-01' AND u.created_at < '2025-01-01' AND e.event_type = 'purchase'",
      "tokens_in": 378,
      "tokens_out": 313,
      "cost_usd": 0.000815,
      "latency_ms": 1517
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_09",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: JP",
      "llm_sql": "SELECT country\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY count() DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 375,
      "tokens_out": 116,
      "cost_usd": 0.0004195,
      "latency_ms": 1244
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_09",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: JP",
      "llm_sql": "SELECT country\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY count(*) DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 375,
      "tokens_out": 129,
      "cost_usd": 0.0004455,
      "latency_ms": 1289
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_09",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: JP",
      "llm_sql": "SELECT country\nFROM users\nWHERE plan = 'pro'\nGROUP BY country\nORDER BY count() DESC\nLIMIT 1",
      "reference_sql": "SELECT country, count() AS cnt FROM users WHERE plan = 'pro' GROUP BY country ORDER BY cnt DESC LIMIT 1",
      "tokens_in": 375,
      "tokens_out": 136,
      "cost_usd": 0.0004595,
      "latency_ms": 999
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_10",
      "tier": 4,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t5365\t56",
      "llm_sql": "SELECT device, user_id, event_count\nFROM (\n    SELECT \n        device,\n        user_id,\n        COUNT(*) AS event_count,\n        ROW_NUMBER() OVER (PARTITION BY device ORDER BY COUNT(*) DESC) AS rn\n    FROM events\n    GROUP BY device, user_id\n)\nWHERE rn = 1\nORDER BY device;",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 374,
      "tokens_out": 304,
      "cost_usd": 0.000795,
      "latency_ms": 1202
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_10",
      "tier": 4,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: tablet\t5365\t56\nmobile\t6726\t59\ndesktop\t8569\t61",
      "llm_sql": "SELECT device, user_id, event_count\nFROM (\n    SELECT \n        device,\n        user_id,\n        count() AS event_count,\n        row_number() OVER (PARTITION BY device ORDER BY count() DESC) AS rn\n    FROM events\n    GROUP BY device, user_id\n)\nWHERE rn = 1",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 374,
      "tokens_out": 439,
      "cost_usd": 0.001065,
      "latency_ms": 1225
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t4_10",
      "tier": 4,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: desktop\t8569\t61\nmobile\t6726\t59\ntablet\t5365\t56",
      "llm_sql": "SELECT device, user_id, event_count\nFROM (\n    SELECT \n        device, \n        user_id, \n        count() AS event_count,\n        row_number() OVER (PARTITION BY device ORDER BY count() DESC) AS rn\n    FROM events\n    GROUP BY device, user_id\n)\nWHERE rn = 1\nORDER BY device",
      "reference_sql": "WITH device_user_counts AS (SELECT device, user_id, count() AS cnt FROM events GROUP BY device, user_id) SELECT device, user_id, cnt FROM device_user_counts WHERE (device, cnt) IN (SELECT device, max(cnt) FROM device_user_counts GROUP BY device) ORDER BY device",
      "tokens_in": 374,
      "tokens_out": 305,
      "cost_usd": 0.000797,
      "latency_ms": 997
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_01",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 560803\t2024-08-17 05:16:20.000\t7567\tpageview\t/dashboard\t\\N\t{'source':'direct'}\t[]\tDE\tmobile\t\\N\t60\n26",
      "llm_sql": "SELECT\n    *,\n    row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_number\nFROM events",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 376,
      "tokens_out": 169,
      "cost_usd": 0.000526,
      "latency_ms": 1041
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_01",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 39540\t2024-01-01 13:38:42.000\t1\tlogout\t/docs\t7001\t{'campaign':'spring_promo','source':'email'}\t[]\tDE",
      "llm_sql": "SELECT\n    *,\n    ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_number\nFROM events\nORDER BY user_id, timestamp",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 376,
      "tokens_out": 182,
      "cost_usd": 0.000552,
      "latency_ms": 1154
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_01",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 582287\t2024-01-01 06:46:48.000\t2\tpurchase\t/blog\t5588\t{'source':'facebook'}\t[]\tFR\ttablet\t\\N\t1\n909023\t",
      "llm_sql": "SELECT \n    event_id,\n    timestamp,\n    user_id,\n    event_type,\n    page,\n    duration_ms,\n    properties,\n    tags,\n    country,\n    device,\n    revenue_cents,\n    ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY timestamp) AS event_seq\nFROM events",
      "reference_sql": "SELECT user_id, event_id, timestamp, row_number() OVER (PARTITION BY user_id ORDER BY timestamp) AS rn FROM events ORDER BY user_id, rn LIMIT 100",
      "tokens_in": 376,
      "tokens_out": 195,
      "cost_usd": 0.000578,
      "latency_ms": 1018
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_02",
      "tier": 5,
      "run": 1,
      "score": 0,
      "error_type": "Syntax Error",
      "error_msg": "Code: 62. DB::Exception: Syntax error: failed at position 97 (BY) (line 4, col 28): BY day)) AS running_total\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY toDate(t",
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS events_per_day,\n    runningSum(over (ORDER BY day)) AS running_total\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY toDate(timestamp)\nORDER BY day ASC",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 374,
      "tokens_out": 267,
      "cost_usd": 0.000721,
      "latency_ms": 1146
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_02",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS events_per_day,\n    sum(count()) OVER (ORDER BY toDate(timestamp)) AS running_total\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY toDate(timestamp)\nORDER BY day",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 374,
      "tokens_out": 261,
      "cost_usd": 0.000709,
      "latency_ms": 994
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_02",
      "tier": 5,
      "run": 3,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT \n    day,\n    events_per_day,\n    sum(events_per_day) OVER (ORDER BY day) AS running_total\nFROM (\n    SELECT \n        toDate(timestamp) AS day,\n        count() AS events_per_day\n    FROM events\n    WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\n    GROUP BY toDate(timestamp)\n)\nORDER BY day;",
      "reference_sql": "SELECT day, daily_cnt, sum(daily_cnt) OVER (ORDER BY day) AS running_total FROM (SELECT toDate(timestamp) AS day, count() AS daily_cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01' GROUP BY day) ORDER BY day",
      "tokens_in": 374,
      "tokens_out": 535,
      "cost_usd": 0.001257,
      "latency_ms": 1039
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_03",
      "tier": 5,
      "run": 1,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS date,\n    count() AS event_count,\n    lag(event_count) OVER (ORDER BY date) AS previous_day_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY toDate(timestamp)\nORDER BY date",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 379,
      "tokens_out": 269,
      "cost_usd": 0.0007275,
      "latency_ms": 8497
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_03",
      "tier": 5,
      "run": 2,
      "score": 3,
      "error_type": null,
      "error_msg": null,
      "llm_sql": "SELECT\n    toDate(timestamp) AS day,\n    count() AS event_count,\n    lag(event_count) OVER (ORDER BY day) AS previous_day_count\nFROM events\nGROUP BY toDate(timestamp)\nORDER BY day",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 379,
      "tokens_out": 229,
      "cost_usd": 0.0006475,
      "latency_ms": 1035
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_03",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01 00:00:00\t2811\t0\n2024-01-02 00:00:00\t2762\t2811\n2024-01-03 00:00:00\t2775\t2762\n2024-01-04 00",
      "llm_sql": "SELECT\n    dateTrunc('day', timestamp) AS day,\n    count() AS event_count,\n    lag(event_count) OVER (ORDER BY day) AS previous_day_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP BY dateTrunc('day', timestamp)\nORDER BY day",
      "reference_sql": "SELECT day, cnt, lag(cnt, 1) OVER (ORDER BY day) AS prev_day_cnt FROM (SELECT toDate(timestamp) AS day, count() AS cnt FROM events GROUP BY day) ORDER BY day",
      "tokens_in": 379,
      "tokens_out": 508,
      "cost_usd": 0.0012055,
      "latency_ms": 1256
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_04",
      "tier": 5,
      "run": 1,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 46. DB::Exception: Received from localhost:9000. DB::Exception: Function with name `toUpper` does not exist. In scope x -> toUpper(x). Maybe you",
      "llm_sql": "SELECT\n    *,\n    arrayMap(x -> toUpper(x), tags) AS tags\nFROM events",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 374,
      "tokens_out": 268,
      "cost_usd": 0.000723,
      "latency_ms": 1907
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_04",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: ['VIP_MEMBER','MOBILE']\n[]\n['VIP_MEMBER']\n['MOBILE']\n[]\n[]\n[]\n['PREMIUM_USER']\n[]\n[]\n[]\n[]\n['PROMO',",
      "llm_sql": "SELECT arrayMap(x -> upper(x), tags) AS tags_uppercase FROM events",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 374,
      "tokens_out": 149,
      "cost_usd": 0.000485,
      "latency_ms": 1114
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_04",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: []\n[]\n[]\n[]\n['VIP_MEMBER']\n[]\n[]\n[]\n[]\n[]\n['VIP_MEMBER','PREMIUM_USER']\n[]\n[]\n[]\n['VIP_MEMBER','MOBI",
      "llm_sql": "SELECT arrayMap(x -> upper(x), tags) AS tags FROM events",
      "reference_sql": "SELECT event_id, arrayMap(x -> upper(x), tags) AS upper_tags FROM events LIMIT 20",
      "tokens_in": 374,
      "tokens_out": 356,
      "cost_usd": 0.000899,
      "latency_ms": 1029
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_05",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: signup\t8908\npurchase\t7125\nlogout\t3812\nclick\t1371\npageview\t2833",
      "llm_sql": "SELECT\n    event_type,\n    argMax(user_id, total_duration) AS user_id\nFROM (\n    SELECT\n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 379,
      "tokens_out": 303,
      "cost_usd": 0.0007955,
      "latency_ms": 1404
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_05",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: logout\t3812\nsignup\t8908\npageview\t2833\npurchase\t7125\nclick\t1371",
      "llm_sql": "SELECT \n    event_type,\n    argMax(user_id, total_duration) AS user_id\nFROM (\n    SELECT \n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 379,
      "tokens_out": 452,
      "cost_usd": 0.0010935,
      "latency_ms": 1127
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_05",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: click\t1371\nlogout\t3812\npageview\t2833\npurchase\t7125\nsignup\t8908",
      "llm_sql": "SELECT \n    event_type,\n    argMax(user_id, total_duration) AS user_id\nFROM (\n    SELECT \n        event_type,\n        user_id,\n        sum(duration_ms) AS total_duration\n    FROM events\n    WHERE duration_ms IS NOT NULL\n    GROUP BY event_type, user_id\n)\nGROUP BY event_type\nORDER BY event_type",
      "reference_sql": "SELECT event_type, argMax(user_id, total_dur) AS top_user, max(total_dur) AS max_duration FROM (SELECT event_type, user_id, sum(duration_ms) AS total_dur FROM events WHERE duration_ms IS NOT NULL GROUP BY event_type, user_id) GROUP BY event_type ORDER BY event_type",
      "tokens_in": 379,
      "tokens_out": 425,
      "cost_usd": 0.0010395,
      "latency_ms": 1015
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_06",
      "tier": 5,
      "run": 1,
      "score": 0,
      "error_type": "Syntax Error",
      "error_msg": "Code: 62. DB::Exception: Syntax error: failed at position 234 (DAY) (line 8, col 68): DAY. Expected one of: token, DoubleColon, OR, AND, IS NOT DISTINCT FROM, IS DISTINCT FROM, IS NULL, IS NOT NULL, B",
      "llm_sql": "SELECT\n    toDate(timestamp) AS date,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY date\nORDER BY date\nWITH FILL FROM toDate('2024-01-01') TO toDate('2024-02-01') STEP 1 DAY",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 381,
      "tokens_out": 558,
      "cost_usd": 0.0013065,
      "latency_ms": 1318
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_06",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-01-01\t2811\n2024-01-02\t2762\n2024-01-03\t2775\n2024-01-04\t2690\n2024-01-05\t2694\n2024-01-06\t2753\n2024",
      "llm_sql": "SELECT\n    toDate(timestamp) AS date,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY toDate(timestamp)\nORDER BY date\nWITH FILL FROM toDate('2024-01-01') TO toDate('2024-01-31')",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 377,
      "tokens_out": 619,
      "cost_usd": 0.0014265,
      "latency_ms": 11910.4
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_06",
      "tier": 5,
      "run": 3,
      "score": 0,
      "error_type": "Syntax Error",
      "error_msg": "Code: 62. DB::Exception: Syntax error: failed at position 235 (DAY) (line 8, col 68): DAY. Expected one of: token, DoubleColon, OR, AND, IS NOT DISTINCT FROM, IS DISTINCT FROM, IS NULL, IS NOT NULL, B",
      "llm_sql": "SELECT \n    toDate(timestamp) AS date,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY date\nORDER BY date\nWITH FILL FROM toDate('2024-01-01') TO toDate('2024-01-31') STEP 1 DAY",
      "reference_sql": "SELECT toDate(timestamp) AS day, count() AS cnt FROM events WHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01' GROUP BY day ORDER BY day WITH FILL FROM '2024-01-01' TO '2024-02-01' STEP INTERVAL 1 DAY",
      "tokens_in": 377,
      "tokens_out": 683,
      "cost_usd": 0.0015545,
      "latency_ms": 12217.2
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_07",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t['click','click','click','click','click','click','click','click','click','click','click','click','",
      "llm_sql": "SELECT\n    user_id,\n    arraySort(groupArray(event_type)) AS event_types\nFROM events\nGROUP BY user_id\nORDER BY user_id;",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 371,
      "tokens_out": 144,
      "cost_usd": 0.0004735,
      "latency_ms": 10420.5
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_07",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 4450\t['click','click','click','click','click','click','click','click','click','click','click','click",
      "llm_sql": "SELECT \n    user_id,\n    arraySort(groupArray(event_type)) AS event_types\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 371,
      "tokens_out": 159,
      "cost_usd": 0.0005035,
      "latency_ms": 4104.9
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_07",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1627\t['click','click','click','click','click','click','click','click','click','click','click','click",
      "llm_sql": "SELECT \n    user_id,\n    arraySort(groupArray(event_type)) AS event_types\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, arraySort(groupArray(DISTINCT event_type)) AS event_types FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 371,
      "tokens_out": 143,
      "cost_usd": 0.0004715,
      "latency_ms": 4503.7
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_08",
      "tier": 5,
      "run": 1,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 42. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function argMax requires two arguments. (NUMBER_OF_ARGUMENTS_DOESNT_MA",
      "llm_sql": "SELECT\n    user_id,\n    argMax(*, timestamp) AS most_recent_event\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 368,
      "tokens_out": 430,
      "cost_usd": 0.001044,
      "latency_ms": 9572.2
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_08",
      "tier": 5,
      "run": 2,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 184. DB::Exception: Received from localhost:9000. DB::Exception: Aggregate function argMax(timestamp, timestamp) AS timestamp is found inside an",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS event_id,\n    argMax(timestamp, timestamp) AS timestamp,\n    argMax(event_type, timestamp) AS event_type,\n    argMax(page, timestamp) AS page,\n    argMax(device, timestamp) AS device,\n    argMax(country, timestamp) AS country\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 368,
      "tokens_out": 561,
      "cost_usd": 0.001306,
      "latency_ms": 11987.3
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_08",
      "tier": 5,
      "run": 3,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 4450\t304419\tsignup\t/blog\t2024-12-30 12:56:42.000\n3986\t195430\tlogout\t/about\t2024-12-26 06:16:20.000\n7",
      "llm_sql": "SELECT\n    user_id,\n    argMax(event_id, timestamp) AS most_recent_event_id,\n    argMax(event_type, timestamp) AS event_type,\n    argMax(page, timestamp) AS page,\n    argMax(timestamp, timestamp) AS most_recent_timestamp\nFROM events\nGROUP BY user_id",
      "reference_sql": "SELECT user_id, argMax(event_id, timestamp) AS last_event_id, max(timestamp) AS last_event_time FROM events GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 368,
      "tokens_out": 475,
      "cost_usd": 0.001134,
      "latency_ms": 12078.3
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_09",
      "tier": 5,
      "run": 1,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 47. DB::Exception: Received from localhost:9000. DB::Exception: Unknown expression or function identifier `h` in scope SELECT toDateTime64('2024",
      "llm_sql": "SELECT\n    h.hour,\n    count(e.event_id) AS event_count\nFROM\n    (SELECT toDateTime64('2024-06-15', 3) + interval h hour AS hour FROM numbers(24)) h\nLEFT JOIN\n    (SELECT event_id, timestamp FROM events WHERE toDate(timestamp) = '2024-06-15') e\nON toStartOfHour(e.timestamp) = h.hour\nGROUP BY h.hour\nORDER BY h.hour",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 382,
      "tokens_out": 960,
      "cost_usd": 0.002111,
      "latency_ms": 23290.1
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_09",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 2024-06-15 00:00:00.000\t110\n2024-06-15 01:00:00.000\t109\n2024-06-15 02:00:00.000\t124\n2024-06-15 03:00",
      "llm_sql": "SELECT\n    toDateTime64('2024-06-15 00:00:00', 3) + interval h hour AS hour,\n    count(e.event_id) AS event_count\nFROM (\n    SELECT arrayJoin(range(24)) AS h\n) AS hours\nLEFT JOIN events e ON toHour(e.timestamp) = hours.h \n    AND toDate(e.timestamp) = '2024-06-15'\nGROUP BY hour\nORDER BY hour",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 382,
      "tokens_out": 626,
      "cost_usd": 0.001443,
      "latency_ms": 31758.3
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_09",
      "tier": 5,
      "run": 3,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 47. DB::Exception: Received from localhost:9000. DB::Exception: Unknown expression or function identifier `n` in scope SELECT toDateTime64('2024",
      "llm_sql": "SELECT\n    h.hour,\n    count(e.event_id) AS event_count\nFROM (\n    SELECT toDateTime64('2024-06-15 00:00:00', 3) + INTERVAL n HOUR AS hour\n    FROM numbers(24) AS n\n) h\nLEFT JOIN events e ON toStartOfHour(e.timestamp) = h.hour\n    AND e.timestamp >= '2024-06-15 00:00:00'\n    AND e.timestamp < '2024-06-16 00:00:00'\nGROUP BY h.hour\nORDER BY h.hour",
      "reference_sql": "SELECT toStartOfHour(timestamp) AS hour, count() AS cnt FROM events WHERE toDate(timestamp) = '2024-06-15' GROUP BY hour ORDER BY hour WITH FILL FROM toDateTime('2024-06-15 00:00:00') TO toDateTime('2024-06-16 00:00:00') STEP INTERVAL 1 HOUR",
      "tokens_in": 382,
      "tokens_out": 652,
      "cost_usd": 0.001495,
      "latency_ms": 19558.4
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_10",
      "tier": 5,
      "run": 1,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 1\t2023-03-05 02:01:25.000\tfree\tuser1@example.com\t57\tJP\t{'signup_source':'paid'}\n2\t2023-06-10 18:49:4",
      "llm_sql": "SELECT u.*\nFROM users u\nWHERE u.user_id IN (\n    SELECT e.user_id\n    FROM events e\n    WHERE arrayExists(tag -> tag LIKE '%premium%', e.tags)\n)",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 387,
      "tokens_out": 581,
      "cost_usd": 0.0013555,
      "latency_ms": 10732.1
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_10",
      "tier": 5,
      "run": 2,
      "score": 2,
      "error_type": "Logic Error",
      "error_msg": "Got: 8640\t2024-11-09 21:00:04.000\tfree\tuser8640@example.com\t\\N\tFR\t{'signup_source':'referral'}\n370\t2023-0",
      "llm_sql": "SELECT u.*\nFROM users u\nWHERE EXISTS (\n    SELECT 1 \n    FROM events \n    WHERE user_id = u.user_id \n    AND arrayExists(x -> x LIKE '%premium%', tags)\n)",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 387,
      "tokens_out": 780,
      "cost_usd": 0.0017535,
      "latency_ms": 13866.6
    },
    {
      "model": "minimax-m2.5",
      "question_id": "t5_10",
      "tier": 5,
      "run": 3,
      "score": 1,
      "error_type": "Other Error",
      "error_msg": "Received exception from server (version 25.11.3):\nCode: 43. DB::Exception: Received from localhost:9000. DB::Exception: Illegal type Array(String) of argument of function like: In scope tag -> (tag LI",
      "llm_sql": "SELECT\n    user_id,\n    arrayFilter(tag -> tag LIKE '%premium%', groupArray(tags)) AS premium_tags\nFROM events\nGROUP BY user_id\nHAVING length(premium_tags) > 0;",
      "reference_sql": "SELECT user_id, groupArray(filtered_tags) AS all_premium_tags FROM (SELECT user_id, arrayFilter(x -> x LIKE '%premium%', tags) AS filtered_tags FROM events WHERE notEmpty(arrayFilter(x -> x LIKE '%premium%', tags))) GROUP BY user_id ORDER BY user_id LIMIT 50",
      "tokens_in": 387,
      "tokens_out": 1615,
      "cost_usd": 0.0034235,
      "latency_ms": 40433.8
    }
  ],
  "summary": [
    {
      "model": "claude-opus-4",
      "tier": 1,
      "total": 30,
      "correct": 30,
      "accuracy": 1.0,
      "avg_score": 3.0,
      "total_cost_usd": 0.257295,
      "cost_per_correct_usd": 0.008576
    },
    {
      "model": "claude-opus-4",
      "tier": 2,
      "total": 30,
      "correct": 30,
      "accuracy": 1.0,
      "avg_score": 3.0,
      "total_cost_usd": 0.304875,
      "cost_per_correct_usd": 0.010162
    },
    {
      "model": "claude-opus-4",
      "tier": 3,
      "total": 30,
      "correct": 18,
      "accuracy": 0.6,
      "avg_score": 2.6,
      "total_cost_usd": 0.28125,
      "cost_per_correct_usd": 0.015625
    },
    {
      "model": "claude-opus-4",
      "tier": 4,
      "total": 30,
      "correct": 18,
      "accuracy": 0.6,
      "avg_score": 2.6,
      "total_cost_usd": 0.369225,
      "cost_per_correct_usd": 0.020512
    },
    {
      "model": "claude-opus-4",
      "tier": 5,
      "total": 30,
      "correct": 12,
      "accuracy": 0.4,
      "avg_score": 2.4,
      "total_cost_usd": 0.40122,
      "cost_per_correct_usd": 0.033435
    },
    {
      "model": "claude-opus-4.6",
      "tier": 1,
      "total": 30,
      "correct": 30,
      "accuracy": 1.0,
      "avg_score": 3.0,
      "total_cost_usd": 0.25677,
      "cost_per_correct_usd": 0.008559
    },
    {
      "model": "claude-opus-4.6",
      "tier": 2,
      "total": 30,
      "correct": 30,
      "accuracy": 1.0,
      "avg_score": 3.0,
      "total_cost_usd": 0.304275,
      "cost_per_correct_usd": 0.010143
    },
    {
      "model": "claude-opus-4.6",
      "tier": 3,
      "total": 30,
      "correct": 18,
      "accuracy": 0.6,
      "avg_score": 2.6,
      "total_cost_usd": 0.27945,
      "cost_per_correct_usd": 0.015525
    },
    {
      "model": "claude-opus-4.6",
      "tier": 4,
      "total": 30,
      "correct": 18,
      "accuracy": 0.6,
      "avg_score": 2.6,
      "total_cost_usd": 0.369675,
      "cost_per_correct_usd": 0.020538
    },
    {
      "model": "claude-opus-4.6",
      "tier": 5,
      "total": 30,
      "correct": 12,
      "accuracy": 0.4,
      "avg_score": 2.4,
      "total_cost_usd": 0.410895,
      "cost_per_correct_usd": 0.034241
    },
    {
      "model": "claude-sonnet-4.5",
      "tier": 1,
      "total": 30,
      "correct": 30,
      "accuracy": 1.0,
      "avg_score": 3.0,
      "total_cost_usd": 0.053154,
      "cost_per_correct_usd": 0.001772
    },
    {
      "model": "claude-sonnet-4.5",
      "tier": 2,
      "total": 30,
      "correct": 24,
      "accuracy": 0.8,
      "avg_score": 2.8,
      "total_cost_usd": 0.060885,
      "cost_per_correct_usd": 0.002537
    },
    {
      "model": "claude-sonnet-4.5",
      "tier": 3,
      "total": 30,
      "correct": 18,
      "accuracy": 0.6,
      "avg_score": 2.6,
      "total_cost_usd": 0.058155,
      "cost_per_correct_usd": 0.003231
    },
    {
      "model": "claude-sonnet-4.5",
      "tier": 4,
      "total": 30,
      "correct": 12,
      "accuracy": 0.4,
      "avg_score": 2.4,
      "total_cost_usd": 0.079815,
      "cost_per_correct_usd": 0.006651
    },
    {
      "model": "claude-sonnet-4.5",
      "tier": 5,
      "total": 30,
      "correct": 9,
      "accuracy": 0.3,
      "avg_score": 2.3,
      "total_cost_usd": 0.077514,
      "cost_per_correct_usd": 0.008613
    },
    {
      "model": "deepseek-v3.2",
      "tier": 1,
      "total": 30,
      "correct": 30,
      "accuracy": 1.0,
      "avg_score": 3.0,
      "total_cost_usd": 0.003722,
      "cost_per_correct_usd": 0.000124
    },
    {
      "model": "deepseek-v3.2",
      "tier": 2,
      "total": 30,
      "correct": 24,
      "accuracy": 0.8,
      "avg_score": 2.73,
      "total_cost_usd": 0.004155,
      "cost_per_correct_usd": 0.000173
    },
    {
      "model": "deepseek-v3.2",
      "tier": 3,
      "total": 30,
      "correct": 16,
      "accuracy": 0.5333,
      "avg_score": 2.43,
      "total_cost_usd": 0.003769,
      "cost_per_correct_usd": 0.000236
    },
    {
      "model": "deepseek-v3.2",
      "tier": 4,
      "total": 30,
      "correct": 15,
      "accuracy": 0.5,
      "avg_score": 2.5,
      "total_cost_usd": 0.006072,
      "cost_per_correct_usd": 0.000405
    },
    {
      "model": "deepseek-v3.2",
      "tier": 5,
      "total": 30,
      "correct": 6,
      "accuracy": 0.2,
      "avg_score": 2.03,
      "total_cost_usd": 0.00507,
      "cost_per_correct_usd": 0.000845
    },
    {
      "model": "gemini-3-flash",
      "tier": 1,
      "total": 30,
      "correct": 30,
      "accuracy": 1.0,
      "avg_score": 3.0,
      "total_cost_usd": 0.002316,
      "cost_per_correct_usd": 7.7e-05
    },
    {
      "model": "gemini-3-flash",
      "tier": 2,
      "total": 30,
      "correct": 27,
      "accuracy": 0.9,
      "avg_score": 2.9,
      "total_cost_usd": 0.002644,
      "cost_per_correct_usd": 9.8e-05
    },
    {
      "model": "gemini-3-flash",
      "tier": 3,
      "total": 30,
      "correct": 17,
      "accuracy": 0.5667,
      "avg_score": 2.5,
      "total_cost_usd": 0.002194,
      "cost_per_correct_usd": 0.000129
    },
    {
      "model": "gemini-3-flash",
      "tier": 4,
      "total": 30,
      "correct": 10,
      "accuracy": 0.3333,
      "avg_score": 2.33,
      "total_cost_usd": 0.00297,
      "cost_per_correct_usd": 0.000297
    },
    {
      "model": "gemini-3-flash",
      "tier": 5,
      "total": 30,
      "correct": 6,
      "accuracy": 0.2,
      "avg_score": 2.1,
      "total_cost_usd": 0.003441,
      "cost_per_correct_usd": 0.000573
    },
    {
      "model": "gpt-5.2",
      "tier": 1,
      "total": 30,
      "correct": 30,
      "accuracy": 1.0,
      "avg_score": 3.0,
      "total_cost_usd": 0.032216,
      "cost_per_correct_usd": 0.001074
    },
    {
      "model": "gpt-5.2",
      "tier": 2,
      "total": 30,
      "correct": 28,
      "accuracy": 0.9333,
      "avg_score": 2.93,
      "total_cost_usd": 0.032876,
      "cost_per_correct_usd": 0.001174
    },
    {
      "model": "gpt-5.2",
      "tier": 3,
      "total": 30,
      "correct": 10,
      "accuracy": 0.3333,
      "avg_score": 2.33,
      "total_cost_usd": 0.031014,
      "cost_per_correct_usd": 0.003101
    },
    {
      "model": "gpt-5.2",
      "tier": 4,
      "total": 30,
      "correct": 15,
      "accuracy": 0.5,
      "avg_score": 2.47,
      "total_cost_usd": 0.042082,
      "cost_per_correct_usd": 0.002805
    },
    {
      "model": "gpt-5.2",
      "tier": 5,
      "total": 30,
      "correct": 8,
      "accuracy": 0.2667,
      "avg_score": 1.97,
      "total_cost_usd": 0.049602,
      "cost_per_correct_usd": 0.0062
    },
    {
      "model": "kimi-k2.5",
      "tier": 1,
      "total": 30,
      "correct": 30,
      "accuracy": 1.0,
      "avg_score": 3.0,
      "total_cost_usd": 0.036869,
      "cost_per_correct_usd": 0.001229
    },
    {
      "model": "kimi-k2.5",
      "tier": 2,
      "total": 30,
      "correct": 28,
      "accuracy": 0.9333,
      "avg_score": 2.93,
      "total_cost_usd": 0.05326,
      "cost_per_correct_usd": 0.001902
    },
    {
      "model": "kimi-k2.5",
      "tier": 3,
      "total": 30,
      "correct": 16,
      "accuracy": 0.5333,
      "avg_score": 2.5,
      "total_cost_usd": 0.053653,
      "cost_per_correct_usd": 0.003353
    },
    {
      "model": "kimi-k2.5",
      "tier": 4,
      "total": 30,
      "correct": 13,
      "accuracy": 0.4333,
      "avg_score": 2.37,
      "total_cost_usd": 0.10928,
      "cost_per_correct_usd": 0.008406
    },
    {
      "model": "kimi-k2.5",
      "tier": 5,
      "total": 30,
      "correct": 9,
      "accuracy": 0.3,
      "avg_score": 2.23,
      "total_cost_usd": 0.122132,
      "cost_per_correct_usd": 0.01357
    },
    {
      "model": "minimax-m2.5",
      "tier": 1,
      "total": 30,
      "correct": 30,
      "accuracy": 1.0,
      "avg_score": 3.0,
      "total_cost_usd": 0.012352,
      "cost_per_correct_usd": 0.000412
    },
    {
      "model": "minimax-m2.5",
      "tier": 2,
      "total": 30,
      "correct": 28,
      "accuracy": 0.9333,
      "avg_score": 2.93,
      "total_cost_usd": 0.015523,
      "cost_per_correct_usd": 0.000554
    },
    {
      "model": "minimax-m2.5",
      "tier": 3,
      "total": 30,
      "correct": 18,
      "accuracy": 0.6,
      "avg_score": 2.6,
      "total_cost_usd": 0.018898,
      "cost_per_correct_usd": 0.00105
    },
    {
      "model": "minimax-m2.5",
      "tier": 4,
      "total": 30,
      "correct": 12,
      "accuracy": 0.4,
      "avg_score": 2.4,
      "total_cost_usd": 0.020403,
      "cost_per_correct_usd": 0.0017
    },
    {
      "model": "minimax-m2.5",
      "tier": 5,
      "total": 30,
      "correct": 4,
      "accuracy": 0.1333,
      "avg_score": 1.73,
      "total_cost_usd": 0.03276,
      "cost_per_correct_usd": 0.00819
    }
  ],
  "error_counts": {
    "Logic Error": 396,
    "No SQL": 3,
    "Other Error": 28,
    "Syntax Error": 4
  },
  "error_examples": {
    "Logic Error": [
      {
        "model": "claude-opus-4.6",
        "qid": "t3_03",
        "sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
        "error": "Got: 879939\t2024-12-01 00:06:12.000\t3613\tpageview\t/settings\t5267\t{'campaign':'summer_sale','source':'twit"
      },
      {
        "model": "claude-opus-4.6",
        "qid": "t3_03",
        "sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
        "error": "Got: 984733\t2024-08-01 00:00:55.000\t7041\tlogout\t/about\t5140\t{'campaign':'black_friday','source':'facebook"
      },
      {
        "model": "claude-opus-4.6",
        "qid": "t3_03",
        "sql": "SELECT *\nFROM events\nWHERE mapContains(properties, 'campaign')",
        "error": "Got: 710692\t2024-11-01 00:03:27.000\t2732\tpurchase\t/home\t\\N\t{'campaign':'spring_promo','source':'google'}\t"
      },
      {
        "model": "claude-opus-4.6",
        "qid": "t3_04",
        "sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 10",
        "error": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect"
      },
      {
        "model": "claude-opus-4.6",
        "qid": "t3_04",
        "sql": "SELECT properties['source'] AS source\nFROM events\nWHERE event_type = 'purchase'\nORDER BY timestamp\nLIMIT 10",
        "error": "Got: direct\ngoogle\ngoogle\ngoogle\ngoogle\ntwitter\ndirect\ngoogle\ntwitter\ndirect"
      }
    ],
    "No SQL": [
      {
        "model": "deepseek-v3.2",
        "qid": "t2_10",
        "sql": "",
        "error": "Empty"
      },
      {
        "model": "deepseek-v3.2",
        "qid": "t3_09",
        "sql": "",
        "error": "Empty"
      },
      {
        "model": "gemini-3-flash",
        "qid": "t3_07",
        "sql": "",
        "error": "Empty"
      }
    ],
    "Other Error": [
      {
        "model": "deepseek-v3.2",
        "qid": "t3_03",
        "sql": "SELECT *\nFROM events\nWHERE mapKeys(properties) LIKE '%campaign%';",
        "error": "Received exception from server (version 25.11.3):\nCode: 43. DB::Exception: Received from localhost:9000. DB::Exception: Illegal type Array(String) of "
      },
      {
        "model": "deepseek-v3.2",
        "qid": "t5_09",
        "sql": "SELECT\n    toHour(toStartOfHour(toDateTime('2024-06-15 00:00:00')) + INTERVAL hour HOUR) as hour,\n    count(event_id) as event_count\nFROM numbers(24) AS hours\nLEFT JOIN events ON toHour(timestamp) = h",
        "error": "Received exception from server (version 25.11.3):\nCode: 47. DB::Exception: Received from localhost:9000. DB::Exception: Identifier 'hours.hour' cannot"
      },
      {
        "model": "deepseek-v3.2",
        "qid": "t5_09",
        "sql": "SELECT\n    toStartOfHour(fromUnixTimestamp(unixtime)) AS hour_start,\n    count(event_id) AS event_count\nFROM (\n    SELECT\n        toUnixTimestamp('2024-06-15 00:00:00') + (number * 3600) AS unixtime\n ",
        "error": "Received exception from server (version 25.11.3):\nCode: 206. DB::Exception: Received from localhost:9000. DB::Exception: JOIN  LEFT JOIN ... ON toStar"
      },
      {
        "model": "deepseek-v3.2",
        "qid": "t5_10",
        "sql": "SELECT DISTINCT user_id\nFROM events\nARRAY JOIN tags\nWHERE has(tags, 'premium')",
        "error": "Received exception from server (version 25.11.3):\nCode: 43. DB::Exception: Received from localhost:9000. DB::Exception: First argument for function ha"
      },
      {
        "model": "deepseek-v3.2",
        "qid": "t5_10",
        "sql": "SELECT \n    DISTINCT user_id \nFROM events \nARRAY JOIN tags \nWHERE has(tags, 'premium')",
        "error": "Received exception from server (version 25.11.3):\nCode: 43. DB::Exception: Received from localhost:9000. DB::Exception: First argument for function ha"
      }
    ],
    "Syntax Error": [
      {
        "model": "gpt-5.2",
        "qid": "t5_06",
        "sql": "SELECT\n    day,\n    count() AS event_count\nFROM events\nWHERE timestamp >= toDateTime64('2024-01-01 00:00:00', 3, 'UTC')\n  AND timestamp <  toDateTime64('2024-02-01 00:00:00', 3, 'UTC')\nGROUP BY day :=",
        "error": "Code: 62. DB::Exception: Syntax error: failed at position 200 (=) (line 7, col 15): = toDate(timestamp)\nORDER BY day\nWITH FILL\n    FROM toDate('2024-0"
      },
      {
        "model": "minimax-m2.5",
        "qid": "t5_02",
        "sql": "SELECT \n    toDate(timestamp) AS day,\n    count() AS events_per_day,\n    runningSum(over (ORDER BY day)) AS running_total\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2025-01-01'\nGROUP",
        "error": "Code: 62. DB::Exception: Syntax error: failed at position 97 (BY) (line 4, col 28): BY day)) AS running_total\nFROM events\nWHERE timestamp >= '2024-01-"
      },
      {
        "model": "minimax-m2.5",
        "qid": "t5_06",
        "sql": "SELECT\n    toDate(timestamp) AS date,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY date\nORDER BY date\nWITH FILL FROM toDate('2024-01-01'",
        "error": "Code: 62. DB::Exception: Syntax error: failed at position 234 (DAY) (line 8, col 68): DAY. Expected one of: token, DoubleColon, OR, AND, IS NOT DISTIN"
      },
      {
        "model": "minimax-m2.5",
        "qid": "t5_06",
        "sql": "SELECT \n    toDate(timestamp) AS date,\n    count() AS event_count\nFROM events\nWHERE timestamp >= '2024-01-01' AND timestamp < '2024-02-01'\nGROUP BY date\nORDER BY date\nWITH FILL FROM toDate('2024-01-01",
        "error": "Code: 62. DB::Exception: Syntax error: failed at position 235 (DAY) (line 8, col 68): DAY. Expected one of: token, DoubleColon, OR, AND, IS NOT DISTIN"
      }
    ]
  },
  "model_stats": {
    "claude-opus-4.6": {
      "1": {
        "correct": 30,
        "total": 30
      },
      "2": {
        "correct": 30,
        "total": 30
      },
      "3": {
        "correct": 18,
        "total": 30
      },
      "4": {
        "correct": 18,
        "total": 30
      },
      "5": {
        "correct": 12,
        "total": 30
      }
    },
    "claude-opus-4": {
      "1": {
        "correct": 30,
        "total": 30
      },
      "2": {
        "correct": 30,
        "total": 30
      },
      "3": {
        "correct": 18,
        "total": 30
      },
      "4": {
        "correct": 18,
        "total": 30
      },
      "5": {
        "correct": 12,
        "total": 30
      }
    },
    "claude-sonnet-4.5": {
      "1": {
        "correct": 30,
        "total": 30
      },
      "2": {
        "correct": 24,
        "total": 30
      },
      "3": {
        "correct": 18,
        "total": 30
      },
      "4": {
        "correct": 12,
        "total": 30
      },
      "5": {
        "correct": 9,
        "total": 30
      }
    },
    "deepseek-v3.2": {
      "1": {
        "correct": 30,
        "total": 30
      },
      "2": {
        "correct": 24,
        "total": 30
      },
      "3": {
        "correct": 16,
        "total": 30
      },
      "4": {
        "correct": 15,
        "total": 30
      },
      "5": {
        "correct": 6,
        "total": 30
      }
    },
    "gemini-3-flash": {
      "1": {
        "correct": 30,
        "total": 30
      },
      "2": {
        "correct": 27,
        "total": 30
      },
      "3": {
        "correct": 17,
        "total": 30
      },
      "4": {
        "correct": 10,
        "total": 30
      },
      "5": {
        "correct": 6,
        "total": 30
      }
    },
    "gpt-5.2": {
      "1": {
        "correct": 30,
        "total": 30
      },
      "2": {
        "correct": 28,
        "total": 30
      },
      "3": {
        "correct": 10,
        "total": 30
      },
      "4": {
        "correct": 15,
        "total": 30
      },
      "5": {
        "correct": 8,
        "total": 30
      }
    },
    "kimi-k2.5": {
      "1": {
        "correct": 30,
        "total": 30
      },
      "2": {
        "correct": 28,
        "total": 30
      },
      "3": {
        "correct": 16,
        "total": 30
      },
      "4": {
        "correct": 13,
        "total": 30
      },
      "5": {
        "correct": 9,
        "total": 30
      }
    },
    "minimax-m2.5": {
      "1": {
        "correct": 30,
        "total": 30
      },
      "2": {
        "correct": 28,
        "total": 30
      },
      "3": {
        "correct": 18,
        "total": 30
      },
      "4": {
        "correct": 12,
        "total": 30
      },
      "5": {
        "correct": 4,
        "total": 30
      }
    }
  }
}